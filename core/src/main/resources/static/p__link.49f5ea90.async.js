(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[72],{82277:function(P){P.exports={"link__form-wrap":"link__form-wrap___4fdvJ",link__content:"link__content___oPe_t",pages:"pages___3NUwO","link__item-card":"link__item-card___y2kSX",link:"link___s0XZS","detail-table":"detail-table___2NvnS","ant-table-tbody":"ant-table-tbody___2xnJD","is-active":"is-active___3dJbi"}},48385:function(P,O,e){"use strict";e.r(O),e.d(O,{default:function(){return ve}});var N=e(20228),S=e(11382),ee=e(13254),l=e(14277),C=e(14781),H=e(23492),z=e(57663),w=e(71577),I=e(11849),X=e(3182),W=e(48736),Q=e(27049),c=e(2824),V=e(94043),M=e.n(V),m=e(67294),x=e(5894),k=e(64317),Y=e(78844),r=e(76570),i=e(25592),h=["select","insert","update","delete"],n=e(54154),v=e(87593),te=e(37636),le=e(14650),B=e(39265),ie=e(69610),ue=e(54941),U=function(){function T(){(0,ie.Z)(this,T)}return(0,ue.Z)(T,null,[{key:"timeStampToTime",value:function(s){var g=new Date(parseInt(s));return g.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(s){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",u=s||new Date,b,Z={"Y+":u.getFullYear().toString(),"m+":this.twoCompletion(u.getMonth()+1),"d+":this.twoCompletion(u.getDate()),"H+":this.twoCompletion(u.getHours()),"M+":this.twoCompletion(u.getMinutes()),"S+":this.twoCompletion(u.getSeconds())},F="";return Object.keys(Z).forEach(function(D){b=new RegExp("("+D+")").exec(g),b&&(F=g.replace(b[1],b[1].length===1?Z[D]:Z[D].padStart(b[1].length,"0")))}),F}},{key:"uuid",value:function(){for(var s=[],g="0123456789abcdef",u=0;u<36;u++)s[u]=g.substr(Math.floor(Math.random()*16),1);return s[14]="4",s[19]=g.substr(s[19]&3|8,1),s[8]=s[13]=s[18]=s[23]="-",s.join("").replace(new RegExp(/(-)/g),"")}}]),T}();U.arrayDeDuplication=function(T){return Array.from(new Set(T))},U.twoCompletion=function(T){return T.toString().padStart(2,"0")};var t=e(85893),oe=[{title:"\u64CD\u4F5C\u6570\u636E",dataIndex:"function",align:"center",fixed:"left",ellipsis:!0},{title:"IP",dataIndex:"peer",align:"center"},{title:"\u6570\u636E\u5E93\u8D26\u53F7",dataIndex:"dbUserName",align:"center"},{title:"\u6570\u636E\u5E93\u5B9E\u4F8B",dataIndex:"dbInstance",align:"center"},{title:"\u6570\u636E\u5E93\u8868\u540D",dataIndex:"dbTableName",align:"center"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"dbType",align:"center"},{title:"SQL\u8BED\u53E5",dataIndex:"dbStatement",align:"center"}],de=function(p){var s=function(){return p.body.length===1?p.body[0].segments.filter(function(j){return j.peer}):p.body[0].segments},g=(0,m.useState)(0),u=(0,c.Z)(g,2),b=u[0],Z=u[1],F=(0,m.useState)(s().map(function(y){return y.id=U.uuid(),y})),D=(0,c.Z)(F,2),G=D[0],$=D[1],q=function(j,J){Z(J),$(j.map(function(R){return R.id=U.uuid(),R}))};return(0,t.jsx)("div",{className:p.style["detail-table"],children:(0,t.jsxs)(B.ZP,{split:"vertical",children:[p.body.length>1&&(0,t.jsx)(B.ZP,{colSpan:"30%",children:(0,t.jsx)(te.Z,{children:p.body.map(function(y,j){return(0,t.jsx)(te.Z.Item,{color:y.segments.length>1?"#00CCFF":"green",className:"pointer pb-10",children:(0,t.jsx)("div",{onClick:function(){q(y.segments,j)},children:(0,t.jsx)("p",{className:b===j?p.style["is-active"]:"",children:y.url})})},U.uuid())})})}),(0,t.jsx)(B.ZP,{headerBordered:!0,children:G.length>0?(0,t.jsx)(le.ZP,{columns:oe,options:!1,size:"small",dataSource:G,rowKey:"id",search:!1,pagination:!1}):(0,t.jsx)(l.Z,{description:"\u6682\u65E0\u64CD\u4F5C\u6570\u636E"})})]})})},ce=de,me=e(6251),pe=e.n(me),ge=e(82277),L=e.n(ge),fe=[],he=function(){var p=(0,m.useState)([]),s=(0,c.Z)(p,2),g=s[0],u=s[1],b=(0,m.useState)(fe),Z=(0,c.Z)(b,2),F=Z[0],D=Z[1],G=(0,m.useState)([]),$=(0,c.Z)(G,2),q=$[0],y=$[1],j=(0,m.useRef)(),J=(0,m.useState)(0),R=(0,c.Z)(J,2),ye=R[0],Se=R[1],xe=(0,m.useState)(!1),ne=(0,c.Z)(xe,2),Te=ne[0],ae=ne[1],be=(0,m.useState)({pageNo:1,pageSize:20}),re=(0,c.Z)(be,2),A=re[0],je=re[1],_=function(f){ae(!0),(0,n.z2)(Object.assign(f)).then(function(a){var d=a.data,K=JSON.parse(d);Se(K.total);var E=JSON.parse(K.rows);K.rows?(console.log(E),Array.isArray(E)&&E.length>0?u(E):u([])):u([]),ae(!1)})};return(0,m.useEffect)(function(){(0,n.Y8)().then(function(o){var f=o.data,a=JSON.parse(f).filter(function(d){return d});D(function(d){return d.concat(a)})}),(0,n.IY)().then(function(o){var f=o.data,a=JSON.parse(f).filter(function(d){return d});y(function(d){return d.concat(a)})}),_(A)},[]),(0,t.jsxs)("div",{className:L().link,children:[(0,t.jsxs)("div",{className:L()["link__form-wrap"],children:[(0,t.jsx)(Q.Z,{orientation:"left",plain:!0,children:(0,t.jsx)(r.Z,{})}),(0,t.jsxs)(x.A,{layout:"inline",formRef:j,size:"small",onFinish:function(){var o=(0,X.Z)(M().mark(function f(a){var d;return M().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:d=a,Object.keys(a).length>0&&(a.times&&(a.startTime=a.times[0],a.endTime=a.times[1],delete a.times,d=(0,I.Z)({},a)),je(function(se){return{pageNo:se.pageNo,pageSize:se.pageSize,applicationUserName:a.applicationUserName,dbType:a.dbType,msTableName:a.msTableName}})),_(d);case 3:case"end":return E.stop()}},f)}));return function(f){return o.apply(this,arguments)}}(),submitter:{render:function(){return[(0,t.jsx)(w.Z,{type:"primary",htmlType:"submit",icon:(0,t.jsx)(r.Z,{}),className:"br-5 w-80 fs-12",children:"\u67E5\u8BE2"},"edit"),(0,t.jsx)(w.Z,{htmlType:"button",icon:(0,t.jsx)(i.Z,{}),className:"br-5 w-80 fs-12",onClick:function(){var a;(a=j.current)===null||a===void 0||a.resetFields(),_({pageSize:A.pageSize,pageNo:A.pageNo})},children:"\u91CD\u7F6E"},"reset")]}},children:[(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(k.Z,{options:F,placeholder:"\u7528\u6237\u540D",name:"applicationUserName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(k.Z,{options:q,width:"sm",placeholder:"\u6570\u636E\u5E93\u8868\u540D",name:"msTableName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(k.Z,{options:h,placeholder:"\u64CD\u4F5C\u7C7B\u578B",name:"dbType"},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{width:"md",fieldProps:{placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],bordered:!1},name:"times"})})]})]}),(0,t.jsx)(S.Z,{spinning:Te,children:g.length>0?(0,t.jsxs)("div",{className:L().link__content,children:[g.map(function(o){return(0,t.jsx)(B.ZP,{collapsibleIconRender:function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"primary-blue-5 m-0",children:o.header.userName}),(0,t.jsxs)("div",{className:"fs-12",children:[(0,t.jsxs)("span",{className:"mr-20",children:[(0,t.jsx)("span",{className:"in-l",children:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"}),(0,t.jsx)("span",{children:o.header.requestStartTime})]}),(0,t.jsxs)("span",{className:"mt-20",children:[(0,t.jsx)("span",{className:"in-l",children:"URL\uFF1A"}),(0,t.jsx)("span",{children:o.header.url})]})]})]})},className:"link__item-card",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,t.jsx)(ce,{body:o.body,style:L()})},U.uuid())}),(0,t.jsx)("div",{className:L().pages,children:(0,t.jsx)(H.Z,{total:ye,size:"small",onChange:function(f,a){_({pageNo:f,pageSize:a,applicationUserName:A.applicationUserName,msTableName:A.msTableName,dbType:A.dbType,startTime:A.startTime,endTime:A.endTime})},defaultPageSize:20,defaultCurrent:1})})]}):(0,t.jsx)(l.Z,{style:{textAlign:"center",fontSize:"18px",color:"#C0C4CC",marginTop:"100px"},imageStyle:{width:"400px",height:"400px",margin:"0 auto"},image:pe()})})]})},ve=he},54154:function(P,O,e){"use strict";e.d(O,{Y8:function(){return H},IY:function(){return w},z2:function(){return X},m8:function(){return Q},LX:function(){return V},gY:function(){return m},CX:function(){return k}});var N=e(11849),S=e(3182),ee=e(94043),l=e.n(ee),C=e(25377);function H(r){return z.apply(this,arguments)}function z(){return z=(0,S.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserName",(0,N.Z)({method:"GET"},i||{})));case 1:case"end":return n.stop()}},r)})),z.apply(this,arguments)}function w(r){return I.apply(this,arguments)}function I(){return I=(0,S.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllMsTableName",(0,N.Z)({method:"GET"},i||{})));case 1:case"end":return n.stop()}},r)})),I.apply(this,arguments)}function X(r,i){return W.apply(this,arguments)}function W(){return W=(0,S.Z)(l().mark(function r(i,h){return l().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,C.WY)("/api/skyflying/getAllSegments",(0,N.Z)({method:"GET",timeout:6e4,headers:{"Content-Type":"application/json"},params:i},h||{})));case 1:case"end":return v.stop()}},r)})),W.apply(this,arguments)}function Q(r){return c.apply(this,arguments)}function c(){return c=(0,S.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserNameFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),c.apply(this,arguments)}function V(r){return M.apply(this,arguments)}function M(){return M=(0,S.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllSqlTypeFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),M.apply(this,arguments)}function m(r){return x.apply(this,arguments)}function x(){return x=(0,S.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllTableNameFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),x.apply(this,arguments)}function k(r,i){return Y.apply(this,arguments)}function Y(){return Y=(0,S.Z)(l().mark(function r(i,h){return l().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,C.WY)("/api/skyflying/getDmsAuditLogFromDb",(0,N.Z)({method:"GET",timeout:6e4,params:i},h||{})));case 1:case"end":return v.stop()}},r)})),Y.apply(this,arguments)}},6251:function(P,O,e){P.exports=e.p+"static/empty.a9f51423.png"}}]);
