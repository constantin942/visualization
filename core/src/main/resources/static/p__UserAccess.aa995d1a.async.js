(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[462],{33599:function(N){N.exports={userAccess:"userAccess___1UdBc","detail-wrap":"detail-wrap___2mcEh","tabs-wrap":"tabs-wrap___3PPX8","content-wrap":"content-wrap___2U6yp"}},9578:function(N,T,e){"use strict";e.r(T),e.d(T,{default:function(){return pe}});var p=e(3182),h=e(57663),O=e(71577),i=e(34792),v=e(48086),t=e(86582),l=e(2824),o=e(94043),s=e.n(o),a=e(67294),y=e(13062),x=e(71230),b=e(89032),E=e(15746),K=e(90387),X=e(9536),A=e(39004),r=e(85893),W=function(c){return(0,a.useEffect)(function(){var u=new A.kL({container:"ActionPie".concat(c.id),autoFit:!0,height:250});u.data(c.types),u.coordinate("theta",{radius:.75}),u.tooltip({showMarkers:!0}),u.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(_){var w=_.shape;return{matrix:A.Zr.zoom(w,1.1)}}}}).label("type",function(C){var _=C==="select"?1:.5;return{offset:-30,style:{opacity:_,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(U){return U.type+`
`+U.value+"\u6B21"}}}),u.interaction("element-single-selected"),u.render()},[]),(0,r.jsx)("div",{id:"ActionPie"+c.id})},d=W,f=function(c){return(0,a.useEffect)(function(){var u=new A.kL({container:"VisibleTimePie"+c.id,autoFit:!0,height:250});u.data(c.intervals),u.coordinate("theta",{radius:.75}),u.tooltip({showMarkers:!0}),u.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(_){var w=_.shape;return{matrix:A.Zr.zoom(w,1.1)}}}}).label("type",function(C){var _=C==="select"?1:.5;return{offset:-30,style:{opacity:_,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(U){return U.type+`
`+U.value+"\u6B21"}}}),u.interaction("element-single-selected"),u.render()},[]),(0,r.jsx)("div",{id:"VisibleTimePie"+c.id})},g=f,D=function(c){return(0,a.useEffect)(function(){var u=new A.kL({container:"RecentlyLine".concat(c.id),autoFit:!0,height:200});u.data(c.ranges),u.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),u.tooltip({showCrosshairs:!0,shared:!0}),u.axis("value",{label:{}}),u.area().position("year*value"),u.line().position("year*value"),u.render()},[]),(0,r.jsx)("div",{id:"RecentlyLine"+c.id})},n=D,ne=[{label:"\u7ECF\u5E38\u8BBF\u95EE\u7684\u6570\u636E",value:"higher"},{label:"\u4E0D\u5E38\u8BBF\u95EE\u7684\u6570\u636E",value:"lower"}],oe=function(c){var u,C,_,w=(0,a.useState)(ne[0].value),U=(0,l.Z)(w,2),H=U[0],q=U[1];return(0,r.jsxs)(x.Z,{className:c.style["detail-wrap"],children:[(0,r.jsxs)(E.Z,{span:8,className:c.style["tabs-wrap"],children:[(0,r.jsx)(X.Z,{block:!0,options:ne,value:H,onChange:q}),(0,r.jsx)("div",{className:c.style["content-wrap"],children:(u=c.details)===null||u===void 0||(C=u.higherOrLower)===null||C===void 0||(_=C[H])===null||_===void 0?void 0:_.map(function($){return(0,r.jsxs)("div",{className:"flex-x-sb",children:[(0,r.jsx)("span",{children:$.visitedData}),(0,r.jsxs)("span",{children:[$.visitedCount," \u6B21"]})]},$.visitedData)})})]}),(0,r.jsxs)(E.Z,{span:16,className:"pl-10 pr-20",children:[(0,r.jsxs)(x.Z,{children:[(0,r.jsxs)(E.Z,{span:12,className:"text-c",children:[(0,r.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,r.jsx)(d,{types:c.details.types,id:c.id})]}),(0,r.jsxs)(E.Z,{span:12,className:"text-c",children:[(0,r.jsx)("h3",{children:"\u8BBF\u95EE\u65F6\u6BB5\u5206\u5E03"}),(0,r.jsx)(g,{intervals:c.details.intervals,id:c.id})]})]}),(0,r.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,r.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,r.jsx)(n,{ranges:c.details.ranges,id:c.id})]})]})]})},ce=oe,de=e(33599),ae=e.n(de),fe=e(73016),I=e(6650),me=e(33414),Q=e(24480),se=e(84674),ve=function(){var c=(0,a.useState)(),u=(0,l.Z)(c,2),C=u[0],_=u[1],w=(0,a.useState)(""),U=(0,l.Z)(w,2),H=U[0],q=U[1],$=(0,a.useState)({types:[],intervals:[],ranges:[],higherOrLower:{higher:[],lower:[]}}),re=(0,l.Z)($,2),he=re[0],ge=re[1],_e=[{title:"\u7528\u6237\u540D",dataIndex:"userName",key:"applicationUserName",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",search:!1,width:100,align:"center"},{title:"\u5E38\u7528\u6570\u636E",dataIndex:"usualVisitedData",key:"usualVisitedData",align:"center",search:!1,render:function(S,m){var j=JSON.parse(m.usualVisitedData),P=j.tableName,B=j.tableNameDesc,L=P.split(","),F="-";return B?F=B:L.length>1&&(F=L[L.length-1]),(0,r.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:F})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",dataIndex:"lastVisitedDate",key:"lastVisitedDate",search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(S,m){return[(0,r.jsx)(O.Z,{type:"link",size:"small",onClick:function(){if(m.visitedCount!==0){var P=JSON.parse(m.usualVisitedData),B=P.tableName,L=Q.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),F=Q.Z.getRangeTime(7,"YYYY-mm-dd HH:MM:SS");(0,I.Xd)({applicationUserName:m.userName,startTime:L[0],endTime:L[1],tableName:B}).then(function(ye){var ee=ye.data;if(ee&&ee.length>0){var De=ee.map(function(Z,k){return{year:F[k],value:Z}}),ie=(0,t.Z)(se.q);(0,I.FP)({userName:m.userName}).then(function(Z){Z.data&&Z.data.length>0&&ie.forEach(function(k){Z.data.forEach(function(V){var Y=JSON.parse(V),M=Y.dbType,z=Y.dbTypeTimes;k.type===M&&(k.value=parseInt(z))})})});var J=(0,t.Z)(se.Q);(0,me.w)({userName:m.userName}).then(function(Z){var k=JSON.parse(Z.data),V=JSON.parse(k.rows);if(V&&V.length>0){var Y=V[0];J[0].value=Y.forenoonCount|0,J[1].value=Y.afternoonCount|0,J[2].value=Y.nightCount|0}(0,I.Bx)({applicationUserName:m.userName}).then(function(M){if(M.data){M.data.forEach(function(te){var le=te.visitedData.split("#");return te.visitedData=le[le.length-1],te});var z=Math.ceil(M.data.length/2),Ee=M.data.splice(0,z),Ce=M.data.splice(-z);ge(function(){return{types:ie,intervals:J,ranges:De,higherOrLower:{higher:Ee,lower:Ce}}}),q(m.id)}})})}})}else v.ZP.info("".concat(m.userName,"\u7528\u6237\u8BBF\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],ue=function(){(0,I.F$)().then(function(S){var m=S.data;m&&m.length>0?_(m.map(function(j){return j.id=Q.Z.uuid(),j})):_([])})};return(0,a.useEffect)(function(){ue()},[]),(0,r.jsx)("div",{className:ae().userAccess,children:(0,r.jsx)(fe.Z,{columns:_e,rowKey:"id",onSubmit:function(){var R=(0,p.Z)(s().mark(function S(m){return s().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:Object.keys(m).length>0?(0,I.wA)(m).then(function(B){console.log(B)}):ue();case 1:case"end":return P.stop()}},S)}));return function(S){return R.apply(this,arguments)}}(),expandable:{expandedRowRender:function(S,m){return(0,r.jsx)(ce,{details:he,id:m,style:ae()},m)},expandIcon:function(){return!1},expandedRowKeys:[H]},dataSource:C})})},pe=ve},84674:function(N,T,e){"use strict";e.d(T,{q:function(){return p},Q:function(){return h}});var p=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],h=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},33414:function(N,T,e){"use strict";e.d(T,{N:function(){return t},w:function(){return o}});var p=e(11849),h=e(3182),O=e(94043),i=e.n(O),v=e(32773);function t(a){return l.apply(this,arguments)}function l(){return l=(0,h.Z)(i().mark(function a(y){return i().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,v.WY)("/api/skyflying/getAllUserNamePortraitByVisitedTime",(0,p.Z)({method:"GET"},y||{})));case 1:case"end":return b.stop()}},a)})),l.apply(this,arguments)}function o(a,y){return s.apply(this,arguments)}function s(){return s=(0,h.Z)(i().mark(function a(y,x){return i().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,v.WY)("/api/skyflying/getAllUserPortraitByVisitedTime",(0,p.Z)({method:"GET",params:y||{}},x||{})));case 1:case"end":return E.stop()}},a)})),s.apply(this,arguments)}},6650:function(N,T,e){"use strict";e.d(T,{F$:function(){return t},Xd:function(){return o},et:function(){return x},FP:function(){return E},Bx:function(){return X},wA:function(){return r}});var p=e(11849),h=e(3182),O=e(94043),i=e.n(O),v=e(32773);function t(d){return l.apply(this,arguments)}function l(){return l=(0,h.Z)(i().mark(function d(f){return i().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,v.WY)("/api/skyflying/getCoarseCountsOfUser",(0,p.Z)({method:"GET"},f||{})));case 1:case"end":return D.stop()}},d)})),l.apply(this,arguments)}function o(d,f){return s.apply(this,arguments)}function s(){return s=(0,h.Z)(i().mark(function d(f,g){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,v.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,p.Z)({method:"GET",params:f},g||{})));case 1:case"end":return n.stop()}},d)})),s.apply(this,arguments)}function a(d,f){return y.apply(this,arguments)}function y(){return y=_asyncToGenerator(_regeneratorRuntime.mark(function d(f,g){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:f},g||{})));case 1:case"end":return n.stop()}},d)})),y.apply(this,arguments)}function x(d,f){return b.apply(this,arguments)}function b(){return b=(0,h.Z)(i().mark(function d(f,g){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,v.WY)("/api/skyflying/getCountsOfUser",(0,p.Z)({method:"GET",params:f},g||{})));case 1:case"end":return n.stop()}},d)})),b.apply(this,arguments)}function E(d,f){return K.apply(this,arguments)}function K(){return K=(0,h.Z)(i().mark(function d(f,g){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,v.WY)("/api/skyflying/getUserOperationTypeCount",(0,p.Z)({method:"GET",params:f},g||{})));case 1:case"end":return n.stop()}},d)})),K.apply(this,arguments)}function X(d,f){return A.apply(this,arguments)}function A(){return A=(0,h.Z)(i().mark(function d(f,g){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,v.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,p.Z)({method:"GET",params:f},g||{})));case 1:case"end":return n.stop()}},d)})),A.apply(this,arguments)}function r(d,f){return W.apply(this,arguments)}function W(){return W=(0,h.Z)(i().mark(function d(f,g){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,v.WY)("/api/skyflying/getCoarseCountsOfOneUser",(0,p.Z)({method:"GET",params:f||{}},g||{})));case 1:case"end":return n.stop()}},d)})),W.apply(this,arguments)}},24480:function(N,T,e){"use strict";e.d(T,{Z:function(){return O}});var p=e(69610),h=e(54941),O=function(){function i(){(0,p.Z)(this,i)}return(0,h.Z)(i,null,[{key:"timeStampToTime",value:function(t){var l=new Date(parseInt(t));return l.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(t){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",o,s={"Y+":t.getFullYear().toString(),"m+":(t.getMonth()+1).toString(),"d+":t.getDate().toString(),"H+":t.getHours().toString(),"M+":t.getMinutes().toString(),"S+":t.getSeconds().toString()},a=l;for(var y in s)o=new RegExp("("+y+")").exec(l),o&&(a=a.replace(o[1],o[1].length==1?s[y]:s[y].padStart(o[1].length,"0")));return a}},{key:"uuid",value:function(){for(var t=[],l="0123456789abcdef",o=0;o<36;o++)t[o]=l.substr(Math.floor(Math.random()*16),1);return t[14]="4",t[19]=l.substr(t[19]&3|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(new RegExp(/(-)/g),"")}},{key:"getRangeTime",value:function(t,l){for(var o=[],s=t-1;s>=0;s--){var a=void 0;s===t-1?a=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,1,0):a=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),l?o.push(i.getLocalTime(new Date(a),l)):o.push(a)}return o}},{key:"getRangeStartAndEndTime",value:function(t,l){for(var o=[],s=t-1;s>=0;s--){var a=void 0;s===t-1?a=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,0,0):s===0?a=new Date(Date.now()-(s-1)*24*60*60*1e3).setHours(0,0,0,0):a=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),l?o.push(i.getLocalTime(new Date(a),l)):o.push(a)}return[o[0],o[t-1]]}}]),i}();O.arrayDeDuplication=function(i){return Array.from(new Set(i))}}}]);
