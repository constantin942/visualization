(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[462],{33599:function(S){S.exports={userAccess:"userAccess___1UdBc","detail-wrap":"detail-wrap___2mcEh","tabs-wrap":"tabs-wrap___3PPX8","content-wrap":"content-wrap___2U6yp"}},9578:function(S,A,e){"use strict";e.r(A),e.d(A,{default:function(){return _e}});var p=e(3182),_=e(57663),T=e(71577),o=e(34792),h=e(48086),n=e(86582),l=e(2824),c=e(94043),s=e.n(c),a=e(67294),y=e(13062),w=e(71230),b=e(89032),D=e(15746),k=e(18106),G=e(51752),F=e(71153),v=e(60331),m=e(13286),f=e(39004),t=e(85893),u=function(i){return(0,a.useEffect)(function(){var r=new f.kL({container:"ActionPie".concat(i.id),autoFit:!0,height:250});r.data(i.types),r.coordinate("theta",{radius:.75}),r.tooltip({showMarkers:!0}),r.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(g){var U=g.shape;return{matrix:f.Zr.zoom(U,1.1)}}}}).label("type",function(C){var g=C==="select"?1:.5;return{offset:-30,style:{opacity:g,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(E){return E.type+`
`+E.value+"\u6B21"}}}),r.interaction("element-single-selected"),r.render()},[]),(0,t.jsx)("div",{id:"ActionPie"+i.id})},ie=u,le=function(i){return(0,a.useEffect)(function(){var r=new f.kL({container:"VisibleTimePie"+i.id,autoFit:!0,height:250});r.data(i.intervals),r.coordinate("theta",{radius:.75}),r.tooltip({showMarkers:!0}),r.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(g){var U=g.shape;return{matrix:f.Zr.zoom(U,1.1)}}}}).label("type",function(C){var g=C==="select"?1:.5;return{offset:-30,style:{opacity:g,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(E){return E.type+`
`+E.value+"\u6B21"}}}),r.interaction("element-single-selected"),r.render()},[]),(0,t.jsx)("div",{id:"VisibleTimePie"+i.id})},oe=le,ce=function(i){return(0,a.useEffect)(function(){var r=new f.kL({container:"RecentlyLine".concat(i.id),autoFit:!0,height:200});r.data(i.ranges),r.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),r.tooltip({showCrosshairs:!0,shared:!0}),r.axis("value",{label:{}}),r.area().position("year*value"),r.line().position("year*value"),r.render()},[]),(0,t.jsx)("div",{id:"RecentlyLine"+i.id})},de=ce,ve=function(i){var r,C,g,U,E,R;return(0,t.jsxs)(w.Z,{className:i.style["detail-wrap"],children:[(0,t.jsx)(D.Z,{span:8,className:i.style["tabs-wrap"],children:(0,t.jsxs)(G.Z,{tabPosition:"top",children:[(0,t.jsx)(m.Z,{tab:"\u9891\u7E41\u8BBF\u95EE\u7684\u6570\u636E",children:(0,t.jsx)("div",{className:i.style["content-wrap"],children:(r=i.details)===null||r===void 0||(C=r.higherOrLower)===null||C===void 0||(g=C.higher)===null||g===void 0?void 0:g.map(function(x){return(0,t.jsxs)("div",{className:"flex-x-sb",children:[(0,t.jsx)("span",{children:x.visitedData}),(0,t.jsxs)("span",{children:[x.visitedCount," \u6B21"]})]},x.visitedData)})})},"1"),(0,t.jsx)(m.Z,{tab:"\u4E0D\u5E38\u8BBF\u95EE\u7684\u6570\u636E",children:(0,t.jsx)("div",{className:i.style["content-wrap"],children:(U=i.details)===null||U===void 0||(E=U.higherOrLower)===null||E===void 0||(R=E.lower)===null||R===void 0?void 0:R.map(function(x){return(0,t.jsx)("div",{className:"mt-10 mb-10",children:(0,t.jsxs)(v.Z,{children:[x.visitedData," x ",x.visitedCount]})},x.visitedData)})})},"2")]})}),(0,t.jsxs)(D.Z,{span:16,className:"pl-10 pr-20",children:[(0,t.jsxs)(w.Z,{children:[(0,t.jsxs)(D.Z,{span:12,className:"text-c",children:[(0,t.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,t.jsx)(ie,{types:i.details.types,id:i.id})]}),(0,t.jsxs)(D.Z,{span:12,className:"text-c",children:[(0,t.jsx)("h3",{children:"\u8BBF\u95EE\u65F6\u6BB5\u5206\u5E03"}),(0,t.jsx)(oe,{intervals:i.details.intervals,id:i.id})]})]}),(0,t.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,t.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,t.jsx)(de,{ranges:i.details.ranges,id:i.id})]})]})]})},me=ve,fe=e(33599),q=e.n(fe),he=e(73016),N=e(6650),pe=e(33414),H=e(24480),J=e(84674),ge=function(){var i=(0,a.useState)(),r=(0,l.Z)(i,2),C=r[0],g=r[1],U=(0,a.useState)(""),E=(0,l.Z)(U,2),R=E[0],x=E[1],ye=(0,a.useState)({types:[],intervals:[],ranges:[],higherOrLower:{higher:[],lower:[]}}),ee=(0,l.Z)(ye,2),Ee=ee[0],De=ee[1],Ce=[{title:"\u7528\u6237\u540D",dataIndex:"userName",key:"applicationUserName",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",search:!1,width:100,align:"center"},{title:"\u5E38\u7528\u6570\u636E",dataIndex:"usualVisitedData",key:"usualVisitedData",align:"center",search:!1,render:function(O,d){var j=JSON.parse(d.usualVisitedData),P=j.tableName,Z=j.tableNameDesc,M=P.split(","),L="-";return Z?L=Z:M.length>1&&(L=M[M.length-1]),(0,t.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:L})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",dataIndex:"lastVisitedDate",key:"lastVisitedDate",search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(O,d){return[(0,t.jsx)(T.Z,{type:"link",size:"small",onClick:function(){if(d.visitedCount!==0){var P=JSON.parse(d.usualVisitedData),Z=P.tableName,M=H.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),L=H.Z.getRangeTime(7,"YYYY-mm-dd HH:MM:SS");(0,N.Xd)({applicationUserName:d.userName,startTime:M[0],endTime:M[1],tableName:Z}).then(function(Ue){var z=Ue.data;if(z&&z.length>0){var Ae=z.map(function($,Y){return{year:L[Y],value:$}}),ne=(0,n.Z)(J.q);J.q.forEach(function($,Y){(0,N.et)({applicationUserName:d.userName,dbType:$.type}).then(function(W){ne[Y].value=W.data})});var K=(0,n.Z)(J.Q);(0,pe.w)({userName:d.userName}).then(function($){var Y=JSON.parse($.data),W=JSON.parse(Y.rows);if(W&&W.length>0){var X=W[0];K[0].value=X.forenoonCount|0,K[1].value=X.afternoonCount|0,K[2].value=X.nightCount|0}(0,N.Bx)({applicationUserName:d.userName}).then(function(I){if(I.data){I.data.forEach(function(Q){var ue=Q.visitedData.split("#");return Q.visitedData=ue[ue.length-1],Q});var ae=Math.ceil(I.data.length/2),se=I.data.splice(0,ae),re=I.data.splice(-ae);De(function(){return{types:ne,intervals:K,ranges:Ae,higherOrLower:{higher:se,lower:re}}}),console.log(se,re),x(d.id)}})})}})}else h.ZP.info("".concat(d.userName,"\u7528\u6237\u8BBF\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],te=function(){(0,N.F$)().then(function(O){var d=O.data;d&&d.length>0?g(d.map(function(j){return j.id=H.Z.uuid(),j})):g([])})};return(0,a.useEffect)(function(){te()},[]),(0,t.jsx)("div",{className:q().userAccess,children:(0,t.jsx)(he.Z,{columns:Ce,rowKey:"id",onSubmit:function(){var B=(0,p.Z)(s().mark(function O(d){return s().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:Object.keys(d).length>0?(0,N.wA)(d).then(function(Z){console.log(Z)}):te();case 1:case"end":return P.stop()}},O)}));return function(O){return B.apply(this,arguments)}}(),expandable:{expandedRowRender:function(O,d){return(0,t.jsx)(me,{details:Ee,id:d,style:q()},d)},expandIcon:function(){return!1},expandedRowKeys:[R]},dataSource:C})})},_e=ge},84674:function(S,A,e){"use strict";e.d(A,{q:function(){return p},Q:function(){return _}});var p=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],_=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},33414:function(S,A,e){"use strict";e.d(A,{N:function(){return n},w:function(){return c}});var p=e(11849),_=e(3182),T=e(94043),o=e.n(T),h=e(32773);function n(a){return l.apply(this,arguments)}function l(){return l=(0,_.Z)(o().mark(function a(y){return o().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,h.WY)("/api/skyflying/getAllUserNamePortraitByVisitedTime",(0,p.Z)({method:"GET"},y||{})));case 1:case"end":return b.stop()}},a)})),l.apply(this,arguments)}function c(a,y){return s.apply(this,arguments)}function s(){return s=(0,_.Z)(o().mark(function a(y,w){return o().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,h.WY)("/api/skyflying/getAllUserPortraitByVisitedTime",(0,p.Z)({method:"GET",params:y||{}},w||{})));case 1:case"end":return D.stop()}},a)})),s.apply(this,arguments)}},6650:function(S,A,e){"use strict";e.d(A,{F$:function(){return n},Xd:function(){return c},et:function(){return w},Bx:function(){return D},wA:function(){return G}});var p=e(11849),_=e(3182),T=e(94043),o=e.n(T),h=e(32773);function n(v){return l.apply(this,arguments)}function l(){return l=(0,_.Z)(o().mark(function v(m){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.WY)("/api/skyflying/getCoarseCountsOfUser",(0,p.Z)({method:"GET"},m||{})));case 1:case"end":return t.stop()}},v)})),l.apply(this,arguments)}function c(v,m){return s.apply(this,arguments)}function s(){return s=(0,_.Z)(o().mark(function v(m,f){return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,p.Z)({method:"GET",params:m},f||{})));case 1:case"end":return u.stop()}},v)})),s.apply(this,arguments)}function a(v,m){return y.apply(this,arguments)}function y(){return y=_asyncToGenerator(_regeneratorRuntime.mark(function v(m,f){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:m},f||{})));case 1:case"end":return u.stop()}},v)})),y.apply(this,arguments)}function w(v,m){return b.apply(this,arguments)}function b(){return b=(0,_.Z)(o().mark(function v(m,f){return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.WY)("/api/skyflying/getCountsOfUser",(0,p.Z)({method:"GET",params:m},f||{})));case 1:case"end":return u.stop()}},v)})),b.apply(this,arguments)}function D(v,m){return k.apply(this,arguments)}function k(){return k=(0,_.Z)(o().mark(function v(m,f){return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,p.Z)({method:"GET",params:m},f||{})));case 1:case"end":return u.stop()}},v)})),k.apply(this,arguments)}function G(v,m){return F.apply(this,arguments)}function F(){return F=(0,_.Z)(o().mark(function v(m,f){return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,h.WY)("/api/skyflying/getCoarseCountsOfOneUser",(0,p.Z)({method:"GET",params:m||{}},f||{})));case 1:case"end":return u.stop()}},v)})),F.apply(this,arguments)}},24480:function(S,A,e){"use strict";e.d(A,{Z:function(){return T}});var p=e(69610),_=e(54941),T=function(){function o(){(0,p.Z)(this,o)}return(0,_.Z)(o,null,[{key:"timeStampToTime",value:function(n){var l=new Date(parseInt(n));return l.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",c,s={"Y+":n.getFullYear().toString(),"m+":(n.getMonth()+1).toString(),"d+":n.getDate().toString(),"H+":n.getHours().toString(),"M+":n.getMinutes().toString(),"S+":n.getSeconds().toString()},a=l;for(var y in s)c=new RegExp("("+y+")").exec(l),c&&(a=a.replace(c[1],c[1].length==1?s[y]:s[y].padStart(c[1].length,"0")));return a}},{key:"uuid",value:function(){for(var n=[],l="0123456789abcdef",c=0;c<36;c++)n[c]=l.substr(Math.floor(Math.random()*16),1);return n[14]="4",n[19]=l.substr(n[19]&3|8,1),n[8]=n[13]=n[18]=n[23]="-",n.join("").replace(new RegExp(/(-)/g),"")}},{key:"getRangeTime",value:function(n,l){for(var c=[],s=n-1;s>=0;s--){var a=void 0;s===n-1?a=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,1,0):a=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),l?c.push(o.getLocalTime(new Date(a),l)):c.push(a)}return c}},{key:"getRangeStartAndEndTime",value:function(n,l){for(var c=[],s=n-1;s>=0;s--){var a=void 0;s===n-1?a=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,0,0):s===0?a=new Date(Date.now()-(s-1)*24*60*60*1e3).setHours(0,0,0,0):a=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),l?c.push(o.getLocalTime(new Date(a),l)):c.push(a)}return[c[0],c[n-1]]}}]),o}();T.arrayDeDuplication=function(o){return Array.from(new Set(o))}}}]);
