(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[72],{82277:function(F){F.exports={"link__form-wrap":"link__form-wrap___4fdvJ",link__content:"link__content___oPe_t",pages:"pages___3NUwO","link__item-card":"link__item-card___y2kSX",link:"link___s0XZS","detail-table":"detail-table___2NvnS","ant-table-tbody":"ant-table-tbody___2xnJD","is-active":"is-active___3dJbi"}},48385:function(F,P,e){"use strict";e.r(P),e.d(P,{default:function(){return fe}});var N=e(13254),p=e(14277),ee=e(14781),i=e(23492),C=e(57663),z=e(71577),U=e(3182),te=e(48736),O=e(27049),H=e(11849),f=e(2824),X=e(94043),A=e.n(X),g=e(67294),x=e(5894),I=e(64317),k=e(78844),W=e(76570),Y=e(25592),a=["select","insert","update","delete"],l=e(54154),j=e(87593),n=e(37636),h=e(54029),ne=e(79166),ae=e(14650),G=e(39265),re=e(69610),se=e(54941),M=function(){function v(){(0,re.Z)(this,v)}return(0,se.Z)(v,null,[{key:"timeStampToTime",value:function(r){var c=new Date(parseInt(r));return c.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(r){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",u=r||new Date,b,Z={"Y+":u.getFullYear().toString(),"m+":this.twoCompletion(u.getMonth()+1),"d+":this.twoCompletion(u.getDate()),"H+":this.twoCompletion(u.getHours()),"M+":this.twoCompletion(u.getMinutes()),"S+":this.twoCompletion(u.getSeconds())},E="";return Object.keys(Z).forEach(function(D){b=new RegExp("("+D+")").exec(c),b&&(E=c.replace(b[1],b[1].length===1?Z[D]:Z[D].padStart(b[1].length,"0")))}),E}},{key:"uuid",value:function(){for(var r=[],c="0123456789abcdef",u=0;u<36;u++)r[u]=c.substr(Math.floor(Math.random()*16),1);return r[14]="4",r[19]=c.substr(r[19]&3|8,1),r[8]=r[13]=r[18]=r[23]="-",r.join("").replace(new RegExp(/(-)/g),"")}}]),v}();M.arrayDeDuplication=function(v){return Array.from(new Set(v))},M.twoCompletion=function(v){return v.toString().padStart(2,"0")};var t=e(85893),le=[{title:"IP",dataIndex:"peer",align:"center",fixed:"left",render:function(d,r){return(0,t.jsx)(ne.Z,{status:"processing",text:r.peer})}},{title:"\u7528\u6237",dataIndex:"dbUserName",align:"center"},{title:"\u6570\u636E\u5E93\u5B9E\u4F8B",dataIndex:"dbInstance",align:"center"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"dbType",align:"center"},{title:"SQL\u8BED\u53E5",dataIndex:"dbStatement",align:"center",width:300,fixed:"right",ellipsis:!0}],ie=function(d){var r=function(){return d.body.length===1?d.body[0].segments.filter(function(T){return T.peer}):d.body[0].segments},c=(0,g.useState)(0),u=(0,f.Z)(c,2),b=u[0],Z=u[1],E=(0,g.useState)(r().map(function(y){return y.id=M.uuid(),y})),D=(0,f.Z)(E,2),$=D[0],B=D[1],Q=function(T,J){Z(J),B(T.map(function(R){return R.id=M.uuid(),R}))};return(0,t.jsx)("div",{className:d.style["detail-table"],children:(0,t.jsxs)(G.ZP,{split:"vertical",children:[d.body.length>1&&(0,t.jsx)(G.ZP,{colSpan:"30%",children:(0,t.jsx)(n.Z,{children:d.body.map(function(y,T){return(0,t.jsx)(n.Z.Item,{color:y.segments.length>1?"#00CCFF":"green",className:"pointer pb-10",children:(0,t.jsx)("div",{onClick:function(){Q(y.segments,T)},children:(0,t.jsx)("p",{className:b===T?d.style["is-active"]:"",children:y.url})})},M.uuid())})})}),(0,t.jsx)(G.ZP,{headerBordered:!0,children:$.length>0?(0,t.jsx)(ae.ZP,{columns:le,options:!1,size:"small",dataSource:$,rowKey:"id",search:!1,pagination:!1}):(0,t.jsx)(p.Z,{description:"\u6682\u65E0\u64CD\u4F5C\u6570\u636E"})})]})})},ue=ie,oe=e(6251),de=e.n(oe),me=e(82277),L=e.n(me),ce=[],pe=function(){var d=(0,g.useState)([]),r=(0,f.Z)(d,2),c=r[0],u=r[1],b=(0,g.useState)(ce),Z=(0,f.Z)(b,2),E=Z[0],D=Z[1],$=(0,g.useState)([]),B=(0,f.Z)($,2),Q=B[0],y=B[1],T=(0,g.useRef)(),J=(0,g.useState)({pageNo:1,pageSize:20,total:0}),R=(0,f.Z)(J,2),K=R[0],ge=R[1],_=function(s){var o=s;s&&s.times&&(s.startTime=s.times[0],s.endTime=s.times[1],delete s.times,o=(0,H.Z)({},s)),(0,l.z2)(Object.assign(o)).then(function(S){var w=S.data,V=JSON.parse(w);ge(function(){return{pageSize:o.pageSize,pageNo:o.pageNo,total:V.total}});var q=JSON.parse(V.rows);V.rows&&(Array.isArray(q)?u(q):u([q]))})};return(0,g.useEffect)(function(){(0,l.Y8)().then(function(m){var s=m.data,o=JSON.parse(s).filter(function(S){return S});D(function(S){return S.concat(o)})}),(0,l.IY)().then(function(m){var s=m.data,o=JSON.parse(s).filter(function(S){return S});y(function(S){return S.concat(o)})}),_(K)},[]),(0,t.jsxs)("div",{className:L().link,children:[(0,t.jsxs)("div",{className:L()["link__form-wrap"],children:[(0,t.jsx)(O.Z,{orientation:"left",plain:!0,children:(0,t.jsx)(W.Z,{})}),(0,t.jsxs)(x.A,{layout:"inline",formRef:T,size:"small",onFinish:function(){var m=(0,U.Z)(A().mark(function s(o){return A().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:_(o);case 1:case"end":return w.stop()}},s)}));return function(s){return m.apply(this,arguments)}}(),submitter:{render:function(){return[(0,t.jsx)(z.Z,{type:"primary",htmlType:"submit",icon:(0,t.jsx)(W.Z,{}),className:"br-5 w-80 fs-12",children:"\u67E5\u8BE2"},"edit"),(0,t.jsx)(z.Z,{type:"ghost",htmlType:"button",icon:(0,t.jsx)(Y.Z,{}),className:"br-5 w-80 fs-12",onClick:function(){var o;(o=T.current)===null||o===void 0||o.resetFields(),_(K)},children:"\u91CD\u7F6E"},"reset")]}},children:[(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(I.Z,{options:E,placeholder:"userName",name:"applicationUserName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(I.Z,{options:Q,width:"sm",placeholder:"tableName",name:"msTableName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(I.Z,{options:a,placeholder:"dbType",name:"dbType"},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(k.Z,{width:"md",fieldProps:{placeholder:["startTime","endTime"],bordered:!1},name:"times"})})]})]}),c.length>0?(0,t.jsxs)("div",{className:L().link__content,children:[c.map(function(m){return(0,t.jsx)(G.ZP,{collapsibleIconRender:function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"primary-blue-5 m-0",children:m.header.userName}),(0,t.jsxs)("div",{className:"fs-12",children:[(0,t.jsxs)("span",{className:"mr-20",children:[(0,t.jsx)("span",{className:"in-l",children:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"}),(0,t.jsx)("span",{children:m.header.requestStartTime})]}),(0,t.jsxs)("span",{className:"mt-20",children:[(0,t.jsx)("span",{className:"in-l",children:"URL\uFF1A"}),(0,t.jsx)("span",{children:m.header.url})]})]})]})},className:"link__item-card",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,t.jsx)(ue,{body:m.body,style:L()})},M.uuid())}),(0,t.jsx)("div",{className:L().pages,children:(0,t.jsx)(i.Z,{total:K.total,size:"small",onChange:function(s,o){_({pageNo:s,pageSize:o,total:K.total})},defaultPageSize:20,defaultCurrent:1})})]}):(0,t.jsx)(p.Z,{style:{textAlign:"center",fontSize:"18px",color:"#C0C4CC",marginTop:"100px"},imageStyle:{width:"400px",height:"400px",margin:"0 auto"},image:de()})]})},fe=pe},54154:function(F,P,e){"use strict";e.d(P,{Y8:function(){return z},IY:function(){return te},z2:function(){return H},m8:function(){return X},LX:function(){return g},gY:function(){return I},CX:function(){return W}});var N=e(11849),p=e(3182),ee=e(94043),i=e.n(ee),C=e(25377);function z(a){return U.apply(this,arguments)}function U(){return U=(0,p.Z)(i().mark(function a(l){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserName",(0,N.Z)({method:"GET"},l||{})));case 1:case"end":return n.stop()}},a)})),U.apply(this,arguments)}function te(a){return O.apply(this,arguments)}function O(){return O=(0,p.Z)(i().mark(function a(l){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllMsTableName",(0,N.Z)({method:"GET"},l||{})));case 1:case"end":return n.stop()}},a)})),O.apply(this,arguments)}function H(a,l){return f.apply(this,arguments)}function f(){return f=(0,p.Z)(i().mark(function a(l,j){return i().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,C.WY)("/api/skyflying/getAllSegments",(0,N.Z)({method:"GET",timeout:6e4,headers:{"Content-Type":"application/json"},params:l},j||{})));case 1:case"end":return h.stop()}},a)})),f.apply(this,arguments)}function X(a){return A.apply(this,arguments)}function A(){return A=(0,p.Z)(i().mark(function a(l){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserNameFromDMS",(0,N.Z)({timeout:6e4},l||{})));case 1:case"end":return n.stop()}},a)})),A.apply(this,arguments)}function g(a){return x.apply(this,arguments)}function x(){return x=(0,p.Z)(i().mark(function a(l){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllSqlTypeFromDMS",(0,N.Z)({timeout:6e4},l||{})));case 1:case"end":return n.stop()}},a)})),x.apply(this,arguments)}function I(a){return k.apply(this,arguments)}function k(){return k=(0,p.Z)(i().mark(function a(l){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllTableNameFromDMS",(0,N.Z)({timeout:6e4},l||{})));case 1:case"end":return n.stop()}},a)})),k.apply(this,arguments)}function W(a,l){return Y.apply(this,arguments)}function Y(){return Y=(0,p.Z)(i().mark(function a(l,j){return i().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,C.WY)("/api/skyflying/getDmsAuditLogFromDb",(0,N.Z)({method:"GET",timeout:6e4,params:l},j||{})));case 1:case"end":return h.stop()}},a)})),Y.apply(this,arguments)}},6251:function(F,P,e){F.exports=e.p+"static/empty.a9f51423.png"}}]);
