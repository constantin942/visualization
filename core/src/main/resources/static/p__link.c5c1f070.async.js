(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[72],{82277:function(P){P.exports={"link__form-wrap":"link__form-wrap___4fdvJ",link__content:"link__content___oPe_t",pages:"pages___3NUwO","link__item-card":"link__item-card___y2kSX",link:"link___s0XZS","detail-table":"detail-table___2NvnS","ant-table-tbody":"ant-table-tbody___2xnJD","is-active":"is-active___3dJbi"}},95204:function(P,O,e){"use strict";e.r(O),e.d(O,{default:function(){return De}});var Z=e(20228),T=e(11382),ie=e(13254),u=e(14277),D=e(14781),_=e(23492),$=e(57663),k=e(71577),F=e(11849),q=e(3182),w=e(48736),ee=e(27049),m=e(2824),te=e(94043),U=e.n(te),p=e(67294),x=e(5894),Y=e(64317),L=e(78844),s=e(76570),o=e(25592),y=["select","insert","update","delete"],n=e(54154),S=e(87593),ue=e(37636),Me=e(49111),me=e(19650),pe=e(14650),J=e(39265),fe=e(69610),ge=e(54941),I=function(){function b(){(0,fe.Z)(this,b)}return(0,ge.Z)(b,null,[{key:"timeStampToTime",value:function(l){var g=new Date(parseInt(l));return g.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(l){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",d=l||new Date,N,A={"Y+":d.getFullYear().toString(),"m+":this.twoCompletion(d.getMonth()+1),"d+":this.twoCompletion(d.getDate()),"H+":this.twoCompletion(d.getHours()),"M+":this.twoCompletion(d.getMinutes()),"S+":this.twoCompletion(d.getSeconds())},M="";return Object.keys(A).forEach(function(E){N=new RegExp("("+E+")").exec(g),N&&(M=g.replace(N[1],N[1].length===1?A[E]:A[E].padStart(N[1].length,"0")))}),M}},{key:"uuid",value:function(){for(var l=[],g="0123456789abcdef",d=0;d<36;d++)l[d]=g.substr(Math.floor(Math.random()*16),1);return l[14]="4",l[19]=g.substr(l[19]&3|8,1),l[8]=l[13]=l[18]=l[23]="-",l.join("").replace(new RegExp(/(-)/g),"")}}]),b}();I.arrayDeDuplication=function(b){return Array.from(new Set(b))},I.twoCompletion=function(b){return b.toString().padStart(2,"0")};var he=e(95357),Pe=e(71194),ve=e(50146),t=e(85893),ye=function(c){return(0,t.jsx)(ve.Z,{visible:c.detailVisible,title:"\u8BBF\u95EE\u8BE6\u60C5",onCancel:function(){return c.setVisible(!1)}})},Se=ye,be=function(c){var l=function(){return c.body.length===1?c.body[0].segments.filter(function(j){return j.peer}):c.body[0].segments},g=(0,p.useState)(0),d=(0,m.Z)(g,2),N=d[0],A=d[1],M=(0,p.useState)(!1),E=(0,m.Z)(M,2),ne=E[0],z=E[1],ae=(0,p.useState)(l().map(function(v){return v.id=I.uuid(),v})),K=(0,m.Z)(ae,2),B=K[0],se=K[1],V=[{title:"\u64CD\u4F5C\u6570\u636E",dataIndex:"function",align:"center",ellipsis:!0},{title:"IP",dataIndex:"peer",align:"center"},{title:"\u6570\u636E\u5E93\u8D26\u53F7",dataIndex:"dbUserName",align:"center"},{title:"\u6570\u636E\u5E93\u5B9E\u4F8B",dataIndex:"dbInstance",align:"center"},{title:"\u6570\u636E\u5E93\u8868\u540D",dataIndex:"dbTableName",align:"center"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"dbType",align:"center"},{title:"SQL\u8BED\u53E5",dataIndex:"dbStatement",ellipsis:!0,copyable:!0,search:!1},{title:"Action",key:"action",align:"center",fixed:"right",render:function(){return(0,t.jsx)(me.Z,{children:(0,t.jsx)(k.Z,{icon:(0,t.jsx)(he.Z,{}),size:"small",className:"fs-12",type:"link",onClick:function(){z(!0)},children:"\u8BE6\u60C5"})})}}],re=function(j,W){A(W),se(j.map(function(H){return H.id=I.uuid(),H}))};return(0,t.jsxs)("div",{className:c.style["detail-table"],children:[(0,t.jsxs)(J.ZP,{split:"vertical",children:[c.body.length>1&&(0,t.jsx)(J.ZP,{colSpan:"30%",children:(0,t.jsx)(ue.Z,{children:c.body.map(function(v,j){return(0,t.jsx)(ue.Z.Item,{color:v.segments.length>1?"#00CCFF":"green",className:"pointer pb-10",children:(0,t.jsx)("div",{onClick:function(){re(v.segments,j)},children:(0,t.jsx)("p",{className:N===j?c.style["is-active"]:"",children:v.url})})},I.uuid())})})}),(0,t.jsx)(J.ZP,{headerBordered:!0,children:B.length>0?(0,t.jsx)(pe.ZP,{columns:V,options:!1,size:"small",dataSource:B,rowKey:"id",search:!1,pagination:!1}):(0,t.jsx)(u.Z,{description:"\u6682\u65E0\u64CD\u4F5C\u6570\u636E"})})]}),(0,t.jsx)(Se,{detailVisible:ne,setVisible:z})]})},Te=be,xe=e(6251),Ne=e.n(xe),je=e(82277),R=e.n(je),Ce=[],Ze=function(){var c=(0,p.useState)([]),l=(0,m.Z)(c,2),g=l[0],d=l[1],N=(0,p.useState)(Ce),A=(0,m.Z)(N,2),M=A[0],E=A[1],ne=(0,p.useState)([]),z=(0,m.Z)(ne,2),ae=z[0],K=z[1],B=(0,p.useRef)(),se=(0,p.useState)(0),V=(0,m.Z)(se,2),re=V[0],v=V[1],j=(0,p.useState)(!1),W=(0,m.Z)(j,2),H=W[0],oe=W[1],Ae=(0,p.useState)([]),de=(0,m.Z)(Ae,2),Ee=de[0],Ie=de[1],Fe=(0,p.useState)({pageNo:1,pageSize:20}),ce=(0,m.Z)(Fe,2),C=ce[0],Ue=ce[1],X=function(h){oe(!0),(0,n.z2)(Object.assign(h)).then(function(a){var i=a.data,r=JSON.parse(i);v(r.total);var G=JSON.parse(r.rows);r.rows?(console.log(G),Array.isArray(G)&&G.length>0?d(G):d([])):d([]),oe(!1)})};return(0,p.useEffect)(function(){(0,n.Y8)().then(function(f){var h=f.data,a=JSON.parse(h).filter(function(i){return i});E(function(i){return i.concat(a)})}),(0,n.IY)().then(function(f){var h=f.data,a=JSON.parse(h).filter(function(r){return r.msTableName}),i=a.map(function(r){return r.label=r.dbInstance+"#"+r.msTableName,r.value=r.msTableName,r.id=I.uuid(),r});Ie(i),K(function(){return i.map(function(r){return r.label})})}),X(C)},[]),(0,t.jsxs)("div",{className:R().link,children:[(0,t.jsxs)("div",{className:R()["link__form-wrap"],children:[(0,t.jsx)(ee.Z,{orientation:"left",plain:!0,children:(0,t.jsx)(s.Z,{})}),(0,t.jsxs)(x.A,{layout:"inline",formRef:B,size:"small",onFinish:function(){var f=(0,q.Z)(U().mark(function h(a){var i,r;return U().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:i=a,Object.keys(a).length>0&&(a.times&&(a.startTime=a.times[0],a.endTime=a.times[1],delete a.times,i=(0,F.Z)({},a)),a.msTableName&&(r=Ee.find(function(Q){return Q.label===a.msTableName}),r&&(a.msTableName=r.msTableName,a.dbInstance=r.dbInstance,i=(0,F.Z)({},a))),Ue(function(Q){return{pageNo:Q.pageNo,pageSize:Q.pageSize,applicationUserName:i.applicationUserName,dbType:i.dbType,msTableName:i.msTableName,startTime:i.startTime,endTime:i.endTime,dbInstance:i.dbInstance}})),X(i);case 3:case"end":return le.stop()}},h)}));return function(h){return f.apply(this,arguments)}}(),submitter:{render:function(){return[(0,t.jsx)(k.Z,{type:"primary",htmlType:"submit",icon:(0,t.jsx)(s.Z,{}),className:"br-5 w-80 fs-12",children:"\u67E5\u8BE2"},"edit"),(0,t.jsx)(k.Z,{htmlType:"button",icon:(0,t.jsx)(o.Z,{}),className:"br-5 w-80 fs-12",onClick:function(){var a;(a=B.current)===null||a===void 0||a.resetFields(),X({pageSize:C.pageSize,pageNo:C.pageNo})},children:"\u91CD\u7F6E"},"reset")]}},children:[(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:M,placeholder:"\u7528\u6237\u540D",name:"applicationUserName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:ae,width:"md",placeholder:"\u6570\u636E\u5E93\u8868\u540D",name:"msTableName",filedConfig:{},fieldProps:{}})}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:y,placeholder:"\u64CD\u4F5C\u7C7B\u578B",name:"dbType"},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(L.Z,{width:"md",fieldProps:{placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],bordered:!1},name:"times"})})]})]}),(0,t.jsx)(T.Z,{spinning:H,children:g.length>0?(0,t.jsxs)("div",{className:R().link__content,children:[g.map(function(f){return(0,t.jsx)(J.ZP,{collapsibleIconRender:function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"primary-blue-5 m-0",children:f.header.userName}),(0,t.jsxs)("div",{className:"fs-12",children:[(0,t.jsxs)("span",{className:"mr-20",children:[(0,t.jsx)("span",{className:"in-l",children:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"}),(0,t.jsx)("span",{children:f.header.requestStartTime})]}),(0,t.jsxs)("span",{className:"mt-20",children:[(0,t.jsx)("span",{className:"in-l",children:"URL\uFF1A"}),(0,t.jsx)("span",{children:f.header.url})]})]})]})},className:"link__item-card",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,t.jsx)(Te,{body:f.body,style:R()})},I.uuid())}),(0,t.jsx)("div",{className:R().pages,children:(0,t.jsx)(_.Z,{total:re,size:"small",onChange:function(h,a){X({pageNo:h,pageSize:a,applicationUserName:C.applicationUserName,msTableName:C.msTableName,dbType:C.dbType,startTime:C.startTime,endTime:C.endTime,dbInstance:C.dbInstance})},defaultPageSize:20,defaultCurrent:1})})]}):(0,t.jsx)(u.Z,{style:{textAlign:"center",fontSize:"18px",color:"#C0C4CC",marginTop:"100px"},imageStyle:{width:"400px",height:"400px",margin:"0 auto"},image:Ne()})})]})},De=Ze},54154:function(P,O,e){"use strict";e.d(O,{Y8:function(){return _},IY:function(){return k},z2:function(){return q},m8:function(){return ee},LX:function(){return te},gY:function(){return p},CX:function(){return Y}});var Z=e(11849),T=e(3182),ie=e(94043),u=e.n(ie),D=e(25377);function _(s){return $.apply(this,arguments)}function $(){return $=(0,T.Z)(u().mark(function s(o){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,D.WY)("/api/skyflying/getAllUserName",(0,Z.Z)({method:"GET"},o||{})));case 1:case"end":return n.stop()}},s)})),$.apply(this,arguments)}function k(s){return F.apply(this,arguments)}function F(){return F=(0,T.Z)(u().mark(function s(o){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,D.WY)("/api/skyflying/getAllInstanceAndTableName",(0,Z.Z)({method:"GET"},o||{})));case 1:case"end":return n.stop()}},s)})),F.apply(this,arguments)}function q(s,o){return w.apply(this,arguments)}function w(){return w=(0,T.Z)(u().mark(function s(o,y){return u().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,D.WY)("/api/skyflying/getAllSegments",(0,Z.Z)({method:"GET",timeout:6e4,headers:{"Content-Type":"application/json"},params:o},y||{})));case 1:case"end":return S.stop()}},s)})),w.apply(this,arguments)}function ee(s){return m.apply(this,arguments)}function m(){return m=(0,T.Z)(u().mark(function s(o){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,D.WY)("/api/skyflying/getAllUserNameFromDMS",(0,Z.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},s)})),m.apply(this,arguments)}function te(s){return U.apply(this,arguments)}function U(){return U=(0,T.Z)(u().mark(function s(o){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,D.WY)("/api/skyflying/getAllSqlTypeFromDMS",(0,Z.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},s)})),U.apply(this,arguments)}function p(s){return x.apply(this,arguments)}function x(){return x=(0,T.Z)(u().mark(function s(o){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,D.WY)("/api/skyflying/getAllTableNameFromDMS",(0,Z.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},s)})),x.apply(this,arguments)}function Y(s,o){return L.apply(this,arguments)}function L(){return L=(0,T.Z)(u().mark(function s(o,y){return u().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,D.WY)("/api/skyflying/getDmsAuditLogFromDb",(0,Z.Z)({method:"GET",timeout:6e4,params:o},y||{})));case 1:case"end":return S.stop()}},s)})),L.apply(this,arguments)}},6251:function(P,O,e){P.exports=e.p+"static/empty.a9f51423.png"}}]);
