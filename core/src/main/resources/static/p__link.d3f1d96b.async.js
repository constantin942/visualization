(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[72],{82277:function(P){P.exports={"link__form-wrap":"link__form-wrap___4fdvJ",link__content:"link__content___oPe_t",pages:"pages___3NUwO","link__item-card":"link__item-card___y2kSX",link:"link___s0XZS","detail-table":"detail-table___2NvnS","ant-table-tbody":"ant-table-tbody___2xnJD","is-active":"is-active___3dJbi"}},95204:function(P,O,e){"use strict";e.r(O),e.d(O,{default:function(){return Ce}});var N=e(20228),b=e(11382),se=e(13254),l=e(14277),C=e(14781),Q=e(23492),G=e(57663),I=e(71577),k=e(11849),_=e(3182),$=e(48736),q=e(27049),c=e(2824),ee=e(94043),F=e.n(ee),d=e(67294),x=e(5894),Y=e(64317),L=e(78844),r=e(76570),i=e(25592),v=["select","insert","update","delete"],n=e(54154),y=e(87593),le=e(37636),Ae=e(49111),ce=e(19650),de=e(14650),w=e(39265),me=e(69610),pe=e(54941),M=function(){function S(){(0,me.Z)(this,S)}return(0,pe.Z)(S,null,[{key:"timeStampToTime",value:function(s){var g=new Date(parseInt(s));return g.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(s){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",u=s||new Date,T,Z={"Y+":u.getFullYear().toString(),"m+":this.twoCompletion(u.getMonth()+1),"d+":this.twoCompletion(u.getDate()),"H+":this.twoCompletion(u.getHours()),"M+":this.twoCompletion(u.getMinutes()),"S+":this.twoCompletion(u.getSeconds())},U="";return Object.keys(Z).forEach(function(D){T=new RegExp("("+D+")").exec(g),T&&(U=g.replace(T[1],T[1].length===1?Z[D]:Z[D].padStart(T[1].length,"0")))}),U}},{key:"uuid",value:function(){for(var s=[],g="0123456789abcdef",u=0;u<36;u++)s[u]=g.substr(Math.floor(Math.random()*16),1);return s[14]="4",s[19]=g.substr(s[19]&3|8,1),s[8]=s[13]=s[18]=s[23]="-",s.join("").replace(new RegExp(/(-)/g),"")}}]),S}();M.arrayDeDuplication=function(S){return Array.from(new Set(S))},M.twoCompletion=function(S){return S.toString().padStart(2,"0")};var ge=e(95357),Ee=e(71194),fe=e(50146),t=e(85893),he=function(o){return(0,t.jsx)(fe.Z,{visible:o.detailVisible,title:"\u8BBF\u95EE\u8BE6\u60C5",onCancel:function(){return o.setVisible(!1)}})},ve=he,ye=function(o){var s=function(){return o.body.length===1?o.body[0].segments.filter(function(j){return j.peer}):o.body[0].segments},g=(0,d.useState)(0),u=(0,c.Z)(g,2),T=u[0],Z=u[1],U=(0,d.useState)(!1),D=(0,c.Z)(U,2),te=D[0],z=D[1],ne=(0,d.useState)(s().map(function(h){return h.id=M.uuid(),h})),J=(0,c.Z)(ne,2),B=J[0],ae=J[1],K=[{title:"\u64CD\u4F5C\u6570\u636E",dataIndex:"function",align:"center",ellipsis:!0},{title:"IP",dataIndex:"peer",align:"center"},{title:"\u6570\u636E\u5E93\u8D26\u53F7",dataIndex:"dbUserName",align:"center"},{title:"\u6570\u636E\u5E93\u5B9E\u4F8B",dataIndex:"dbInstance",align:"center"},{title:"\u6570\u636E\u5E93\u8868\u540D",dataIndex:"dbTableName",align:"center"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"dbType",align:"center"},{title:"SQL\u8BED\u53E5",dataIndex:"dbStatement",ellipsis:!0,copyable:!0,search:!1},{title:"Action",key:"action",align:"center",fixed:"right",render:function(){return(0,t.jsx)(ce.Z,{children:(0,t.jsx)(I.Z,{icon:(0,t.jsx)(ge.Z,{}),size:"small",className:"fs-12",type:"link",onClick:function(){z(!0)},children:"\u8BE6\u60C5"})})}}],re=function(j,W){Z(W),ae(j.map(function(V){return V.id=M.uuid(),V}))};return(0,t.jsxs)("div",{className:o.style["detail-table"],children:[(0,t.jsxs)(w.ZP,{split:"vertical",children:[o.body.length>1&&(0,t.jsx)(w.ZP,{colSpan:"30%",children:(0,t.jsx)(le.Z,{children:o.body.map(function(h,j){return(0,t.jsx)(le.Z.Item,{color:h.segments.length>1?"#00CCFF":"green",className:"pointer pb-10",children:(0,t.jsx)("div",{onClick:function(){re(h.segments,j)},children:(0,t.jsx)("p",{className:T===j?o.style["is-active"]:"",children:h.url})})},M.uuid())})})}),(0,t.jsx)(w.ZP,{headerBordered:!0,children:B.length>0?(0,t.jsx)(de.ZP,{columns:K,options:!1,size:"small",dataSource:B,rowKey:"id",search:!1,pagination:!1}):(0,t.jsx)(l.Z,{description:"\u6682\u65E0\u64CD\u4F5C\u6570\u636E"})})]}),(0,t.jsx)(ve,{detailVisible:te,setVisible:z})]})},Se=ye,be=e(6251),xe=e.n(be),Te=e(82277),R=e.n(Te),je=[],Ne=function(){var o=(0,d.useState)([]),s=(0,c.Z)(o,2),g=s[0],u=s[1],T=(0,d.useState)(je),Z=(0,c.Z)(T,2),U=Z[0],D=Z[1],te=(0,d.useState)([]),z=(0,c.Z)(te,2),ne=z[0],J=z[1],B=(0,d.useRef)(),ae=(0,d.useState)(0),K=(0,c.Z)(ae,2),re=K[0],h=K[1],j=(0,d.useState)(!1),W=(0,c.Z)(j,2),V=W[0],ie=W[1],Ze=(0,d.useState)({pageNo:1,pageSize:20}),ue=(0,c.Z)(Ze,2),A=ue[0],De=ue[1],H=function(f){ie(!0),(0,n.z2)(Object.assign(f)).then(function(a){var p=a.data,X=JSON.parse(p);h(X.total);var E=JSON.parse(X.rows);X.rows?(console.log(E),Array.isArray(E)&&E.length>0?u(E):u([])):u([]),ie(!1)})};return(0,d.useEffect)(function(){(0,n.Y8)().then(function(m){var f=m.data,a=JSON.parse(f).filter(function(p){return p});D(function(p){return p.concat(a)})}),(0,n.IY)().then(function(m){var f=m.data,a=JSON.parse(f).filter(function(p){return p});J(function(p){return p.concat(a)})}),H(A)},[]),(0,t.jsxs)("div",{className:R().link,children:[(0,t.jsxs)("div",{className:R()["link__form-wrap"],children:[(0,t.jsx)(q.Z,{orientation:"left",plain:!0,children:(0,t.jsx)(r.Z,{})}),(0,t.jsxs)(x.A,{layout:"inline",formRef:B,size:"small",onFinish:function(){var m=(0,_.Z)(F().mark(function f(a){var p;return F().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:p=a,Object.keys(a).length>0&&(a.times&&(a.startTime=a.times[0],a.endTime=a.times[1],delete a.times,p=(0,k.Z)({},a)),De(function(oe){return{pageNo:oe.pageNo,pageSize:oe.pageSize,applicationUserName:a.applicationUserName,dbType:a.dbType,msTableName:a.msTableName}})),H(p);case 3:case"end":return E.stop()}},f)}));return function(f){return m.apply(this,arguments)}}(),submitter:{render:function(){return[(0,t.jsx)(I.Z,{type:"primary",htmlType:"submit",icon:(0,t.jsx)(r.Z,{}),className:"br-5 w-80 fs-12",children:"\u67E5\u8BE2"},"edit"),(0,t.jsx)(I.Z,{htmlType:"button",icon:(0,t.jsx)(i.Z,{}),className:"br-5 w-80 fs-12",onClick:function(){var a;(a=B.current)===null||a===void 0||a.resetFields(),H({pageSize:A.pageSize,pageNo:A.pageNo})},children:"\u91CD\u7F6E"},"reset")]}},children:[(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:U,placeholder:"\u7528\u6237\u540D",name:"applicationUserName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:ne,width:"sm",placeholder:"\u6570\u636E\u5E93\u8868\u540D",name:"msTableName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(Y.Z,{options:v,placeholder:"\u64CD\u4F5C\u7C7B\u578B",name:"dbType"},"value")}),(0,t.jsx)(x.A.Group,{children:(0,t.jsx)(L.Z,{width:"md",fieldProps:{placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],bordered:!1},name:"times"})})]})]}),(0,t.jsx)(b.Z,{spinning:V,children:g.length>0?(0,t.jsxs)("div",{className:R().link__content,children:[g.map(function(m){return(0,t.jsx)(w.ZP,{collapsibleIconRender:function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"primary-blue-5 m-0",children:m.header.userName}),(0,t.jsxs)("div",{className:"fs-12",children:[(0,t.jsxs)("span",{className:"mr-20",children:[(0,t.jsx)("span",{className:"in-l",children:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"}),(0,t.jsx)("span",{children:m.header.requestStartTime})]}),(0,t.jsxs)("span",{className:"mt-20",children:[(0,t.jsx)("span",{className:"in-l",children:"URL\uFF1A"}),(0,t.jsx)("span",{children:m.header.url})]})]})]})},className:"link__item-card",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,t.jsx)(Se,{body:m.body,style:R()})},M.uuid())}),(0,t.jsx)("div",{className:R().pages,children:(0,t.jsx)(Q.Z,{total:re,size:"small",onChange:function(f,a){H({pageNo:f,pageSize:a,applicationUserName:A.applicationUserName,msTableName:A.msTableName,dbType:A.dbType,startTime:A.startTime,endTime:A.endTime})},defaultPageSize:20,defaultCurrent:1})})]}):(0,t.jsx)(l.Z,{style:{textAlign:"center",fontSize:"18px",color:"#C0C4CC",marginTop:"100px"},imageStyle:{width:"400px",height:"400px",margin:"0 auto"},image:xe()})})]})},Ce=Ne},54154:function(P,O,e){"use strict";e.d(O,{Y8:function(){return Q},IY:function(){return I},z2:function(){return _},m8:function(){return q},LX:function(){return ee},gY:function(){return d},CX:function(){return Y}});var N=e(11849),b=e(3182),se=e(94043),l=e.n(se),C=e(25377);function Q(r){return G.apply(this,arguments)}function G(){return G=(0,b.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserName",(0,N.Z)({method:"GET"},i||{})));case 1:case"end":return n.stop()}},r)})),G.apply(this,arguments)}function I(r){return k.apply(this,arguments)}function k(){return k=(0,b.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllMsTableName",(0,N.Z)({method:"GET"},i||{})));case 1:case"end":return n.stop()}},r)})),k.apply(this,arguments)}function _(r,i){return $.apply(this,arguments)}function $(){return $=(0,b.Z)(l().mark(function r(i,v){return l().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,C.WY)("/api/skyflying/getAllSegments",(0,N.Z)({method:"GET",timeout:6e4,headers:{"Content-Type":"application/json"},params:i},v||{})));case 1:case"end":return y.stop()}},r)})),$.apply(this,arguments)}function q(r){return c.apply(this,arguments)}function c(){return c=(0,b.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllUserNameFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),c.apply(this,arguments)}function ee(r){return F.apply(this,arguments)}function F(){return F=(0,b.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllSqlTypeFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function d(r){return x.apply(this,arguments)}function x(){return x=(0,b.Z)(l().mark(function r(i){return l().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getAllTableNameFromDMS",(0,N.Z)({timeout:6e4},i||{})));case 1:case"end":return n.stop()}},r)})),x.apply(this,arguments)}function Y(r,i){return L.apply(this,arguments)}function L(){return L=(0,b.Z)(l().mark(function r(i,v){return l().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,C.WY)("/api/skyflying/getDmsAuditLogFromDb",(0,N.Z)({method:"GET",timeout:6e4,params:i},v||{})));case 1:case"end":return y.stop()}},r)})),L.apply(this,arguments)}},6251:function(P,O,e){P.exports=e.p+"static/empty.a9f51423.png"}}]);
