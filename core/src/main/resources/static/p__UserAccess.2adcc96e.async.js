(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[462],{33599:function(M){M.exports={userAccess:"userAccess___1UdBc","detail-wrap":"detail-wrap___2mcEh","tabs-wrap":"tabs-wrap___3PPX8","content-wrap":"content-wrap___2U6yp"}},9578:function(M,U,e){"use strict";e.r(U),e.d(U,{default:function(){return he}});var v=e(3182),p=e(57663),w=e(71577),l=e(34792),m=e(48086),a=e(86582),u=e(2824),o=e(94043),s=e.n(o),n=e(67294),_=e(13062),O=e(71230),b=e(89032),y=e(15746),F=e(90387),J=e(9536),A=e(39004),t=e(85893),f=function(c){return(0,n.useEffect)(function(){var r=new A.kL({container:"ActionPie".concat(c.id),autoFit:!0,height:250});r.data(c.types),r.coordinate("theta",{radius:.75}),r.tooltip({showMarkers:!0}),r.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(h){var T=h.shape;return{matrix:A.Zr.zoom(T,1.1)}}}}).label("type",function(E){var h=E==="select"?1:.5;return{offset:-30,style:{opacity:h,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(C){return C.type+`
`+C.value+"\u6B21"}}}),r.interaction("element-single-selected"),r.render()},[]),(0,t.jsx)("div",{id:"ActionPie"+c.id})},g=f,D=function(c){return(0,n.useEffect)(function(){var r=new A.kL({container:"VisibleTimePie"+c.id,autoFit:!0,height:250});r.data(c.intervals),r.coordinate("theta",{radius:.75}),r.tooltip({showMarkers:!0}),r.interval().adjust("stack").position("value").color("type",["#063d8a","#1770d6","#47abfc","#38c060"]).style({opacity:.4}).state({active:{style:function(h){var T=h.shape;return{matrix:A.Zr.zoom(T,1.1)}}}}).label("type",function(E){var h=E==="select"?1:.5;return{offset:-30,style:{opacity:h,fill:"white",fontSize:12,shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},content:function(C){return C.type+`
`+C.value+"\u6B21"}}}),r.interaction("element-single-selected"),r.render()},[]),(0,t.jsx)("div",{id:"VisibleTimePie"+c.id})},i=D,ie=function(c){return(0,n.useEffect)(function(){var r=new A.kL({container:"RecentlyLine".concat(c.id),autoFit:!0,height:200});r.data(c.ranges),r.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),r.tooltip({showCrosshairs:!0,shared:!0}),r.axis("value",{label:{}}),r.area().position("year*value"),r.line().position("year*value"),r.render()},[]),(0,t.jsx)("div",{id:"RecentlyLine"+c.id})},le=ie,ee=[{label:"\u7ECF\u5E38\u8BBF\u95EE\u7684\u6570\u636E",value:"higher"},{label:"\u4E0D\u5E38\u8BBF\u95EE\u7684\u6570\u636E",value:"lower"}],oe=function(c){var r,E,h,T=(0,n.useState)(ee[0].value),C=(0,u.Z)(T,2),K=C[0],X=C[1];return(0,t.jsxs)(O.Z,{className:c.style["detail-wrap"],children:[(0,t.jsxs)(y.Z,{span:8,className:c.style["tabs-wrap"],children:[(0,t.jsx)(J.Z,{block:!0,options:ee,value:K,onChange:X}),(0,t.jsx)("div",{className:c.style["content-wrap"],children:(r=c.details)===null||r===void 0||(E=r.higherOrLower)===null||E===void 0||(h=E[K])===null||h===void 0?void 0:h.map(function(I){return(0,t.jsxs)("div",{className:"flex-x-sb",children:[(0,t.jsx)("span",{children:I.visitedData}),(0,t.jsxs)("span",{children:["\u8BBF\u95EE",I.visitedCount," \u6B21"]})]},I.visitedData)})})]}),(0,t.jsxs)(y.Z,{span:16,className:"pl-10 pr-20",children:[(0,t.jsxs)(O.Z,{children:[(0,t.jsxs)(y.Z,{span:12,className:"text-c",children:[(0,t.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,t.jsx)(g,{types:c.details.types,id:c.id})]}),(0,t.jsxs)(y.Z,{span:12,className:"text-c",children:[(0,t.jsx)("h3",{children:"\u8BBF\u95EE\u65F6\u6BB5\u5206\u5E03"}),(0,t.jsx)(i,{intervals:c.details.intervals,id:c.id})]})]}),(0,t.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,t.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,t.jsx)(le,{ranges:c.details.ranges,id:c.id})]})]})]})},ce=oe,de=e(33599),te=e.n(de),fe=e(73016),Y=e(6650),me=e(33414),z=e(24480),ae=e(84674),ve=function(){var c=(0,n.useState)(),r=(0,u.Z)(c,2),E=r[0],h=r[1],T=(0,n.useState)(""),C=(0,u.Z)(T,2),K=C[0],X=C[1],I=(0,n.useState)({types:[],intervals:[],ranges:[],higherOrLower:{higher:[],lower:[]}}),ne=(0,u.Z)(I,2),pe=ne[0],_e=ne[1],ge=[{title:"\u7528\u6237\u540D",dataIndex:"userName",key:"applicationUserName",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",search:!1,width:100,align:"center"},{title:"\u5E38\u7528\u6570\u636E",dataIndex:"usualVisitedData",key:"usualVisitedData",align:"center",search:!1,render:function(x,d){var S=JSON.parse(d.usualVisitedData),j=S.tableName,P=S.tableNameDesc,R=j.split(","),W="-";return P?W=P:R.length>1&&(W=R[R.length-1]),(0,t.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:W})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",dataIndex:"lastVisitedDate",key:"lastVisitedDate",search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(x,d){return[(0,t.jsx)(w.Z,{type:"link",size:"small",onClick:function(){if(d.visitedCount!==0){var j=JSON.parse(d.usualVisitedData),P=j.tableName,R=z.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),W=z.Z.getRangeTime(7,"YYYY-mm-dd HH:MM:SS");(0,Y.Xd)({applicationUserName:d.userName,startTime:R[0],endTime:R[1],tableName:P}).then(function(ye){var Q=ye.data;if(Q&&Q.length>0){var De=Q.map(function(B,L){return{year:W[L],value:B}}),re=(0,a.Z)(ae.q);(0,Y.et)({applicationUserName:d.userName,tableName:P}).then(function(B){B.data&&B.data.length>0&&re.forEach(function(L){B.data.forEach(function($){var k=JSON.parse($),Z=k.dbType,G=k.dbTypeTimes;L.type===Z&&(L.value=parseInt(G))})})});var H=(0,a.Z)(ae.Q);(0,me.w)({userName:d.userName}).then(function(B){var L=JSON.parse(B.data),$=JSON.parse(L.rows);if($&&$.length>0){var k=$[0];H[0].value=k.forenoonCount|0,H[1].value=k.afternoonCount|0,H[2].value=k.nightCount|0}(0,Y.Bx)({applicationUserName:d.userName}).then(function(Z){if(Z.data){Z.data.forEach(function(q){var ue=q.visitedData.split("#");return q.visitedData=ue[ue.length-1],q});var G=Math.ceil(Z.data.length/2),Ee=Z.data.splice(0,G),Ce=Z.data.splice(-G);_e(function(){return{types:re,intervals:H,ranges:De,higherOrLower:{higher:Ee,lower:Ce}}}),X(d.id)}})})}})}else m.ZP.info("".concat(d.userName,"\u7528\u6237\u8BBF\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],se=function(){(0,Y.F$)().then(function(x){var d=x.data;d&&d.length>0?h(d.map(function(S){return S.id=z.Z.uuid(),S})):h([])})};return(0,n.useEffect)(function(){se()},[]),(0,t.jsx)("div",{className:te().userAccess,children:(0,t.jsx)(fe.Z,{columns:ge,rowKey:"id",onSubmit:function(){var N=(0,v.Z)(s().mark(function x(d){return s().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:Object.keys(d).length>0?(0,Y.wA)(d).then(function(P){console.log(P)}):se();case 1:case"end":return j.stop()}},x)}));return function(x){return N.apply(this,arguments)}}(),expandable:{expandedRowRender:function(x,d){return(0,t.jsx)(ce,{details:pe,id:d,style:te()},d)},expandIcon:function(){return!1},expandedRowKeys:[K]},dataSource:E})})},he=ve},84674:function(M,U,e){"use strict";e.d(U,{q:function(){return v},Q:function(){return p}});var v=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],p=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},33414:function(M,U,e){"use strict";e.d(U,{N:function(){return a},w:function(){return o}});var v=e(11849),p=e(3182),w=e(94043),l=e.n(w),m=e(32773);function a(n){return u.apply(this,arguments)}function u(){return u=(0,p.Z)(l().mark(function n(_){return l().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,m.WY)("/api/skyflying/getAllUserNamePortraitByVisitedTime",(0,v.Z)({method:"GET"},_||{})));case 1:case"end":return b.stop()}},n)})),u.apply(this,arguments)}function o(n,_){return s.apply(this,arguments)}function s(){return s=(0,p.Z)(l().mark(function n(_,O){return l().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,m.WY)("/api/skyflying/getAllUserPortraitByVisitedTime",(0,v.Z)({method:"GET",params:_||{}},O||{})));case 1:case"end":return y.stop()}},n)})),s.apply(this,arguments)}},6650:function(M,U,e){"use strict";e.d(U,{F$:function(){return a},Xd:function(){return o},et:function(){return O},Bx:function(){return y},wA:function(){return J}});var v=e(11849),p=e(3182),w=e(94043),l=e.n(w),m=e(32773);function a(t){return u.apply(this,arguments)}function u(){return u=(0,p.Z)(l().mark(function t(f){return l().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,m.WY)("/api/skyflying/getCoarseCountsOfUser",(0,v.Z)({method:"GET"},f||{})));case 1:case"end":return D.stop()}},t)})),u.apply(this,arguments)}function o(t,f){return s.apply(this,arguments)}function s(){return s=(0,p.Z)(l().mark(function t(f,g){return l().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,v.Z)({method:"GET",params:f},g||{})));case 1:case"end":return i.stop()}},t)})),s.apply(this,arguments)}function n(t,f){return _.apply(this,arguments)}function _(){return _=_asyncToGenerator(_regeneratorRuntime.mark(function t(f,g){return _regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:f},g||{})));case 1:case"end":return i.stop()}},t)})),_.apply(this,arguments)}function O(t,f){return b.apply(this,arguments)}function b(){return b=(0,p.Z)(l().mark(function t(f,g){return l().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.WY)("/api/skyflying/getCountsOfUser",(0,v.Z)({method:"GET",params:f},g||{})));case 1:case"end":return i.stop()}},t)})),b.apply(this,arguments)}function y(t,f){return F.apply(this,arguments)}function F(){return F=(0,p.Z)(l().mark(function t(f,g){return l().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,v.Z)({method:"GET",params:f},g||{})));case 1:case"end":return i.stop()}},t)})),F.apply(this,arguments)}function J(t,f){return A.apply(this,arguments)}function A(){return A=(0,p.Z)(l().mark(function t(f,g){return l().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.WY)("/api/skyflying/getCoarseCountsOfOneUser",(0,v.Z)({method:"GET",params:f||{}},g||{})));case 1:case"end":return i.stop()}},t)})),A.apply(this,arguments)}},24480:function(M,U,e){"use strict";e.d(U,{Z:function(){return w}});var v=e(69610),p=e(54941),w=function(){function l(){(0,v.Z)(this,l)}return(0,p.Z)(l,null,[{key:"timeStampToTime",value:function(a){var u=new Date(parseInt(a));return u.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",o,s={"Y+":a.getFullYear().toString(),"m+":(a.getMonth()+1).toString(),"d+":a.getDate().toString(),"H+":a.getHours().toString(),"M+":a.getMinutes().toString(),"S+":a.getSeconds().toString()},n=u;for(var _ in s)o=new RegExp("("+_+")").exec(u),o&&(n=n.replace(o[1],o[1].length==1?s[_]:s[_].padStart(o[1].length,"0")));return n}},{key:"uuid",value:function(){for(var a=[],u="0123456789abcdef",o=0;o<36;o++)a[o]=u.substr(Math.floor(Math.random()*16),1);return a[14]="4",a[19]=u.substr(a[19]&3|8,1),a[8]=a[13]=a[18]=a[23]="-",a.join("").replace(new RegExp(/(-)/g),"")}},{key:"getRangeTime",value:function(a,u){for(var o=[],s=a-1;s>=0;s--){var n=void 0;s===a-1?n=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,1,0):n=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),u?o.push(l.getLocalTime(new Date(n),u)):o.push(n)}return o}},{key:"getRangeStartAndEndTime",value:function(a,u){for(var o=[],s=a-1;s>=0;s--){var n=void 0;s===a-1?n=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,0,0):s===0?n=new Date(Date.now()-(s-1)*24*60*60*1e3).setHours(0,0,0,0):n=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),u?o.push(l.getLocalTime(new Date(n),u)):o.push(n)}return[o[0],o[a-1]]}}]),l}();w.arrayDeDuplication=function(l){return Array.from(new Set(l))}}}]);
