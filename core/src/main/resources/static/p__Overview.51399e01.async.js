(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[628],{26516:function(G){G.exports={overview:"overview___ZXPWZ",staticWrap:"staticWrap___2Invp",waringWrap:"waringWrap___AfQ25",bgW:"bgW___3rDWk",center:"center___21dU2",nowrap:"nowrap___spq6f"}},81135:function(G,N,e){"use strict";e.r(N),e.d(N,{default:function(){return je}});var U=e(57663),C=e(71577),k=e(58024),n=e(39144),_=e(13062),a=e(71230),u=e(95300),r=e(7277),s=e(89032),i=e(15746),j=e(71748),d=e(33860),E=e(3182),S=e(2824),w=e(94043),c=e.n(w),b=e(67294),m=e(26516),o=e.n(m),Z=e(11849),W=e(46066),l=e(68628),t=e(85893),oe=function(A){var O={dots:!1,innerSlider:!0,slidesToShow:6,slidesToScroll:1,vertical:!0,verticalSwiping:!0,autoplay:!0,speed:2e3,autoplaySpeed:2e3,arrows:!1,cssEase:"linear"};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Z,{className:"fs-16 ib danger mr-10"}),(0,t.jsx)("h3",{className:"danger fs-16 ib",children:"\u544A\u8B66\u4FE1\u606F"})]}),(0,t.jsx)("div",{className:"of-hidden",children:(0,t.jsx)(W.Z,(0,Z.Z)((0,Z.Z)({},O),{},{children:A.warningList.map(function(f){return(0,t.jsx)("div",{className:"mt-5 mb-5 text-c lh-2",children:f.alarmContent},f.id)})}))})]})},ce=oe,de=e(69610),me=e(54941),pe=e(81306),ve=e(19809),K=e(69886),F=e(41694),fe=K.G2.InteractionAction,ge=K.G2.registerInteraction,he=K.G2.registerAction,_e=function(B){(0,pe.Z)(O,B);var A=(0,ve.Z)(O);function O(){return(0,de.Z)(this,O),A.apply(this,arguments)}return(0,me.Z)(O,[{key:"active",value:function(){var p=this,T=this.getView(),g=this.context.event;if(g.data){var h=g.data.items,R=T.geometries.filter(function(P){return P.type==="point"});(0,F.S6)(R,function(P){(0,F.S6)(P.elements,function(L,V){var $=(0,F.cx)(h,function(X){return X.data===L.data})!==-1,H=L.shape.getChildren(),Y=(0,S.Z)(H,2),J=Y[0],ae=Y[1];$?(J.animate({r:10,opacity:.2},{duration:1800,easing:"easeLinear",repeat:!0}),ae.animate({r:6,opacity:.4},{duration:800,easing:"easeLinear",repeat:!0})):p.resetElementState(L)})})}}},{key:"reset",value:function(){var p=this,T=this.getView(),g=T.geometries.filter(function(h){return h.type==="point"});(0,F.S6)(g,function(h){(0,F.S6)(h.elements,function(R){p.resetElementState(R)})})}},{key:"resetElementState",value:function(p){var T=p.shape.getChildren(),g=(0,S.Z)(T,2),h=g[0],R=g[1];h.stopAnimate(),R.stopAnimate();var P=h.get("attrs"),L=P.r,V=P.opacity;h.attr({r:L,opacity:V});var $=R.get("attrs"),H=$.r,Y=$.opacity;R.attr({r:H,opacity:Y})}},{key:"getView",value:function(){return this.context.view}}]),O}(fe),ye=function(A){return(0,b.useEffect)(function(){K.G2.registerShape("point","custom-point",{draw:function(p,T){var g={x:p.x,y:p.y},h=T.addGroup();return h.addShape("circle",{name:"outer-point",attrs:{x:g.x,y:g.y,fill:p.color||"red",opacity:.5,r:6}}),h.addShape("circle",{name:"inner-point",attrs:{x:g.x,y:g.y,fill:p.color||"red",opacity:1,r:2}}),h}}),he("custom-marker-action",_e),ge("custom-marker-interaction",{start:[{trigger:"tooltip:show",action:"custom-marker-action:active"}],end:[{trigger:"tooltip:hide",action:"custom-marker-action:reset"}]});var O=new K.x1("RangeTimeData",{height:138,autoFit:!0,data:A.data,xField:"year",yField:"value",label:{},point:{size:5,shape:"custom-point",style:{fill:"white",stroke:"#5B8FF9",lineWidth:2}},tooltip:{showMarkers:!1},state:{active:{style:{shadowBlur:4,stroke:"#000",fill:"red"}}},interactions:[{type:"custom-marker-interaction"}]});O.render()},[]),(0,t.jsx)("div",{id:"RangeTimeData"})},De=ye,re=e(47369),z=e(24480),Ce=e(6650),se=e(32773);function Ee(B,A){return ee.apply(this,arguments)}function ee(){return ee=(0,E.Z)(c().mark(function B(A,O){return c().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,se.WY)("/api/skyflying/getCountsOfAllRecentSevenDays",(0,Z.Z)({params:A,method:"GET"},O||{})));case 1:case"end":return p.stop()}},B)})),ee.apply(this,arguments)}function Se(B){return te.apply(this,arguments)}function te(){return te=(0,E.Z)(c().mark(function B(A){return c().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,se.WY)("/api/skyflying/getOverviewOfSystem",(0,Z.Z)({method:"GET"},A||{})));case 1:case"end":return f.stop()}},B)})),te.apply(this,arguments)}var Oe=e(66572),Ze=e(2335),Te=e(52778),xe=[{title:"\u7528\u6237\u540D",dataIndex:"userName",key:"name",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",search:!1,align:"center"},{title:"\u5E38\u7528\u6570\u636E",dataIndex:"usualVisitedData",key:"usualVisitedData",align:"center",search:!1,render:function(A,O){var f=JSON.parse(O.usualVisitedData),p=f.tableName,T=p.split(","),g="-";if(T.length===1)g=T[0];else if(T.length>1){var h=T.filter(function(R,P){return P!==0});g=h.join(",")}return(0,t.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:g})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",dataIndex:"lastVisitedDate",key:"lastVisitedDate",search:!1,align:"center"}],Ue=[{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center"},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center"},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"date",hideInSetting:!0,align:"center"}],Ae=function(A){var O=(0,b.useState)(),f=(0,S.Z)(O,2),p=f[0],T=f[1],g=(0,b.useState)([]),h=(0,S.Z)(g,2),R=h[0],P=h[1],L=(0,b.useState)([]),V=(0,S.Z)(L,2),$=V[0],H=V[1],Y=(0,b.useState)([]),J=(0,S.Z)(Y,2),ae=J[0],X=J[1],be=(0,b.useState)(0),ie=(0,S.Z)(be,2),we=ie[0],Re=ie[1],We=(0,b.useState)({pageSize:20,pageNo:1}),Be=(0,S.Z)(We,1),ne=Be[0],Me=(0,b.useState)({dbInstance:0,table:0,user:0,visitedInformation:0}),ue=(0,S.Z)(Me,2),Q=ue[0],Ie=ue[1];function Ne(){(0,Ze.cD)({pageSize:100,pageNo:1}).then(function(M){var v=M.data;if(v){var y=JSON.parse(v);if(y){var D=JSON.parse(y.rows);X(D.map(function(x,I){return x.matchRuleId=I,x})),console.log(D)}else X([])}})}var Pe=function(){(0,Ce.F$)().then(function(v){var y=v.data;if(y&&y.length>0){T(y.map(function(x){return x.id=z.Z.uuid(),x}));var D=[];y.forEach(function(x){D.push({level:1,name:x.userName,childrenNum:5,id:x.userName})}),console.log(D)}else T([])})},ke=function(){var v=z.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),y=z.Z.getRangeTime(7,"mm-dd");Ee({startTime:v[0],endTime:v[1]}).then(function(D){var x=D.data;P(function(){return x.map(function(I,q){return{year:y[q],value:I}})})})},Le=function(){var M=(0,E.Z)(c().mark(function v(){var y,D;return c().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,Se();case 2:y=I.sent,D=y.data,Ie(D);case 5:case"end":return I.stop()}},v)}));return function(){return M.apply(this,arguments)}}(),$e=function(){var M=(0,E.Z)(c().mark(function v(){return c().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:case"end":return D.stop()}},v)}));return function(){return M.apply(this,arguments)}}(),le=function(v){(0,Oe.m)(v).then(function(y){var D=y.data;if(D){var x=JSON.parse(D);Re(x.total);var I=JSON.parse(x.rows);console.log(x),H(I.map(function(q){return q.id=z.Z.uuid(),q}))}})};return(0,b.useEffect)(function(){Pe(),ke(),le(ne),Le().then(),$e().then(),Ne(),console.log(new Date("2022-07-20T03:22:09.000+0000"))},[]),(0,t.jsxs)("div",{className:o().overview,children:[(0,t.jsx)("div",{className:o().staticWrap,children:(0,t.jsxs)(a.Z,{gutter:20,children:[(0,t.jsx)(i.Z,{span:8,children:(0,t.jsx)(d.Z,{active:!0,loading:R.length===0,children:(0,t.jsx)(Te.Z,{title:"\u8FD1\u4E03\u5929\u6570\u636E\u6536\u96C6\u60C5\u51B5",chart:(0,t.jsx)("div",{style:{height:"163px"},children:(0,t.jsx)(De,{data:R})})})})}),(0,t.jsx)(i.Z,{span:8,children:(0,t.jsx)(n.Z,{className:o().bgW,title:(0,t.jsx)("div",{className:"text-c",children:"\u6570\u636E\u7EDF\u8BA1\u60C5\u51B5"}),children:(0,t.jsx)(a.Z,{gutter:20,className:"text-c",style:{height:"162px"},children:(0,t.jsxs)(d.Z,{active:!0,loading:R.length===0,children:[(0,t.jsx)(i.Z,{span:12,className:"mt-15 text-c",children:(0,t.jsx)(r.Z,{title:"\u5DF2\u6536\u96C6\u4FE1\u606F",value:Q.visitedInformation,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(i.Z,{span:12,className:"mt-15",children:(0,t.jsx)(r.Z,{title:"\u6570\u636E\u5E93\u4E2A\u6570",value:Q.dbInstance,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(i.Z,{span:12,className:"mt-20",children:(0,t.jsx)(r.Z,{title:"\u7528\u6237\u4EBA\u6570",value:Q.user,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(i.Z,{span:12,className:"mt-20",children:(0,t.jsx)(r.Z,{title:"\u6570\u636E\u5E93\u8868",value:Q.table,valueStyle:{color:"#3f8600"}})})]})})})}),(0,t.jsx)(i.Z,{span:8,children:(0,t.jsx)("div",{className:o().waringWrap,children:(0,t.jsx)(ce,{warningList:ae})})})]})}),(0,t.jsx)("div",{className:o().center,children:(0,t.jsxs)(a.Z,{gutter:30,children:[(0,t.jsx)(i.Z,{span:12,children:(0,t.jsx)(re.ZP,{columns:xe,dataSource:p,scroll:{y:500},options:!1,toolBarRender:function(){return[(0,t.jsx)(C.Z,{type:"link",size:"small",onClick:function(){A.history.push("/user-access")},children:"\u8BE6\u60C5"},"user-link")]},rowKey:"id",search:!1,pagination:!1,headerTitle:"\u7528\u6237\u8BBF\u95EE\u884C\u4E3A"})}),(0,t.jsx)(i.Z,{span:12,className:"pr-10",children:(0,t.jsx)(d.Z,{active:!0,loading:$.length===0,paragraph:{rows:5},children:(0,t.jsx)(re.ZP,{scroll:{y:500},columns:Ue,dataSource:$,options:!1,rowKey:"id",search:!1,pagination:{total:we,pageSize:ne.pageSize,current:ne.pageNo,onChange:function(v,y){le({pageNo:v,pageSize:y})}},toolBarRender:function(){return[(0,t.jsx)(C.Z,{type:"link",size:"small",onClick:function(){A.history.push("/databases")},children:"\u8BE6\u60C5"},"data-link")]},headerTitle:"\u6570\u636E\u8BBF\u95EE\u884C\u4E3A"})})})]})})]})},je=Ae},66572:function(G,N,e){"use strict";e.d(N,{m:function(){return a}});var U=e(11849),C=e(3182),k=e(94043),n=e.n(k),_=e(21704);function a(r,s){return u.apply(this,arguments)}function u(){return u=(0,C.Z)(n().mark(function r(s,i){return n().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,_.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,U.Z)({method:"GET",params:s},i||{})));case 1:case"end":return d.stop()}},r)})),u.apply(this,arguments)}},6650:function(G,N,e){"use strict";e.d(N,{F$:function(){return a},Xd:function(){return r},et:function(){return d},Bx:function(){return S},wA:function(){return c}});var U=e(11849),C=e(3182),k=e(94043),n=e.n(k),_=e(32773);function a(m){return u.apply(this,arguments)}function u(){return u=(0,C.Z)(n().mark(function m(o){return n().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",(0,_.WY)("/api/skyflying/getCoarseCountsOfUser",(0,U.Z)({method:"GET"},o||{})));case 1:case"end":return W.stop()}},m)})),u.apply(this,arguments)}function r(m,o){return s.apply(this,arguments)}function s(){return s=(0,C.Z)(n().mark(function m(o,Z){return n().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,_.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,U.Z)({method:"GET",params:o},Z||{})));case 1:case"end":return l.stop()}},m)})),s.apply(this,arguments)}function i(m,o){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime.mark(function m(o,Z){return _regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:o},Z||{})));case 1:case"end":return l.stop()}},m)})),j.apply(this,arguments)}function d(m,o){return E.apply(this,arguments)}function E(){return E=(0,C.Z)(n().mark(function m(o,Z){return n().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,_.WY)("/api/skyflying/getCountsOfUser",(0,U.Z)({method:"GET",params:o},Z||{})));case 1:case"end":return l.stop()}},m)})),E.apply(this,arguments)}function S(m,o){return w.apply(this,arguments)}function w(){return w=(0,C.Z)(n().mark(function m(o,Z){return n().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,_.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,U.Z)({method:"GET",params:o},Z||{})));case 1:case"end":return l.stop()}},m)})),w.apply(this,arguments)}function c(m,o){return b.apply(this,arguments)}function b(){return b=(0,C.Z)(n().mark(function m(o,Z){return n().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,_.WY)("/api/skyflying/getCoarseCountsOfOneUser",(0,U.Z)({method:"GET",params:o||{}},Z||{})));case 1:case"end":return l.stop()}},m)})),b.apply(this,arguments)}},2335:function(G,N,e){"use strict";e.d(N,{rO:function(){return a},cD:function(){return r},sF:function(){return i}});var U=e(11849),C=e(3182),k=e(94043),n=e.n(k),_=e(32773);function a(d){return u.apply(this,arguments)}function u(){return u=(0,C.Z)(n().mark(function d(E){return n().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,_.WY)("/api/skyflying/getUserNameAnomalyDetectionInfo",(0,U.Z)({method:"GET"},E||{})));case 1:case"end":return w.stop()}},d)})),u.apply(this,arguments)}function r(d,E){return s.apply(this,arguments)}function s(){return s=(0,C.Z)(n().mark(function d(E,S){return n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,_.WY)("/api/skyflying/getAllAlarmInfoDetailByUserName",(0,U.Z)({method:"GET",params:E||{}},S||{})));case 1:case"end":return c.stop()}},d)})),s.apply(this,arguments)}function i(d,E){return j.apply(this,arguments)}function j(){return j=(0,C.Z)(n().mark(function d(E,S){return n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,_.WY)("/api/skyflying/getAnomalyDetectionInfoByGroupByUserName",(0,U.Z)({method:"GET",params:E||{}},S||{})));case 1:case"end":return c.stop()}},d)})),j.apply(this,arguments)}},24480:function(G,N,e){"use strict";e.d(N,{Z:function(){return k}});var U=e(69610),C=e(54941),k=function(){function n(){(0,U.Z)(this,n)}return(0,C.Z)(n,null,[{key:"timeStampToTime",value:function(a){var u=new Date(parseInt(a));return u.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",r,s={"Y+":a.getFullYear().toString(),"m+":(a.getMonth()+1).toString(),"d+":a.getDate().toString(),"H+":a.getHours().toString(),"M+":a.getMinutes().toString(),"S+":a.getSeconds().toString()},i=u;for(var j in s)r=new RegExp("("+j+")").exec(u),r&&(i=i.replace(r[1],r[1].length==1?s[j]:s[j].padStart(r[1].length,"0")));return i}},{key:"uuid",value:function(){for(var a=[],u="0123456789abcdef",r=0;r<36;r++)a[r]=u.substr(Math.floor(Math.random()*16),1);return a[14]="4",a[19]=u.substr(a[19]&3|8,1),a[8]=a[13]=a[18]=a[23]="-",a.join("").replace(new RegExp(/(-)/g),"")}},{key:"getRangeTime",value:function(a,u){for(var r=[],s=a-1;s>=0;s--){var i=void 0;s===a-1?i=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,1,0):i=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),u?r.push(n.getLocalTime(new Date(i),u)):r.push(i)}return r}},{key:"getRangeStartAndEndTime",value:function(a,u){for(var r=[],s=a-1;s>=0;s--){var i=void 0;s===a-1?i=new Date(Date.now()-s*24*60*60*1e3).setHours(0,0,0,0):s===0?i=new Date(Date.now()-(s-1)*24*60*60*1e3).setHours(0,0,0,0):i=new Date(Date.now()-s*24*60*60*1e3).setHours(23,59,59,999),u?r.push(n.getLocalTime(new Date(i),u)):r.push(i)}return[r[0],r[a-1]]}}]),n}();k.arrayDeDuplication=function(n){return Array.from(new Set(n))}}}]);
