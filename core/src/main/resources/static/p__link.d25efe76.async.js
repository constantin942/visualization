(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[72],{82277:function(I){I.exports={"link__form-wrap":"link__form-wrap___4fdvJ",link__content:"link__content___oPe_t",pages:"pages___3NUwO","link__item-card":"link__item-card___y2kSX",link:"link___s0XZS","detail-table":"detail-table___2NvnS","ant-table-tbody":"ant-table-tbody___2xnJD","is-active":"is-active___3dJbi"}},87633:function(I,D,e){"use strict";e.r(D),e.d(D,{default:function(){return Ze}});var T=e(20228),y=e(11382),U=e(13254),s=e(14277),b=e(14781),u=e(23492),f=e(57663),d=e(71577),g=e(11849),A=e(3182),E=e(48736),_=e(27049),m=e(2824),q=e(94043),M=e.n(q),c=e(67294),j=e(5894),F=e(64317),O=e(78844),r=e(76570),o=e(25592),x=["select","insert","update","delete"],n=e(54154),N=e(87593),ie=e(37636),Ie=e(49111),ce=e(19650),pe=e(14650),G=e(39265),k=e(24480),fe=e(95357),Ue=e(71194),ge=e(50146),t=e(85893),he=function(h){return(0,t.jsx)(ge.Z,{visible:h.detailVisible,title:"\u8BBF\u95EE\u8BE6\u60C5",onCancel:function(){return h.setVisible(!1)}})},ve=he,ye=function(h){var R=function(){return h.body.length===1?h.body[0].segments.filter(function(Z){return Z.peer}):h.body[0].segments},$=(0,c.useState)(0),P=(0,m.Z)($,2),ee=P[0],w=P[1],te=(0,c.useState)(!1),J=(0,m.Z)(te,2),ne=J[0],Y=J[1],ae=(0,c.useState)(R().map(function(S){return S.id=k.Z.uuid(),S})),K=(0,m.Z)(ae,2),B=K[0],se=K[1],V=[{title:"\u64CD\u4F5C\u6570\u636E",dataIndex:"function",align:"center",ellipsis:!0},{title:"IP",dataIndex:"peer",align:"center"},{title:"\u6570\u636E\u5E93\u8D26\u53F7",dataIndex:"dbUserName",align:"center"},{title:"\u6570\u636E\u5E93\u5B9E\u4F8B",dataIndex:"dbInstance",align:"center"},{title:"\u6570\u636E\u5E93\u8868\u540D",dataIndex:"dbTableName",align:"center"},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"dbType",align:"center"},{title:"SQL\u8BED\u53E5",dataIndex:"dbStatement",ellipsis:!0,copyable:!0,search:!1},{title:"Action",key:"action",align:"center",fixed:"right",render:function(){return(0,t.jsx)(ce.Z,{children:(0,t.jsx)(d.Z,{icon:(0,t.jsx)(fe.Z,{}),size:"small",className:"fs-12",type:"link",onClick:function(){Y(!0)},children:"\u8BE6\u60C5"})})}}],re=function(Z,z){w(z),se(Z.map(function(H){return H.id=k.Z.uuid(),H}))};return(0,t.jsxs)("div",{className:h.style["detail-table"],children:[(0,t.jsxs)(G.ZP,{split:"vertical",children:[h.body.length>1&&(0,t.jsx)(G.ZP,{colSpan:"30%",children:(0,t.jsx)(ie.Z,{children:h.body.map(function(S,Z){return(0,t.jsx)(ie.Z.Item,{color:S.segments.length>1?"#00CCFF":"green",className:"pointer pb-10",children:(0,t.jsx)("div",{onClick:function(){re(S.segments,Z)},children:(0,t.jsx)("p",{className:ee===Z?h.style["is-active"]:"",children:S.url})})},k.Z.uuid())})})}),(0,t.jsx)(G.ZP,{headerBordered:!0,children:B.length>0?(0,t.jsx)(pe.ZP,{columns:V,options:!1,size:"small",dataSource:B,rowKey:"id",search:!1,pagination:!1}):(0,t.jsx)(s.Z,{description:"\u6682\u65E0\u64CD\u4F5C\u6570\u636E"})})]}),(0,t.jsx)(ve,{detailVisible:ne,setVisible:Y})]})},be=ye,Se=e(6251),Te=e.n(Se),xe=e(82277),L=e.n(xe),Ne=[],je=function(){var h=(0,c.useState)([]),R=(0,m.Z)(h,2),$=R[0],P=R[1],ee=(0,c.useState)(Ne),w=(0,m.Z)(ee,2),te=w[0],J=w[1],ne=(0,c.useState)([]),Y=(0,m.Z)(ne,2),ae=Y[0],K=Y[1],B=(0,c.useRef)(),se=(0,c.useState)(0),V=(0,m.Z)(se,2),re=V[0],S=V[1],Z=(0,c.useState)(!1),z=(0,m.Z)(Z,2),H=z[0],oe=z[1],Ce=(0,c.useState)([]),de=(0,m.Z)(Ce,2),De=de[0],Ae=de[1],Ee=(0,c.useState)({pageNo:1,pageSize:20}),me=(0,m.Z)(Ee,2),C=me[0],_e=me[1],X=function(v){oe(!0),(0,n.z2)(Object.assign(v)).then(function(a){var i=a.data,l=JSON.parse(i);S(l.total);var W=JSON.parse(l.rows);l.rows?(console.log(W),Array.isArray(W)&&W.length>0?P(W):P([])):P([]),oe(!1)})};return(0,c.useEffect)(function(){(0,n.Y8)().then(function(p){var v=p.data,a=JSON.parse(v).filter(function(i){return i});J(function(i){return i.concat(a)})}),(0,n.IY)().then(function(p){var v=p.data,a=JSON.parse(v).filter(function(l){return l.msTableName}),i=a.map(function(l){return l.label=l.dbInstance+"#"+l.msTableName,l.value=l.msTableName,l.id=k.Z.uuid(),l});Ae(i),K(function(){return i.map(function(l){return l.label})})}),X(C)},[]),(0,t.jsxs)("div",{className:L().link,children:[(0,t.jsxs)("div",{className:L()["link__form-wrap"],children:[(0,t.jsx)(_.Z,{orientation:"left",plain:!0,children:(0,t.jsx)(r.Z,{})}),(0,t.jsxs)(j.A,{layout:"inline",formRef:B,size:"small",onFinish:function(){var p=(0,A.Z)(M().mark(function v(a){var i,l;return M().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:i=a,Object.keys(a).length>0&&(a.times&&(a.startTime=a.times[0],a.endTime=a.times[1],delete a.times,i=(0,g.Z)({},a)),a.msTableName&&(l=De.find(function(Q){return Q.label===a.msTableName}),l&&(a.msTableName=l.msTableName,a.dbInstance=l.dbInstance,i=(0,g.Z)({},a))),_e(function(Q){return{pageNo:Q.pageNo,pageSize:Q.pageSize,applicationUserName:i.applicationUserName,dbType:i.dbType,msTableName:i.msTableName,startTime:i.startTime,endTime:i.endTime,dbInstance:i.dbInstance}})),X(i);case 3:case"end":return le.stop()}},v)}));return function(v){return p.apply(this,arguments)}}(),submitter:{render:function(){return[(0,t.jsx)(d.Z,{type:"primary",htmlType:"submit",icon:(0,t.jsx)(r.Z,{}),className:"br-5 w-80 fs-12",children:"\u67E5\u8BE2"},"edit"),(0,t.jsx)(d.Z,{htmlType:"button",icon:(0,t.jsx)(o.Z,{}),className:"br-5 w-80 fs-12",onClick:function(){var a;(a=B.current)===null||a===void 0||a.resetFields(),X({pageSize:C.pageSize,pageNo:C.pageNo})},children:"\u91CD\u7F6E"},"reset")]}},children:[(0,t.jsx)(j.A.Group,{children:(0,t.jsx)(F.Z,{options:te,placeholder:"\u7528\u6237\u540D",name:"applicationUserName",filedConfig:{},fieldProps:{}},"value")}),(0,t.jsx)(j.A.Group,{children:(0,t.jsx)(F.Z,{options:ae,width:"md",placeholder:"\u6570\u636E\u5E93\u8868\u540D",name:"msTableName",filedConfig:{},fieldProps:{}})}),(0,t.jsx)(j.A.Group,{children:(0,t.jsx)(F.Z,{options:x,placeholder:"\u64CD\u4F5C\u7C7B\u578B",name:"dbType"},"value")}),(0,t.jsx)(j.A.Group,{children:(0,t.jsx)(O.Z,{width:"md",fieldProps:{placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],bordered:!1},name:"times"})})]})]}),(0,t.jsx)(y.Z,{spinning:H,children:$.length>0?(0,t.jsxs)("div",{className:L().link__content,children:[$.map(function(p){return(0,t.jsx)(G.ZP,{collapsibleIconRender:function(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"primary-blue-5 m-0",children:p.header.userName}),(0,t.jsxs)("div",{className:"fs-12",children:[(0,t.jsxs)("span",{className:"mr-20",children:[(0,t.jsx)("span",{className:"in-l",children:"\u64CD\u4F5C\u65F6\u95F4\uFF1A"}),(0,t.jsx)("span",{children:p.header.requestStartTime})]}),(0,t.jsxs)("span",{className:"mt-20",children:[(0,t.jsx)("span",{className:"in-l",children:"URL\uFF1A"}),(0,t.jsx)("span",{children:p.header.url})]})]})]})},className:"link__item-card",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,t.jsx)(be,{body:p.body,style:L()})},k.Z.uuid())}),(0,t.jsx)("div",{className:L().pages,children:(0,t.jsx)(u.Z,{total:re,size:"small",onChange:function(v,a){X({pageNo:v,pageSize:a,applicationUserName:C.applicationUserName,msTableName:C.msTableName,dbType:C.dbType,startTime:C.startTime,endTime:C.endTime,dbInstance:C.dbInstance})},defaultPageSize:20,defaultCurrent:1})})]}):(0,t.jsx)(s.Z,{style:{textAlign:"center",fontSize:"18px",color:"#C0C4CC",marginTop:"100px"},imageStyle:{width:"400px",height:"400px",margin:"0 auto"},image:Te()})})]})},Ze=je},54154:function(I,D,e){"use strict";e.d(D,{Y8:function(){return u},IY:function(){return d},z2:function(){return A},m8:function(){return _},LX:function(){return q},gY:function(){return c},CX:function(){return F}});var T=e(11849),y=e(3182),U=e(94043),s=e.n(U),b=e(25377);function u(r){return f.apply(this,arguments)}function f(){return f=(0,y.Z)(s().mark(function r(o){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,b.WY)("/api/skyflying/getAllUserName",(0,T.Z)({method:"GET"},o||{})));case 1:case"end":return n.stop()}},r)})),f.apply(this,arguments)}function d(r){return g.apply(this,arguments)}function g(){return g=(0,y.Z)(s().mark(function r(o){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,b.WY)("/api/skyflying/getAllInstanceAndTableName",(0,T.Z)({method:"GET"},o||{})));case 1:case"end":return n.stop()}},r)})),g.apply(this,arguments)}function A(r,o){return E.apply(this,arguments)}function E(){return E=(0,y.Z)(s().mark(function r(o,x){return s().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",(0,b.WY)("/api/skyflying/getAllSegments",(0,T.Z)({method:"GET",timeout:6e4,headers:{"Content-Type":"application/json"},params:o},x||{})));case 1:case"end":return N.stop()}},r)})),E.apply(this,arguments)}function _(r){return m.apply(this,arguments)}function m(){return m=(0,y.Z)(s().mark(function r(o){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,b.WY)("/api/skyflying/getAllUserNameFromDMS",(0,T.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},r)})),m.apply(this,arguments)}function q(r){return M.apply(this,arguments)}function M(){return M=(0,y.Z)(s().mark(function r(o){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,b.WY)("/api/skyflying/getAllSqlTypeFromDMS",(0,T.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},r)})),M.apply(this,arguments)}function c(r){return j.apply(this,arguments)}function j(){return j=(0,y.Z)(s().mark(function r(o){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,b.WY)("/api/skyflying/getAllTableNameFromDMS",(0,T.Z)({timeout:6e4},o||{})));case 1:case"end":return n.stop()}},r)})),j.apply(this,arguments)}function F(r,o){return O.apply(this,arguments)}function O(){return O=(0,y.Z)(s().mark(function r(o,x){return s().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",(0,b.WY)("/api/skyflying/getDmsAuditLogFromDb",(0,T.Z)({method:"GET",timeout:6e4,params:o},x||{})));case 1:case"end":return N.stop()}},r)})),O.apply(this,arguments)}},24480:function(I,D,e){"use strict";e.d(D,{Z:function(){return U}});var T=e(69610),y=e(54941),U=function(){function s(){(0,T.Z)(this,s)}return(0,y.Z)(s,null,[{key:"timeStampToTime",value:function(u){var f=new Date(parseInt(u));return f.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",d=u||new Date,g,A={"Y+":d.getFullYear().toString(),"m+":this.twoCompletion(d.getMonth()+1),"d+":this.twoCompletion(d.getDate()),"H+":this.twoCompletion(d.getHours()),"M+":this.twoCompletion(d.getMinutes()),"S+":this.twoCompletion(d.getSeconds())},E="";return Object.keys(A).forEach(function(_){g=new RegExp("("+_+")").exec(f),g&&(E=f.replace(g[1],g[1].length===1?A[_]:A[_].padStart(g[1].length,"0")))}),E}},{key:"uuid",value:function(){for(var u=[],f="0123456789abcdef",d=0;d<36;d++)u[d]=f.substr(Math.floor(Math.random()*16),1);return u[14]="4",u[19]=f.substr(u[19]&3|8,1),u[8]=u[13]=u[18]=u[23]="-",u.join("").replace(new RegExp(/(-)/g),"")}}]),s}();U.arrayDeDuplication=function(s){return Array.from(new Set(s))},U.twoCompletion=function(s){return s.toString().padStart(2,"0")}},6251:function(I,D,e){I.exports=e.p+"static/empty.a9f51423.png"}}]);
