<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mingshi.skyflying.dao.MsThirdPartyTableListMapper">
  <resultMap id="BaseResultMap" type="com.mingshi.skyflying.domain.MsThirdPartyTableListDo">
    <id column="id" jdbcType="INTEGER" property="id"/>
    <result column="is_delete" jdbcType="TINYINT" property="isDelete"/>
    <result column="gmt_create" jdbcType="TIMESTAMP" property="gmtCreate"/>
    <result column="gmt_modified" jdbcType="TIMESTAMP" property="gmtModified"/>
    <result column="third_party_name" jdbcType="VARCHAR" property="thirdPartyName"/>
    <result column="third_party_db_name" jdbcType="VARCHAR" property="thirdPartyDbName"/>
    <result column="third_party_table_name" jdbcType="VARCHAR" property="thirdPartyTableName"/>
    <result column="table_desc" jdbcType="VARCHAR" property="tableDesc"/>
  </resultMap>
  <sql id="Base_Column_List">
    id
    , is_delete, gmt_create, gmt_modified, third_party_name, third_party_db_name, third_party_table_name, table_desc
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List"/>
    from ms_third_party_table_list
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectByTableName" parameterType="java.lang.String" resultMap="BaseResultMap">
    select id
         , is_delete, third_party_name, third_party_db_name, third_party_table_name, table_desc
    from ms_third_party_table_list
    where is_delete != 1 and third_party_table_name = #{tableName}
  </select>
  <select id="selectByDbNameAndTableName" parameterType="java.util.Map" resultType="java.util.Map">
    select id as thirdPartyNameId
    from ms_third_party_table_list
    <where>
      <if test="dbName != null and  dbName != null   ">
        third_party_db_name = #{dbName}
      </if>
      <if test="tableName != null and  tableName != null   ">
        and third_party_table_name = #{tableName}
      </if>
    </where>
    order by id desc
    <if test="pageNo != null and  pageSize != null   ">
      LIMIT #{pageNo},#{pageSize}
    </if>
  </select>

  <select id="selectAllTables" parameterType="java.lang.String" resultType="java.lang.String">
    SELECT table_name
    FROM information_schema.tables
    WHERE table_schema = #{dbName,jdbcType=VARCHAR}
  </select>
  <select id="selectAllTablesByDbName" parameterType="java.lang.String" resultMap="BaseResultMap">
    SELECT id, third_party_name, third_party_db_name, third_party_table_name
    FROM ms_third_party_table_list
    WHERE third_party_db_name = #{thirdPartyDbName,jdbcType=VARCHAR}
  </select>
  <insert id="insertSelective" parameterType="com.mingshi.skyflying.domain.MsThirdPartyTableListDo">
    insert into ms_third_party_table_list
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="isDelete != null">
        is_delete,
      </if>
      <if test="gmtCreate != null">
        gmt_create,
      </if>
      <if test="gmtModified != null">
        gmt_modified,
      </if>
      <if test="thirdPartyName != null">
        third_party_name,
      </if>
      <if test="thirdPartyDbName != null">
        third_party_db_name,
      </if>
      <if test="thirdPartyTableName != null">
        third_party_table_name,
      </if>
      <if test="tableDesc != null">
        table_desc,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="isDelete != null">
        #{isDelete,jdbcType=TINYINT},
      </if>
      <if test="gmtCreate != null">
        #{gmtCreate,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtModified != null">
        #{gmtModified,jdbcType=TIMESTAMP},
      </if>
      <if test="thirdPartyName != null">
        #{thirdPartyName,jdbcType=VARCHAR},
      </if>
      <if test="thirdPartyDbName != null">
        #{thirdPartyDbName,jdbcType=VARCHAR},
      </if>
      <if test="thirdPartyTableName != null">
        #{thirdPartyTableName,jdbcType=VARCHAR},
      </if>
      <if test="tableDesc != null">
        #{tableDesc,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <insert id="insertBatch" parameterType="java.util.List">
    insert into ms_third_party_table_list
    ( third_party_name, third_party_db_name, third_party_table_name, table_desc)
    values
    <foreach collection="list" item="item" index="index" separator=",">
      (
      #{item.thirdPartyName,jdbcType=VARCHAR},
      #{item.thirdPartyDbName,jdbcType=VARCHAR},
      #{item.thirdPartyTableName,jdbcType=VARCHAR},
      #{item.tableDesc,jdbcType=VARCHAR}
      )
    </foreach>
    ON DUPLICATE KEY UPDATE third_party_db_name=values(third_party_db_name)
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.mingshi.skyflying.domain.MsThirdPartyTableListDo">
    update ms_third_party_table_list
    <set>
      <if test="isDelete != null">
        is_delete = #{isDelete,jdbcType=TINYINT},
      </if>
      <if test="gmtCreate != null">
        gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
      </if>
      <if test="gmtModified != null">
        gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
      </if>
      <if test="thirdPartyName != null">
        third_party_name = #{thirdPartyName,jdbcType=VARCHAR},
      </if>
      <if test="thirdPartyDbName != null">
        third_party_db_name = #{thirdPartyDbName,jdbcType=VARCHAR},
      </if>
      <if test="thirdPartyTableName != null">
        third_party_table_name = #{thirdPartyTableName,jdbcType=VARCHAR},
      </if>
      <if test="tableDesc != null">
        table_desc = #{tableDesc,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>
