(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[383],{12265:function(I){I.exports={databases:"databases___35H4X","detail-wrap":"detail-wrap___1IA0t","tops-wrap":"tops-wrap___2AQns",tops:"tops___2lHCZ"}},36106:function(I,F,e){"use strict";e.r(F),e.d(F,{default:function(){return Se}});var f=e(3182),l=e(11849),z=e(57663),o=e(71577),U=e(34792),W=e(48086),B=e(80112),P=e(18597);function E(j,v,d){return(0,P.Z)()?E=Reflect.construct:E=function(n,D,c){var p=[null];p.push.apply(p,D);var Z=Function.bind.apply(n,p),T=new Z;return c&&(0,B.Z)(T,c.prototype),T},E.apply(null,arguments)}var k=e(86582),G=e(71153),N=e(60331),S=e(2824),ee=e(94043),A=e.n(ee),g=e(67294),L=e(60355),te=e(84674),$=e(12265),ae=e.n($),R=e(24480),ne=e(66572),J=e(13062),r=e(71230),s=e(89032),u=e(15746),b=e(69610),t=e(54941),ie=e(43028),oe=e(6783),le=e(69886),i=e(85893),he=le.G2.getEngine("canvas"),ge=function(j){(0,ie.Z)(d,j);var v=(0,oe.Z)(d);function d(C){var n;return(0,b.Z)(this,d),n=v.call(this,C),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=this,D=new le.by("dataActionPie".concat(this.props.id),{autoFit:!0,height:250,appendPadding:10,data:this.props.types,angleField:"value",colorField:"type",radius:.75,tooltip:{formatter:function(p){var Z=p.value,T=p.type,H=n.props.types.map(function(Y){return Y.value}).reduce(function(Y,re){return Y+re},0);return{name:T,value:(Z/H*100).toFixed(2)+"%"}}},legend:{position:"bottom"},label:{type:"spider",labelHeight:28,formatter:function(p,Z){var T=new he.Group({});return T.addShape({type:"circle",attrs:{x:0,y:0,width:40,height:50,r:5,fill:Z.color}}),T.addShape({type:"text",attrs:{x:10,y:6,text:"".concat(p.type),fill:Z.color}}),T.addShape({type:"text",attrs:{x:0,y:20,text:"".concat(R.Z.bigNumberTransform(p.value),"\u6B21 "),fill:Z.color,fontWeight:700}}),T}},interactions:[{type:"element-selected"},{type:"element-active"}]});D.update({theme:{styleSheet:{brandColor:"#025DF4",paletteQualitative10:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF"],paletteQualitative20:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF","#FFC328","#A0DC2C","#946DFF","#626681","#EB4185","#CD8150","#36BCCB","#327039","#803488","#83BC99"]}}}),D.render(),this.setState({chart:D})}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"dataActionPie"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,D){var c=D.chart;return n.refreshUid==="open"&&c&&c.changeData(n.types),n}}]),d}(g.Component),ye=e(39004),Ce=function(j){(0,ie.Z)(d,j);var v=(0,oe.Z)(d);function d(C){var n;return(0,b.Z)(this,d),n=v.call(this,C),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=new ye.kL({container:"RecentlyLine".concat(this.props.id),autoFit:!0,height:200});n.data(this.props.ranges),n.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),n.tooltip({showNil:!1,showCrosshairs:!1,title:function(c,p){return"".concat(c,"\uFF1A").concat(p.value," \u6B21")},itemTpl:`<div class="g2-tooltip">
        <div class="g2-tooltip-title">Language</div>
        <ul class="g2-tooltip-list">
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">a</span>:<span class="g2-tooltip-value">70</span>
          </li>
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">b</span>:<span class="g2-tooltip-value">50</span>
          </li>
        </ul>
      </div>`}),this.setState({chart:n}),n.area().position("year*value"),n.line().position("year*value"),n.render()}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"RecentlyLine"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,D){var c=D.chart;return n.refreshUid==="open"&&c&&c.changeData(n.ranges),n}}]),d}(g.Component),De=function(v){return(0,i.jsx)(r.Z,{className:v.style["detail-wrap"],gutter:20,children:(0,i.jsx)(u.Z,{span:24,children:(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(u.Z,{span:12,className:"text-c",children:[(0,i.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,i.jsx)(ge,{types:v.types,id:v.id,refreshUid:v.refreshUid})]}),(0,i.jsx)(u.Z,{span:12,className:"text-c",children:(0,i.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,i.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,i.jsx)(Ce,{ranges:v.ranges,id:v.id,refreshUid:v.refreshUid})]})})]})})})},_e=De,de=e(6650),Ee=function(){var v=(0,g.useState)([]),d=(0,S.Z)(v,2),C=d[0],n=d[1],D=(0,g.useState)(""),c=(0,S.Z)(D,2),p=c[0],Z=c[1],T=(0,g.useState)(0),H=(0,S.Z)(T,2),Y=H[0],re=H[1],be=(0,g.useState)(),ce=(0,S.Z)(be,2),Te=ce[0],pe=ce[1],Oe=(0,g.useState)({pageSize:10,pageNo:1}),me=(0,S.Z)(Oe,2),se=me[0],Ue=me[1],Ze=(0,g.useState)({types:[],ranges:[]}),fe=(0,S.Z)(Ze,2),Be=fe[0],ve=fe[1],xe=[{title:"\u6570\u636E\u5E93",dataIndex:"dbName",key:"dbName",align:"center"},{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center",render:function(m,a){var O="-";if(a.tableNameDesc)O=a.tableNameDesc;else{var h=a.tableName.split("#");O=h[h.length-1]}return(0,i.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:O})}},{title:"\u88AB\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center",search:!1,sorter:function(m,a){return a.visitedCount-m.visitedCount},render:function(m,a){return(0,i.jsx)("div",{children:a.visitedCount.toLocaleString()})}},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center",search:!1,render:function(m,a){if(!a.userFrom)return a.usualVisitedUser;var O=JSON.parse(a.userFrom),h=(0,S.Z)(O,1),x=h[0],K=x==="scheduleTask"?"\u5B9A\u65F6\u4EFB\u52A1":x;return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:a.usualVisitedUser}),a.userFrom&&(0,i.jsx)(N.Z,{style:{marginLeft:5},color:"#108ee9",children:K})]})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"dateTime",hideInSetting:!0,search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(m,a){return[(0,i.jsx)(o.Z,{type:"link",size:"small",onClick:function(){if(p===a.id){Z(""),ve({types:[],ranges:[]});return}if(a.visitedCount!==0){var h=R.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),x=R.Z.getRangeTime(7,"YYYY-mm-dd");(0,de.Xd)({msTableName:a.tableName,startTime:h[0],endTime:h[1],tableName:a.tableName}).then(function(K){var Fe=K.data,Ae=x.map(function(M,ue){var _;return{year:M,value:(_=Fe[ue])!==null&&_!==void 0?_:0}}),X=E(Array,(0,k.Z)(te.q));(0,de.et)({tableName:a.tableName}).then(function(M){if(M.data&&M.data.length>0){X.forEach(function(_){var q=M.data.map(function(V){return JSON.parse(V)}),w=q.find(function(V){return V.dbType===_.type});w&&_.type===w.dbType?_.value=parseInt(w.dbTypeTimes):_.value=0});var ue=X.map(function(_){return _.type});M.data.forEach(function(_){var q=JSON.parse(_),w=q.dbType,V=q.dbTypeTimes;ue.includes(w)||X.push({type:w,value:V})}),ve({ranges:Ae,types:X})}}),setTimeout(function(){Z(a.id)},400)})}else W.ZP.info("".concat(a.tableName,"\u8868\u8BBF\u88AB\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],Q=(0,g.useCallback)(function(y){(0,ne.m)(y).then(function(m){var a=m.data;if(a){var O=JSON.parse(a);if(re(O.total),O.rows){var h=JSON.parse(O.rows);n(h.map(function(x){return x.id=R.Z.uuid(),x}).sort(function(x,K){return K.visitedCount-x.visitedCount}));return}}n([])})},[]);return(0,g.useEffect)(function(){Q(se)},[]),(0,i.jsx)("div",{className:ae().databases,children:(0,i.jsx)(L.ZP,{headerTitle:"\u6570\u636E\u8BBF\u95EE\u884C\u4E3A\u5217\u8868",columns:xe,rowKey:"id",pagination:{showSizeChanger:!1,total:Y,pageSize:se.pageSize,current:se.pageNo,onChange:function(m,a){Ue({pageNo:m,pageSize:a}),Q((0,l.Z)({pageNo:m,pageSize:a},Te))}},options:!1,onSubmit:function(){var y=(0,f.Z)(A().mark(function m(a){return A().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return pe(a),h.next=3,Q((0,l.Z)({pageSize:10,pageNo:1},a));case 3:case"end":return h.stop()}},m)}));return function(m){return y.apply(this,arguments)}}(),onReset:(0,f.Z)(A().mark(function y(){return A().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,pe({tableName:""});case 2:return a.next=4,Q({pageSize:10,pageNo:1});case 4:case"end":return a.stop()}},y)})),expandable:{expandedRowRender:function(m,a){return(0,g.createElement)(_e,(0,l.Z)((0,l.Z)({},Be),{},{id:a,key:a,style:ae(),refreshUid:p===""?"close":"open"}))},expandIcon:function(){return!1},expandedRowKeys:[p]},dataSource:C})})},Se=Ee},84674:function(I,F,e){"use strict";e.d(F,{q:function(){return f}});var f=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],l=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},66572:function(I,F,e){"use strict";e.d(F,{m:function(){return W}});var f=e(11849),l=e(3182),z=e(94043),o=e.n(z),U=e(25377);function W(P,E){return B.apply(this,arguments)}function B(){return B=(0,l.Z)(o().mark(function P(E,k){return o().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",(0,U.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,f.Z)({method:"GET",params:E},k||{})));case 1:case"end":return N.stop()}},P)})),B.apply(this,arguments)}},6650:function(I,F,e){"use strict";e.d(F,{F$:function(){return W},Xd:function(){return P},mt:function(){return k},et:function(){return ee},FP:function(){return g},Bx:function(){return te},us:function(){return ne}});var f=e(11849),l=e(3182),z=e(94043),o=e.n(z),U=e(25377);function W(r,s){return B.apply(this,arguments)}function B(){return B=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getCoarseCountsOfUsers",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),B.apply(this,arguments)}function P(r,s){return E.apply(this,arguments)}function E(){return E=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),E.apply(this,arguments)}function k(r,s){return G.apply(this,arguments)}function G(){return G=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getVisitRate",(0,f.Z)({method:"GET",params:{username:s}},u||{})));case 1:case"end":return t.stop()}},r)})),G.apply(this,arguments)}function N(r,s){return S.apply(this,arguments)}function S(){return S=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),S.apply(this,arguments)}function ee(r,s){return A.apply(this,arguments)}function A(){return A=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getCountsOfUser",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),A.apply(this,arguments)}function g(r,s){return L.apply(this,arguments)}function L(){return L=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getUserOperationTypeCount",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),L.apply(this,arguments)}function te(r,s){return $.apply(this,arguments)}function $(){return $=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),$.apply(this,arguments)}function ae(r,s){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCoarseCountsOfOneUser",_objectSpread({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),R.apply(this,arguments)}function ne(r,s){return J.apply(this,arguments)}function J(){return J=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,U.WY)("/api/skyflying/getCountsOfEveryonRecentSevenDays",(0,f.Z)({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),J.apply(this,arguments)}}}]);
