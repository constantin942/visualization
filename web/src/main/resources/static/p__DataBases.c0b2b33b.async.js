(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[383],{12265:function(w){w.exports={databases:"databases___35H4X","detail-wrap":"detail-wrap___1IA0t","tops-wrap":"tops-wrap___2AQns",tops:"tops___2lHCZ"}},36106:function(w,A,e){"use strict";e.r(A),e.d(A,{default:function(){return Ee}});var m=e(3182),o=e(11849),V=e(57663),l=e(71577),T=e(34792),I=e(48086),U=e(80112),P=e(18597);function _(j,f,d){return(0,P.Z)()?_=Reflect.construct:_=function(n,C,c){var p=[null];p.push.apply(p,C);var O=Function.bind.apply(n,p),b=new O;return c&&(0,U.Z)(b,c.prototype),b},_.apply(null,arguments)}var W=e(86582),G=e(71153),R=e(60331),Z=e(2824),ee=e(94043),F=e.n(ee),v=e(67294),L=e(60355),te=e(84674),k=e(12265),ae=e.n(k),x=e(24480),ne=e(66572),z=e(13062),r=e(71230),s=e(89032),u=e(15746),S=e(69610),t=e(54941),ue=e(43028),ie=e(6783),le=e(69886),i=e(85893),fe=le.G2.getEngine("canvas"),ve=function(j){(0,ue.Z)(d,j);var f=(0,ie.Z)(d);function d(y){var n;return(0,S.Z)(this,d),n=f.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=this,C=new le.by("dataActionPie".concat(this.props.id),{autoFit:!0,height:250,appendPadding:10,data:this.props.types,angleField:"value",colorField:"type",radius:.75,tooltip:{formatter:function(p){var O=p.value,b=p.type,H=n.props.types.map(function(Y){return Y.value}).reduce(function(Y,re){return Y+re},0);return{name:b,value:(O/H*100).toFixed(2)+"%"}}},legend:{position:"bottom"},label:{type:"spider",labelHeight:28,formatter:function(p,O){var b=new fe.Group({});return b.addShape({type:"circle",attrs:{x:0,y:0,width:40,height:50,r:5,fill:O.color}}),b.addShape({type:"text",attrs:{x:10,y:6,text:"".concat(p.type),fill:O.color}}),b.addShape({type:"text",attrs:{x:0,y:20,text:"".concat(x.Z.bigNumberTransform(p.value),"\u6B21 "),fill:O.color,fontWeight:700}}),b}},interactions:[{type:"element-selected"},{type:"element-active"}]});C.update({theme:{styleSheet:{brandColor:"#025DF4",paletteQualitative10:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF"],paletteQualitative20:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF","#FFC328","#A0DC2C","#946DFF","#626681","#EB4185","#CD8150","#36BCCB","#327039","#803488","#83BC99"]}}}),C.render(),this.setState({chart:C})}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"dataActionPie"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.types),n}}]),d}(v.Component),he=e(39004),ge=function(j){(0,ue.Z)(d,j);var f=(0,ie.Z)(d);function d(y){var n;return(0,S.Z)(this,d),n=f.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=new he.kL({container:"RecentlyLine".concat(this.props.id),autoFit:!0,height:200});n.data(this.props.ranges),n.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),n.tooltip({showNil:!1,showCrosshairs:!1,title:function(c,p){return"".concat(c,"\uFF1A").concat(p.value," \u6B21")},itemTpl:`<div class="g2-tooltip">
        <div class="g2-tooltip-title">Language</div>
        <ul class="g2-tooltip-list">
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">a</span>:<span class="g2-tooltip-value">70</span>
          </li>
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">b</span>:<span class="g2-tooltip-value">50</span>
          </li>
        </ul>
      </div>`}),this.setState({chart:n}),n.area().position("year*value"),n.line().position("year*value"),n.render()}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"RecentlyLine"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.ranges),n}}]),d}(v.Component),ye=function(f){return(0,i.jsx)(r.Z,{className:f.style["detail-wrap"],gutter:20,children:(0,i.jsx)(u.Z,{span:24,children:(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(u.Z,{span:12,className:"text-c",children:[(0,i.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,i.jsx)(ve,{types:f.types,id:f.id,refreshUid:f.refreshUid})]}),(0,i.jsx)(u.Z,{span:12,className:"text-c",children:(0,i.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,i.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,i.jsx)(ge,{ranges:f.ranges,id:f.id,refreshUid:f.refreshUid})]})})]})})})},Ce=ye,oe=e(6650),De=function(){var f=(0,v.useState)([]),d=(0,Z.Z)(f,2),y=d[0],n=d[1],C=(0,v.useState)(""),c=(0,Z.Z)(C,2),p=c[0],O=c[1],b=(0,v.useState)(0),H=(0,Z.Z)(b,2),Y=H[0],re=H[1],_e=(0,v.useState)(),de=(0,Z.Z)(_e,2),Se=de[0],be=de[1],Te=(0,v.useState)({pageSize:10,pageNo:1}),ce=(0,Z.Z)(Te,2),$=ce[0],Ze=ce[1],Oe=(0,v.useState)({types:[],ranges:[]}),pe=(0,Z.Z)(Oe,2),Ue=pe[0],me=pe[1],Be=[{title:"\u6570\u636E\u5E93",dataIndex:"dbName",key:"dbName",align:"center"},{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center",render:function(h,a){var B="-";if(a.tableNameDesc)B=a.tableNameDesc;else{var g=a.tableName.split("#");B=g[g.length-1]}return(0,i.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:B})}},{title:"\u88AB\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center",search:!1,render:function(h,a){return(0,i.jsx)("div",{children:a.visitedCount.toLocaleString()})}},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center",search:!1,render:function(h,a){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:a.usualVisitedUser}),a.userFrom&&(0,i.jsx)(R.Z,{style:{marginLeft:5},color:"#108ee9",children:"\u5B9A\u65F6\u4EFB\u52A1"})]})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"dateTime",hideInSetting:!0,search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(h,a){return[(0,i.jsx)(l.Z,{type:"link",size:"small",onClick:function(){if(p===a.id){O(""),me({types:[],ranges:[]});return}if(a.visitedCount!==0){var g=x.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),Q=x.Z.getRangeTime(7,"YYYY-mm-dd");(0,oe.Xd)({msTableName:a.tableName,startTime:g[0],endTime:g[1],tableName:a.tableName}).then(function(Ae){var Fe=Ae.data,xe=Q.map(function(N,se){var E;return{year:N,value:(E=Fe[se])!==null&&E!==void 0?E:0}}),X=_(Array,(0,W.Z)(te.q));(0,oe.et)({tableName:a.tableName}).then(function(N){if(N.data&&N.data.length>0){X.forEach(function(E){var q=N.data.map(function(K){return JSON.parse(K)}),M=q.find(function(K){return K.dbType===E.type});M&&E.type===M.dbType?E.value=parseInt(M.dbTypeTimes):E.value=0});var se=X.map(function(E){return E.type});N.data.forEach(function(E){var q=JSON.parse(E),M=q.dbType,K=q.dbTypeTimes;se.includes(M)||X.push({type:M,value:K})}),me({ranges:xe,types:X})}}),setTimeout(function(){O(a.id)},400)})}else I.ZP.info("".concat(a.tableName,"\u8868\u8BBF\u88AB\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],J=(0,v.useCallback)(function(D){(0,ne.m)(D).then(function(h){var a=h.data;if(a){var B=JSON.parse(a);if(re(B.total),B.rows){var g=JSON.parse(B.rows);console.log(g),n(g.map(function(Q){return Q.id=x.Z.uuid(),Q}));return}}n([])})},[]);return(0,v.useEffect)(function(){J($)},[]),(0,i.jsx)("div",{className:ae().databases,children:(0,i.jsx)(L.ZP,{headerTitle:"\u6570\u636E\u8BBF\u95EE\u884C\u4E3A\u5217\u8868",columns:Be,rowKey:"id",pagination:{showSizeChanger:!1,total:Y,pageSize:$.pageSize,current:$.pageNo,onChange:function(h,a){Ze({pageNo:h,pageSize:a}),J((0,o.Z)({pageNo:h,pageSize:a},Se))}},options:!1,onSubmit:function(){var D=(0,m.Z)(F().mark(function h(a){return F().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return be(a),g.next=3,J((0,o.Z)((0,o.Z)({},$),a));case 3:case"end":return g.stop()}},h)}));return function(h){return D.apply(this,arguments)}}(),onReset:(0,m.Z)(F().mark(function D(){return F().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:J((0,o.Z)({},$));case 1:case"end":return a.stop()}},D)})),expandable:{expandedRowRender:function(h,a){return(0,v.createElement)(Ce,(0,o.Z)((0,o.Z)({},Ue),{},{id:a,key:a,style:ae(),refreshUid:p===""?"close":"open"}))},expandIcon:function(){return!1},expandedRowKeys:[p]},dataSource:y})})},Ee=De},84674:function(w,A,e){"use strict";e.d(A,{q:function(){return m}});var m=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],o=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},66572:function(w,A,e){"use strict";e.d(A,{m:function(){return I}});var m=e(11849),o=e(3182),V=e(94043),l=e.n(V),T=e(25377);function I(P,_){return U.apply(this,arguments)}function U(){return U=(0,o.Z)(l().mark(function P(_,W){return l().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,T.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,m.Z)({method:"GET",params:_},W||{})));case 1:case"end":return R.stop()}},P)})),U.apply(this,arguments)}},6650:function(w,A,e){"use strict";e.d(A,{F$:function(){return I},Xd:function(){return P},mt:function(){return W},et:function(){return ee},FP:function(){return v},Bx:function(){return te},us:function(){return ne}});var m=e(11849),o=e(3182),V=e(94043),l=e.n(V),T=e(25377);function I(r,s){return U.apply(this,arguments)}function U(){return U=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCoarseCountsOfUsers",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),U.apply(this,arguments)}function P(r,s){return _.apply(this,arguments)}function _(){return _=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),_.apply(this,arguments)}function W(r,s){return G.apply(this,arguments)}function G(){return G=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getVisitRate",(0,m.Z)({method:"GET",params:{username:s}},u||{})));case 1:case"end":return t.stop()}},r)})),G.apply(this,arguments)}function R(r,s){return Z.apply(this,arguments)}function Z(){return Z=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),Z.apply(this,arguments)}function ee(r,s){return F.apply(this,arguments)}function F(){return F=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfUser",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),F.apply(this,arguments)}function v(r,s){return L.apply(this,arguments)}function L(){return L=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getUserOperationTypeCount",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),L.apply(this,arguments)}function te(r,s){return k.apply(this,arguments)}function k(){return k=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),k.apply(this,arguments)}function ae(r,s){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCoarseCountsOfOneUser",_objectSpread({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),x.apply(this,arguments)}function ne(r,s){return z.apply(this,arguments)}function z(){return z=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfEveryonRecentSevenDays",(0,m.Z)({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),z.apply(this,arguments)}}}]);
