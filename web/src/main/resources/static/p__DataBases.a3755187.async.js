(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[383],{12265:function(I){I.exports={databases:"databases___35H4X","detail-wrap":"detail-wrap___1IA0t","tops-wrap":"tops-wrap___2AQns",tops:"tops___2lHCZ"}},36106:function(I,A,e){"use strict";e.r(A),e.d(A,{default:function(){return Se}});var f=e(3182),l=e(11849),z=e(57663),o=e(71577),T=e(34792),W=e(48086),Z=e(80112),P=e(18597);function _(N,v,d){return(0,P.Z)()?_=Reflect.construct:_=function(n,C,c){var p=[null];p.push.apply(p,C);var U=Function.bind.apply(n,p),b=new U;return c&&(0,Z.Z)(b,c.prototype),b},_.apply(null,arguments)}var G=e(86582),L=e(71153),R=e(60331),O=e(2824),q=e(94043),F=e.n(q),h=e(67294),k=e(60355),ee=e(84674),Y=e(12265),te=e.n(Y),x=e(24480),ae=e(66572),V=e(13062),r=e(71230),s=e(89032),u=e(15746),S=e(69610),t=e(54941),ie=e(43028),oe=e(6783),le=e(69886),i=e(85893),he=le.G2.getEngine("canvas"),ge=function(N){(0,ie.Z)(d,N);var v=(0,oe.Z)(d);function d(y){var n;return(0,S.Z)(this,d),n=v.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=this,C=new le.by("dataActionPie".concat(this.props.id),{autoFit:!0,height:250,appendPadding:10,data:this.props.types,angleField:"value",colorField:"type",radius:.75,tooltip:{formatter:function(p){var U=p.value,b=p.type,H=n.props.types.map(function($){return $.value}).reduce(function($,ne){return $+ne},0);return{name:b,value:(U/H*100).toFixed(2)+"%"}}},legend:{position:"bottom"},label:{type:"spider",labelHeight:28,formatter:function(p,U){var b=new he.Group({});return b.addShape({type:"circle",attrs:{x:0,y:0,width:40,height:50,r:5,fill:U.color}}),b.addShape({type:"text",attrs:{x:10,y:6,text:"".concat(p.type),fill:U.color}}),b.addShape({type:"text",attrs:{x:0,y:20,text:"".concat(x.Z.bigNumberTransform(p.value),"\u6B21 "),fill:U.color,fontWeight:700}}),b}},interactions:[{type:"element-selected"},{type:"element-active"}]});C.update({theme:{styleSheet:{brandColor:"#025DF4",paletteQualitative10:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF"],paletteQualitative20:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF","#FFC328","#A0DC2C","#946DFF","#626681","#EB4185","#CD8150","#36BCCB","#327039","#803488","#83BC99"]}}}),C.render(),this.setState({chart:C})}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"dataActionPie"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.types),n}}]),d}(h.Component),ye=e(39004),Ce=function(N){(0,ie.Z)(d,N);var v=(0,oe.Z)(d);function d(y){var n;return(0,S.Z)(this,d),n=v.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=new ye.kL({container:"RecentlyLine".concat(this.props.id),autoFit:!0,height:200});n.data(this.props.ranges),n.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),n.tooltip({showNil:!1,showCrosshairs:!1,title:function(c,p){return"".concat(c,"\uFF1A").concat(p.value," \u6B21")},itemTpl:`<div class="g2-tooltip">
        <div class="g2-tooltip-title">Language</div>
        <ul class="g2-tooltip-list">
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">a</span>:<span class="g2-tooltip-value">70</span>
          </li>
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">b</span>:<span class="g2-tooltip-value">50</span>
          </li>
        </ul>
      </div>`}),this.setState({chart:n}),n.area().position("year*value"),n.line().position("year*value"),n.render()}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"RecentlyLine"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.ranges),n}}]),d}(h.Component),De=function(v){return(0,i.jsx)(r.Z,{className:v.style["detail-wrap"],gutter:20,children:(0,i.jsx)(u.Z,{span:24,children:(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(u.Z,{span:12,className:"text-c",children:[(0,i.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,i.jsx)(ge,{types:v.types,id:v.id,refreshUid:v.refreshUid})]}),(0,i.jsx)(u.Z,{span:12,className:"text-c",children:(0,i.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,i.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,i.jsx)(Ce,{ranges:v.ranges,id:v.id,refreshUid:v.refreshUid})]})})]})})})},Ee=De,de=e(6650),_e=function(){var v=(0,h.useState)([]),d=(0,O.Z)(v,2),y=d[0],n=d[1],C=(0,h.useState)(""),c=(0,O.Z)(C,2),p=c[0],U=c[1],b=(0,h.useState)(0),H=(0,O.Z)(b,2),$=H[0],ne=H[1],be=(0,h.useState)(),ce=(0,O.Z)(be,2),Te=ce[0],pe=ce[1],Oe=(0,h.useState)({pageSize:10,pageNo:1}),me=(0,O.Z)(Oe,2),re=me[0],Ue=me[1],Ze=(0,h.useState)({types:[],ranges:[]}),fe=(0,O.Z)(Ze,2),Be=fe[0],ve=fe[1],Ae=[{title:"\u6570\u636E\u5E93",dataIndex:"dbName",key:"dbName",align:"center"},{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center",render:function(m,a){var B="-";if(a.tableNameDesc)B=a.tableNameDesc;else{var D=a.tableName.split("#");B=D[D.length-1]}return(0,i.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:B})}},{title:"\u88AB\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center",search:!1,sorter:function(m,a){return a.visitedCount-m.visitedCount},render:function(m,a){return(0,i.jsx)("div",{children:a.visitedCount.toLocaleString()})}},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center",search:!1,render:function(m,a){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:a.usualVisitedUser}),a.userFrom&&(0,i.jsx)(R.Z,{style:{marginLeft:5},color:"#108ee9",children:"\u5B9A\u65F6\u4EFB\u52A1"})]})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"dateTime",hideInSetting:!0,search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(m,a){return[(0,i.jsx)(o.Z,{type:"link",size:"small",onClick:function(){if(p===a.id){U(""),ve({types:[],ranges:[]});return}if(a.visitedCount!==0){var D=x.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),j=x.Z.getRangeTime(7,"YYYY-mm-dd");(0,de.Xd)({msTableName:a.tableName,startTime:D[0],endTime:D[1],tableName:a.tableName}).then(function(se){var Fe=se.data,xe=j.map(function(M,ue){var E;return{year:M,value:(E=Fe[ue])!==null&&E!==void 0?E:0}}),Q=_(Array,(0,G.Z)(ee.q));(0,de.et)({tableName:a.tableName}).then(function(M){if(M.data&&M.data.length>0){Q.forEach(function(E){var X=M.data.map(function(K){return JSON.parse(K)}),w=X.find(function(K){return K.dbType===E.type});w&&E.type===w.dbType?E.value=parseInt(w.dbTypeTimes):E.value=0});var ue=Q.map(function(E){return E.type});M.data.forEach(function(E){var X=JSON.parse(E),w=X.dbType,K=X.dbTypeTimes;ue.includes(w)||Q.push({type:w,value:K})}),ve({ranges:xe,types:Q})}}),setTimeout(function(){U(a.id)},400)})}else W.ZP.info("".concat(a.tableName,"\u8868\u8BBF\u88AB\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],J=(0,h.useCallback)(function(g){(0,ae.m)(g).then(function(m){var a=m.data;if(a){var B=JSON.parse(a);if(ne(B.total),B.rows){var D=JSON.parse(B.rows);n(D.map(function(j){return j.id=x.Z.uuid(),j}).sort(function(j,se){return se.visitedCount-j.visitedCount}));return}}n([])})},[]);return(0,h.useEffect)(function(){J(re)},[]),(0,i.jsx)("div",{className:te().databases,children:(0,i.jsx)(k.ZP,{headerTitle:"\u6570\u636E\u8BBF\u95EE\u884C\u4E3A\u5217\u8868",columns:Ae,rowKey:"id",pagination:{showSizeChanger:!1,total:$,pageSize:re.pageSize,current:re.pageNo,onChange:function(m,a){Ue({pageNo:m,pageSize:a}),J((0,l.Z)({pageNo:m,pageSize:a},Te))}},options:!1,onSubmit:function(){var g=(0,f.Z)(F().mark(function m(a){return F().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return pe(a),D.next=3,J((0,l.Z)({pageSize:10,pageNo:1},a));case 3:case"end":return D.stop()}},m)}));return function(m){return g.apply(this,arguments)}}(),onReset:(0,f.Z)(F().mark(function g(){return F().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,pe({tableName:""});case 2:return a.next=4,J({pageSize:10,pageNo:1});case 4:case"end":return a.stop()}},g)})),expandable:{expandedRowRender:function(m,a){return(0,h.createElement)(Ee,(0,l.Z)((0,l.Z)({},Be),{},{id:a,key:a,style:te(),refreshUid:p===""?"close":"open"}))},expandIcon:function(){return!1},expandedRowKeys:[p]},dataSource:y})})},Se=_e},84674:function(I,A,e){"use strict";e.d(A,{q:function(){return f}});var f=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],l=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},66572:function(I,A,e){"use strict";e.d(A,{m:function(){return W}});var f=e(11849),l=e(3182),z=e(94043),o=e.n(z),T=e(25377);function W(P,_){return Z.apply(this,arguments)}function Z(){return Z=(0,l.Z)(o().mark(function P(_,G){return o().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,T.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,f.Z)({method:"GET",params:_},G||{})));case 1:case"end":return R.stop()}},P)})),Z.apply(this,arguments)}},6650:function(I,A,e){"use strict";e.d(A,{F$:function(){return W},Xd:function(){return P},mt:function(){return G},et:function(){return q},FP:function(){return h},Bx:function(){return ee},us:function(){return ae}});var f=e(11849),l=e(3182),z=e(94043),o=e.n(z),T=e(25377);function W(r,s){return Z.apply(this,arguments)}function Z(){return Z=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCoarseCountsOfUsers",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),Z.apply(this,arguments)}function P(r,s){return _.apply(this,arguments)}function _(){return _=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),_.apply(this,arguments)}function G(r,s){return L.apply(this,arguments)}function L(){return L=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getVisitRate",(0,f.Z)({method:"GET",params:{username:s}},u||{})));case 1:case"end":return t.stop()}},r)})),L.apply(this,arguments)}function R(r,s){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),O.apply(this,arguments)}function q(r,s){return F.apply(this,arguments)}function F(){return F=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfUser",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),F.apply(this,arguments)}function h(r,s){return k.apply(this,arguments)}function k(){return k=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getUserOperationTypeCount",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),k.apply(this,arguments)}function ee(r,s){return Y.apply(this,arguments)}function Y(){return Y=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,f.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),Y.apply(this,arguments)}function te(r,s){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCoarseCountsOfOneUser",_objectSpread({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),x.apply(this,arguments)}function ae(r,s){return V.apply(this,arguments)}function V(){return V=(0,l.Z)(o().mark(function r(s,u){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,T.WY)("/api/skyflying/getCountsOfEveryonRecentSevenDays",(0,f.Z)({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),V.apply(this,arguments)}}}]);
