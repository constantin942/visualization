(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[628],{26516:function(F){F.exports={overview:"overview___ZXPWZ",staticWrap:"staticWrap___2Invp",waringWrap:"waringWrap___AfQ25",bgW:"bgW___3rDWk",center:"center___21dU2",nowrap:"nowrap___spq6f"}},81135:function(F,I,e){"use strict";e.r(I),e.d(I,{default:function(){return Ae}});var U=e(57663),O=e(71577),P=e(58024),r=e(39144),C=e(13062),a=e(71230),l=e(95300),s=e(7277),i=e(89032),u=e(15746),b=e(71748),f=e(33860),T=e(3182),Z=e(2824),A=e(94043),p=e.n(A),w=e(67294),ee=e(26516),k=e.n(ee),d=e(13254),m=e(14277),E=e(11849),R=e(46066),n=e(68628),t=e(85893),de=function(x){var v={dots:!1,innerSlider:!0,slidesToShow:6,slidesToScroll:1,vertical:!0,verticalSwiping:!0,autoplay:!0,speed:2e3,autoplaySpeed:2e3,arrows:!1,cssEase:"linear"};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.Z,{className:"fs-16 ib danger mr-10"}),(0,t.jsx)("h3",{className:"danger fs-16 ib",children:"\u544A\u8B66\u4FE1\u606F"})]}),(0,t.jsx)("div",{className:"of-hidden",children:x.warningList.length>0?(0,t.jsx)(R.Z,(0,E.Z)((0,E.Z)({},v),{},{children:x.warningList.map(function(o){return(0,t.jsx)("div",{className:"mt-5 mb-5 text-c lh-2",children:o.alarmContent},o.id)})})):(0,t.jsx)(m.Z,{description:"\u6682\u65E0\u544A\u8B66\u4FE1\u606F"})})]})},me=de,pe=e(69610),ve=e(54941),ge=e(81306),fe=e(19809),V=e(69886),H=e(41694),he=V.G2.InteractionAction,_e=V.G2.registerInteraction,ye=V.G2.registerAction,De=function(B){(0,ge.Z)(v,B);var x=(0,fe.Z)(v);function v(){return(0,pe.Z)(this,v),x.apply(this,arguments)}return(0,ve.Z)(v,[{key:"active",value:function(){var c=this,j=this.getView(),_=this.context.event;if(_.data){var g=_.data.items,N=j.geometries.filter(function(L){return L.type==="point"});(0,H.S6)(N,function(L){(0,H.S6)(L.elements,function($){var Y=(0,H.cx)(g,function(ne){return ne.data===$.data})!==-1,G=$.shape.getChildren(),K=(0,Z.Z)(G,2),J=K[0],X=K[1];Y?(J.animate({r:10,opacity:.2},{duration:1800,easing:"easeLinear",repeat:!0}),X.animate({r:6,opacity:.4},{duration:800,easing:"easeLinear",repeat:!0})):c.resetElementState($)})})}}},{key:"reset",value:function(){var c=this,j=this.getView(),_=j.geometries.filter(function(g){return g.type==="point"});(0,H.S6)(_,function(g){(0,H.S6)(g.elements,function(N){c.resetElementState(N)})})}},{key:"resetElementState",value:function(c){var j=c.shape.getChildren(),_=(0,Z.Z)(j,2),g=_[0],N=_[1];g.stopAnimate(),N.stopAnimate();var L=g.get("attrs"),$=L.r,Y=L.opacity;g.attr({r:$,opacity:Y});var G=N.get("attrs"),K=G.r,J=G.opacity;N.attr({r:K,opacity:J})}},{key:"getView",value:function(){return this.context.view}}]),v}(he),Ce=function(x){return(0,w.useEffect)(function(){V.G2.registerShape("point","custom-point",{draw:function(c,j){var _={x:c.x,y:c.y},g=j.addGroup();return g.addShape("circle",{name:"outer-point",attrs:{x:_.x,y:_.y,fill:c.color||"red",opacity:.5,r:6}}),g.addShape("circle",{name:"inner-point",attrs:{x:_.x,y:_.y,fill:c.color||"red",opacity:1,r:2}}),g}}),ye("custom-marker-action",De),_e("custom-marker-interaction",{start:[{trigger:"tooltip:show",action:"custom-marker-action:active"}],end:[{trigger:"tooltip:hide",action:"custom-marker-action:reset"}]});var v=new V.x1("RangeTimeData",{height:138,autoFit:!0,data:x.data,xField:"year",yField:"value",label:{},point:{size:5,shape:"custom-point",style:{fill:"white",stroke:"#5B8FF9",lineWidth:2}},tooltip:{showMarkers:!1},state:{active:{style:{shadowBlur:4,stroke:"#000",fill:"red"}}},interactions:[{type:"custom-marker-interaction"}]});v.render()},[]),(0,t.jsx)("div",{id:"RangeTimeData"})},Ee=Ce,se=e(23210),z=e(24480),Se=e(6650),ie=e(32773);function Oe(B,x){return te.apply(this,arguments)}function te(){return te=(0,T.Z)(p().mark(function B(x,v){return p().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,ie.WY)("/api/skyflying/getCountsOfAllRecentSevenDays",(0,E.Z)({params:x,method:"GET"},v||{})));case 1:case"end":return c.stop()}},B)})),te.apply(this,arguments)}function Te(B){return ae.apply(this,arguments)}function ae(){return ae=(0,T.Z)(p().mark(function B(x){return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,ie.WY)("/api/skyflying/getOverviewOfSystem",(0,E.Z)({method:"GET"},x||{})));case 1:case"end":return o.stop()}},B)})),ae.apply(this,arguments)}var Ze=e(66572),xe=e(2335),Ue=e(52778),be=[{title:"\u7528\u6237\u540D",dataIndex:"userName",key:"name",align:"center"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",search:!1,align:"center"},{title:"\u5E38\u7528\u6570\u636E",dataIndex:"usualVisitedData",key:"usualVisitedData",align:"center",search:!1,render:function(x,v){var o=JSON.parse(v.usualVisitedData),c=o.tableName,j=o.tableNameDesc,_=c.split("#"),g="-";return j?g=j:_.length>1&&(g=_[_.length-1]),(0,t.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:g})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",dataIndex:"lastVisitedDate",key:"lastVisitedDate",search:!1,align:"center"}],we=[{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center",render:function(x,v){var o="-";if(v.tableNameDesc)o=v.tableNameDesc;else{var c=v.tableName.split("#");o=c[c.length-1]}return(0,t.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:o})}},{title:"\u88AB\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center"},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center"},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"date",hideInSetting:!0,align:"center"}],je=function(x){var v=(0,w.useState)(),o=(0,Z.Z)(v,2),c=o[0],j=o[1],_=(0,w.useState)([]),g=(0,Z.Z)(_,2),N=g[0],L=g[1],$=(0,w.useState)([]),Y=(0,Z.Z)($,2),G=Y[0],K=Y[1],J=(0,w.useState)([]),X=(0,Z.Z)(J,2),ne=X[0],ue=X[1],Re=(0,w.useState)(0),le=(0,Z.Z)(Re,2),Be=le[0],Ne=le[1],We=(0,w.useState)({pageSize:10,pageNo:1}),Me=(0,Z.Z)(We,1),re=Me[0],Ie=(0,w.useState)({dbInstance:0,table:0,user:0,visitedInformation:0}),oe=(0,Z.Z)(Ie,2),Q=oe[0],Pe=oe[1];function ke(){(0,xe.cD)({pageSize:100,pageNo:1}).then(function(W){var h=W.data;if(h){var y=JSON.parse(h);if(y){var S=JSON.parse(y.rows);ue(S.map(function(D,M){return D.matchRuleId=M,D})),console.log(S)}else ue([])}})}var Le=function(){(0,Se.F$)().then(function(h){var y=h.data;if(y&&y.length>0){j(y.map(function(D){return D.id=z.Z.uuid(),D})),console.log(y.map(function(D){return D.id=z.Z.uuid(),D}));var S=[];y.forEach(function(D){S.push({level:1,name:D.userName,childrenNum:5,id:D.userName})}),console.log(S)}else j([])})},$e=function(){var h=z.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),y=z.Z.getRangeTime(7,"mm-dd");Oe({startTime:h[0],endTime:h[1]}).then(function(S){var D=S.data;L(function(){return D.map(function(M,q){return{year:y[q],value:M}})})})},Ge=function(){var W=(0,T.Z)(p().mark(function h(){var y,S;return p().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Te();case 2:y=M.sent,S=y.data,Pe(S);case 5:case"end":return M.stop()}},h)}));return function(){return W.apply(this,arguments)}}(),Fe=function(){var W=(0,T.Z)(p().mark(function h(){return p().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:case"end":return S.stop()}},h)}));return function(){return W.apply(this,arguments)}}(),ce=function(h){(0,Ze.m)(h).then(function(y){var S=y.data;if(S){var D=JSON.parse(S);Ne(D.total);var M=JSON.parse(D.rows);console.log(D),K(M.map(function(q){return q.id=z.Z.uuid(),q}))}})};return(0,w.useEffect)(function(){Le(),$e(),ce(re),Ge().then(),Fe().then(),ke()},[]),(0,t.jsxs)("div",{className:k().overview,children:[(0,t.jsx)("div",{className:k().staticWrap,children:(0,t.jsxs)(a.Z,{gutter:20,children:[(0,t.jsx)(u.Z,{span:8,children:(0,t.jsx)(f.Z,{active:!0,loading:N.length===0,children:(0,t.jsx)(Ue.Z,{title:"\u8FD1\u4E03\u5929\u6570\u636E\u6536\u96C6\u60C5\u51B5",chart:(0,t.jsx)("div",{style:{height:"163px"},children:(0,t.jsx)(Ee,{data:N})})})})}),(0,t.jsx)(u.Z,{span:8,children:(0,t.jsx)(r.Z,{className:k().bgW,title:(0,t.jsx)("div",{className:"text-c",children:"\u6570\u636E\u7EDF\u8BA1\u60C5\u51B5"}),children:(0,t.jsx)(a.Z,{gutter:20,className:"text-c",style:{height:"162px"},children:(0,t.jsxs)(f.Z,{active:!0,loading:N.length===0,children:[(0,t.jsx)(u.Z,{span:12,className:"mt-15 text-c",children:(0,t.jsx)(s.Z,{title:"\u5DF2\u6536\u96C6\u4FE1\u606F",value:Q.visitedInformation,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(u.Z,{span:12,className:"mt-15",children:(0,t.jsx)(s.Z,{title:"\u6570\u636E\u5E93\u4E2A\u6570",value:Q.dbInstance,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(u.Z,{span:12,className:"mt-20",children:(0,t.jsx)(s.Z,{title:"\u7528\u6237\u4EBA\u6570",value:Q.user,valueStyle:{color:"#3f8600"}})}),(0,t.jsx)(u.Z,{span:12,className:"mt-20",children:(0,t.jsx)(s.Z,{title:"\u6570\u636E\u5E93\u8868",value:Q.table,valueStyle:{color:"#3f8600"}})})]})})})}),(0,t.jsx)(u.Z,{span:8,children:(0,t.jsx)("div",{className:k().waringWrap,children:(0,t.jsx)(me,{warningList:ne})})})]})}),(0,t.jsx)("div",{className:k().center,children:(0,t.jsxs)(a.Z,{gutter:30,children:[(0,t.jsx)(u.Z,{span:12,children:(0,t.jsx)(se.ZP,{columns:be,dataSource:c,scroll:{y:500},options:!1,toolBarRender:function(){return[(0,t.jsx)(O.Z,{type:"link",size:"small",onClick:function(){x.history.push("/user-access")},children:"\u8BE6\u60C5"},"user-link")]},rowKey:"id",search:!1,pagination:!1,headerTitle:"\u7528\u6237\u8BBF\u95EE\u884C\u4E3A"})}),(0,t.jsx)(u.Z,{span:12,className:"pr-10",children:(0,t.jsx)(f.Z,{active:!0,loading:G.length===0,paragraph:{rows:5},children:(0,t.jsx)(se.ZP,{scroll:{y:500},columns:we,dataSource:G,options:!1,rowKey:"id",search:!1,pagination:{showSizeChanger:!1,total:Be,pageSize:re.pageSize,current:re.pageNo,onChange:function(h,y){ce({pageNo:h,pageSize:y})}},toolBarRender:function(){return[(0,t.jsx)(O.Z,{type:"link",size:"small",onClick:function(){x.history.push("/databases")},children:"\u8BE6\u60C5"},"data-link")]},headerTitle:"\u6570\u636E\u8BBF\u95EE\u7EDF\u8BA1"})})})]})})]})},Ae=je},66572:function(F,I,e){"use strict";e.d(I,{m:function(){return a}});var U=e(11849),O=e(3182),P=e(94043),r=e.n(P),C=e(21704);function a(s,i){return l.apply(this,arguments)}function l(){return l=(0,O.Z)(r().mark(function s(i,u){return r().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,C.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,U.Z)({method:"GET",params:i},u||{})));case 1:case"end":return f.stop()}},s)})),l.apply(this,arguments)}},6650:function(F,I,e){"use strict";e.d(I,{F$:function(){return a},Xd:function(){return s},et:function(){return f},FP:function(){return Z},Bx:function(){return p},wA:function(){return ee}});var U=e(11849),O=e(3182),P=e(94043),r=e.n(P),C=e(32773);function a(d){return l.apply(this,arguments)}function l(){return l=(0,O.Z)(r().mark(function d(m){return r().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,C.WY)("/api/skyflying/getCoarseCountsOfUser",(0,U.Z)({method:"GET"},m||{})));case 1:case"end":return R.stop()}},d)})),l.apply(this,arguments)}function s(d,m){return i.apply(this,arguments)}function i(){return i=(0,O.Z)(r().mark(function d(m,E){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,U.Z)({method:"GET",params:m},E||{})));case 1:case"end":return n.stop()}},d)})),i.apply(this,arguments)}function u(d,m){return b.apply(this,arguments)}function b(){return b=_asyncToGenerator(_regeneratorRuntime.mark(function d(m,E){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:m},E||{})));case 1:case"end":return n.stop()}},d)})),b.apply(this,arguments)}function f(d,m){return T.apply(this,arguments)}function T(){return T=(0,O.Z)(r().mark(function d(m,E){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getCountsOfUser",(0,U.Z)({method:"GET",params:m},E||{})));case 1:case"end":return n.stop()}},d)})),T.apply(this,arguments)}function Z(d,m){return A.apply(this,arguments)}function A(){return A=(0,O.Z)(r().mark(function d(m,E){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getUserOperationTypeCount",(0,U.Z)({method:"GET",params:m},E||{})));case 1:case"end":return n.stop()}},d)})),A.apply(this,arguments)}function p(d,m){return w.apply(this,arguments)}function w(){return w=(0,O.Z)(r().mark(function d(m,E){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,U.Z)({method:"GET",params:m},E||{})));case 1:case"end":return n.stop()}},d)})),w.apply(this,arguments)}function ee(d,m){return k.apply(this,arguments)}function k(){return k=(0,O.Z)(r().mark(function d(m,E){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.WY)("/api/skyflying/getCoarseCountsOfOneUser",(0,U.Z)({method:"GET",params:m||{}},E||{})));case 1:case"end":return n.stop()}},d)})),k.apply(this,arguments)}},2335:function(F,I,e){"use strict";e.d(I,{cD:function(){return s},sF:function(){return u}});var U=e(11849),O=e(3182),P=e(94043),r=e.n(P),C=e(32773);function a(f){return l.apply(this,arguments)}function l(){return l=_asyncToGenerator(_regeneratorRuntime.mark(function f(T){return _regeneratorRuntime.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",request("/api/skyflying/getUserNameAnomalyDetectionInfo",_objectSpread({method:"GET"},T||{})));case 1:case"end":return A.stop()}},f)})),l.apply(this,arguments)}function s(f,T){return i.apply(this,arguments)}function i(){return i=(0,O.Z)(r().mark(function f(T,Z){return r().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,C.WY)("/api/skyflying/getAllAlarmInfoDetailByUserName",(0,U.Z)({method:"GET",params:T||{}},Z||{})));case 1:case"end":return p.stop()}},f)})),i.apply(this,arguments)}function u(f,T){return b.apply(this,arguments)}function b(){return b=(0,O.Z)(r().mark(function f(T,Z){return r().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,C.WY)("/api/skyflying/getAnomalyDetectionInfoByGroupByUserName",(0,U.Z)({method:"GET",params:T||{}},Z||{})));case 1:case"end":return p.stop()}},f)})),b.apply(this,arguments)}},24480:function(F,I,e){"use strict";e.d(I,{Z:function(){return P}});var U=e(69610),O=e(54941),P=function(){function r(){(0,U.Z)(this,r)}return(0,O.Z)(r,null,[{key:"timeStampToTime",value:function(a){var l=new Date(parseInt(a));return l.toJSON().substring(0,10).replace("T","")}},{key:"getLocalTime",value:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-mm-dd HH:MM:SS",s,i={"Y+":a.getFullYear().toString(),"m+":(a.getMonth()+1).toString(),"d+":a.getDate().toString(),"H+":a.getHours().toString(),"M+":a.getMinutes().toString(),"S+":a.getSeconds().toString()},u=l;for(var b in i)s=new RegExp("("+b+")").exec(l),s&&(u=u.replace(s[1],s[1].length==1?i[b]:i[b].padStart(s[1].length,"0")));return u}},{key:"uuid",value:function(){for(var a=[],l="0123456789abcdef",s=0;s<36;s++)a[s]=l.substr(Math.floor(Math.random()*16),1);return a[14]="4",a[19]=l.substr(a[19]&3|8,1),a[8]=a[13]=a[18]=a[23]="-",a.join("").replace(new RegExp(/(-)/g),"")}},{key:"getRangeTime",value:function(a,l){for(var s=[],i=a-1;i>=0;i--){var u=void 0;i===a-1?u=new Date(Date.now()-i*24*60*60*1e3).setHours(0,0,1,0):u=new Date(Date.now()-i*24*60*60*1e3).setHours(23,59,59,999),l?s.push(r.getLocalTime(new Date(u),l)):s.push(u)}return s}},{key:"getRangeStartAndEndTime",value:function(a,l){for(var s=[],i=a-1;i>=0;i--){var u=void 0;i===a-1?u=new Date(Date.now()-i*24*60*60*1e3).setHours(0,0,0,0):i===0?u=new Date(Date.now()-(i-1)*24*60*60*1e3).setHours(0,0,0,0):u=new Date(Date.now()-i*24*60*60*1e3).setHours(23,59,59,999),l?s.push(r.getLocalTime(new Date(u),l)):s.push(u)}return[s[0],s[a-1]]}}]),r}();P.arrayDeDuplication=function(r){return Array.from(new Set(r))}}}]);
