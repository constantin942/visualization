(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[569],{89663:function(x){x.exports={config:"config___2VrF2",wrap:"wrap___hG-7N",formWrap:"formWrap___3-j7Q",userList:"userList___3VPaM","ant-list":"ant-list___PgOC8","ant-list-item":"ant-list-item___1oeG9"}},83620:function(x,N,e){"use strict";e.r(N),e.d(N,{default:function(){return Le}});var U=e(71194),C=e(50146),O=e(12968),P=e(62462),se=e(57106),w=e(99683),nn=e(62350),me=e(75443),tn=e(49111),pe=e(19650),rn=e(71153),ae=e(60331),sn=e(18106),W=e(51752),an=e(402),he=e(97272),ie=e(86582),un=e(57663),b=e(71577),ln=e(74379),G=e(38648),p=e(3182),h=e(11849),D=e(2824),ve=e(94043),o=e.n(ve),y=e(67294),ye=e(89663),A=e.n(ye),Fe=e(24739),R=e(5966),j=e(13312),Ze=e(50206),be=e(98587),De=e(67724),xe=e(8812),J=e(5894),V=e(90672),Ce=e(64317),Ae=e(59962),F=e(25377),E=e(24480);function je(i){return I.apply(this,arguments)}function I(){return I=(0,p.Z)(o().mark(function i(a){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,F.WY)("/api/skyflying/config/getDingConfig",(0,h.Z)({method:"GET"},a||{})));case 1:case"end":return s.stop()}},i)})),I.apply(this,arguments)}function Se(i){return K.apply(this,arguments)}function K(){return K=(0,p.Z)(o().mark(function i(a){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,F.WY)("/api/skyflying/config/getDingGapDic",(0,h.Z)({method:"GET"},a||{})));case 1:case"end":return s.stop()}},i)})),K.apply(this,arguments)}function Ee(i,a){return M.apply(this,arguments)}function M(){return M=(0,p.Z)(o().mark(function i(a,f){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,F.WY)("/api/skyflying/config/updateDingConfig",(0,h.Z)({method:"PUT",data:a},f||{})));case 1:case"end":return r.stop()}},i)})),M.apply(this,arguments)}function Be(i){return Q.apply(this,arguments)}function Q(){return Q=(0,p.Z)(o().mark(function i(a){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,F.WY)("/api/skyflying/getAkSk",(0,h.Z)({method:"GET"},a||{})));case 1:case"end":return s.stop()}},i)})),Q.apply(this,arguments)}function ke(i){return H.apply(this,arguments)}function H(){return H=(0,p.Z)(o().mark(function i(a){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,F.WY)("/api/skyflying/getRegion",(0,h.Z)({method:"GET"},a||{})));case 1:case"end":return s.stop()}},i)})),H.apply(this,arguments)}function Te(i,a){return X.apply(this,arguments)}function X(){return X=(0,p.Z)(o().mark(function i(a,f){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,F.WY)("/api/skyflying/setAkSk",(0,h.Z)({method:"POST",data:E.Z.formData(a)},f||{})));case 1:case"end":return r.stop()}},i)})),X.apply(this,arguments)}function Ne(i,a){return q.apply(this,arguments)}function q(){return q=(0,p.Z)(o().mark(function i(a,f){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,F.WY)("/api/skyflying/setRegion",(0,h.Z)({method:"POST",data:E.Z.formData(a)},f||{})));case 1:case"end":return r.stop()}},i)})),q.apply(this,arguments)}function Ue(i){return _.apply(this,arguments)}function _(){return _=(0,p.Z)(o().mark(function i(a){return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,F.WY)("/api/skyflying/getUserFrom",(0,h.Z)({method:"GET"},a||{})));case 1:case"end":return s.stop()}},i)})),_.apply(this,arguments)}function Oe(i,a){return ee.apply(this,arguments)}function ee(){return ee=(0,p.Z)(o().mark(function i(a,f){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,F.WY)("/api/skyflying/addUserFrom",(0,h.Z)({method:"POST",data:E.Z.formData(a)},f||{})));case 1:case"end":return r.stop()}},i)})),ee.apply(this,arguments)}function Pe(i,a){return ne.apply(this,arguments)}function ne(){return ne=(0,p.Z)(o().mark(function i(a,f){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,F.WY)("/api/skyflying/updateUserFrom",(0,h.Z)({method:"POST",data:E.Z.formData(a)},f||{})));case 1:case"end":return r.stop()}},i)})),ne.apply(this,arguments)}var n=e(85893),we=function(a){var f=(0,y.useRef)();return(0,n.jsx)(C.Z,{title:"\u6DFB\u52A0\u7528\u6237\u6765\u6E90",width:"350px",onCancel:function(){var r;a.setVisible(!1),(r=f.current)===null||r===void 0||r.resetFields()},visible:a.visible,footer:[(0,n.jsx)("div",{children:(0,n.jsx)(b.Z,{type:"primary",onClick:function(){var r;(r=f.current)===null||r===void 0||r.submit()},children:"\u786E\u8BA4"})},"\u6DFB\u52A0\u7528\u6237\u6765\u6E90")],children:(0,n.jsxs)(J.A,{submitter:!1,formRef:f,onFinish:function(){var s=(0,p.Z)(o().mark(function r(te){return o().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:Oe(te).then(function(Y){var L=Y.code;if(L===j.Gh){var S;G.Z.success({message:"\u63D0\u793A",description:"\u6DFB\u52A0\u6210\u529F\uFF01"}),(S=f.current)===null||S===void 0||S.resetFields(),a.setVisible(!1),a.refresh()}});case 1:case"end":return B.stop()}},r)}));return function(r){return s.apply(this,arguments)}}(),children:[(0,n.jsx)(R.Z,{label:"\u63A5\u53E3\u8DEF\u5F84",name:"userFromPath",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63A5\u53E3\u8DEF\u5F84\uFF01"}]}),(0,n.jsx)(R.Z,{label:"\u63A5\u53E3\u8DEF\u5F84\u8BF4\u660E",name:"userFromDesc"})]})})},We=we,Ge=e(34217),Re=e.n(Ge),Ve=e(37867),$e="https://gw.alipayobjects.com/zos/antfincdn/efFD%24IOql2/weixintupian_20170331104822.jpg",Ye=function(){var a=(0,y.useRef)(),f=(0,y.useRef)(),s=(0,y.useState)(!1),r=(0,D.Z)(s,2),te=r[0],$=r[1],B=(0,y.useState)(1),Y=(0,D.Z)(B,2),L=Y[0],S=Y[1],ze=(0,y.useState)(Re()),ue=(0,D.Z)(ze,2),Je=ue[0],le=ue[1],Ie=(0,y.useState)([]),oe=(0,D.Z)(Ie,2),de=oe[0],Ke=oe[1],Me=(0,y.useState)(!1),ce=(0,D.Z)(Me,2),Qe=ce[0],re=ce[1],He=(0,y.useState)({gap:0,id:0,secret:"",webhook:"",mobiles:""}),fe=(0,D.Z)(He,2),Xe=fe[0],qe=fe[1],_e=(0,y.useState)({dingDisabled:!0,dmsDisabled:!0}),ge=(0,D.Z)(_e,2),Z=ge[0],k=ge[1],z={getAkAndSk:function(){Be().then(function(u){var t=u.data;if(t){var d,l=JSON.parse(t);(d=f.current)===null||d===void 0||d.setFieldsValue(l),ke().then(function(m){if(m&&m.data){var g=JSON.parse(m.data),v=g.config;if(v){var T,en=JSON.parse(v);(T=f.current)===null||T===void 0||T.setFieldsValue({region:en["dms-region"]})}}})}})},getConfig:function(){je().then(function(u){var t,d=u.data,l=u.code;l===j.Gh&&d&&qe(d);var m=[];if(d&&d.mobiles){var g=d.mobiles.includes("#")?d.mobiles.split("#"):[d.mobiles];m=g.map(function(v){return{phone:v}})}(t=a.current)===null||t===void 0||t.setFieldsValue((0,h.Z)((0,h.Z)({},d),{phone:m}))})},getUserFromConfig:function(){Ue().then(function(u){var t=u.data,d=JSON.parse(t),l=d.rows;if(console.log(JSON.parse(l)),l){var m=JSON.parse(l);m&&Ke(m.map(function(g){return g.avatar=$e,g}))}})}};return(0,y.useEffect)(function(){z.getConfig()},[]),(0,n.jsxs)("div",{className:A().config,children:[(0,n.jsxs)(W.Z,{tabPosition:"left",size:"middle",onChange:function(u){z[u](),k({dingDisabled:!0,dmsDisabled:!0})},type:"card",children:[(0,n.jsxs)(W.Z.TabPane,{tab:"\u9489\u9489\u544A\u8B66",children:[(0,n.jsx)("h3",{className:"text-c mb-30 mt-50 fw-600",children:"\u9489\u9489\u544A\u8B66\u914D\u7F6E"}),(0,n.jsx)("div",{className:A().wrap,children:(0,n.jsxs)(J.A,{className:A().formWrap,formRef:a,labelAlign:"right",onFinish:function(){var c=(0,p.Z)(o().mark(function u(t){var d,l;return o().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:l=t.phone,l&&l.length>0&&(t.mobiles=l.map(function(v){return v.phone}).join("#"),delete t.phone),Ee((0,h.Z)((0,h.Z)({},t),{id:(d=Xe.id)!==null&&d!==void 0?d:null})).then(function(v){var T=v.code;T===j.Gh&&(G.Z.success({message:"\u63D0\u793A",description:"\u4FEE\u6539\u6210\u529F\uFF01"}),k({dmsDisabled:!0,dingDisabled:!0}))});case 3:case"end":return g.stop()}},u)}));return function(u){return c.apply(this,arguments)}}(),submitter:{render:function(u,t){var d=function(){return(0,n.jsx)(b.Z,{htmlType:"button",onClick:function(){k(function(g){var v=g.dmsDisabled;return{dingDisabled:!1,dmsDisabled:v}})},children:"\u70B9\u51FB\u7F16\u8F91"},"ding-edit")};return t.splice(1,0,d()),(0,ie.Z)(t)},searchConfig:{submitText:"\u786E\u8BA4\u4FEE\u6539"}},labelCol:{span:7},wrapperCol:{span:17},layout:"horizontal",children:[(0,n.jsx)(V.Z,{disabled:Z.dingDisabled,help:(0,n.jsx)(he.Z.Link,{onClick:function(){$(!0)},children:"\u5982\u4F55\u83B7\u53D6Webhook\uFF1F"}),width:"lg",name:"webhook",label:"Webhook",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u94A5"}]}),(0,n.jsx)(V.Z,{width:"lg",name:"secret",label:"Secret",disabled:Z.dingDisabled,rules:[{required:!0,message:"\u8BF7\u8F93\u5165token"}]}),(0,n.jsx)(Ce.Z,{width:"lg",name:"gap",label:"\u544A\u8B66\u95F4\u9694",debounceTime:300,disabled:Z.dingDisabled,rules:[{required:!0,message:"\u9009\u62E9\u544A\u8B66\u95F4\u9694"}],request:(0,p.Z)(o().mark(function c(){var u,t;return o().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,Se();case 3:return u=l.sent,t=u.data,l.abrupt("return",t.map(function(m){return{label:m,value:m}}));case 8:return l.prev=8,l.t0=l.catch(0),l.abrupt("return",[]);case 11:case"end":return l.stop()}},c,null,[[0,8]])}))}),(0,n.jsx)(Ae.u,{name:"phone",label:"@\u6307\u5B9A\u7528\u6237\uFF08\u624B\u673A\u53F7\u7801\uFF09\uFF1A",copyIconProps:!1,deleteIconProps:Z.dingDisabled?!1:{},creatorButtonProps:{disabled:Z.dingDisabled,creatorButtonText:"\u6DFB\u52A0\u6307\u5B9A\u7528\u6237"},initialValue:[{phone:""}],children:(0,n.jsx)(Fe.UW,{children:(0,n.jsx)(R.Z,{name:"phone",disabled:Z.dingDisabled,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6307\u5B9A\u7528\u6237\u624B\u673A\u53F7\u7801\uFF01"}],fieldProps:{maxLength:11},placeholder:"\u8BF7\u8F93\u5165\u6307\u5B9A\u7528\u6237\u624B\u673A\u53F7\u7801"})},"group")})]})})]},"getConfig"),(0,n.jsxs)(W.Z.TabPane,{tab:"\u83B7\u53D6\u6570\u636E\u5E93\u5BA1\u8BA1\u65E5\u5FD7\u914D\u7F6E",children:[(0,n.jsx)("h3",{className:"text-c mb-30 mt-50 fw-600",children:"\u83B7\u53D6\u6570\u636E\u5E93\u5BA1\u8BA1\u65E5\u5FD7\u914D\u7F6E"}),(0,n.jsx)("div",{className:A().wrap,children:(0,n.jsxs)(J.A,{className:A().formWrap,formRef:f,labelAlign:"right",onFinish:function(){var c=(0,p.Z)(o().mark(function u(t){var d,l;return o().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Te(t);case 2:return d=g.sent,g.next=5,Ne(t);case 5:l=g.sent,d.code===j.Gh&&l.code===j.Gh&&(G.Z.success({message:"\u63D0\u793A",description:"\u4FEE\u6539\u6210\u529F\uFF01"}),k({dmsDisabled:!0,dingDisabled:!0}));case 7:case"end":return g.stop()}},u)}));return function(u){return c.apply(this,arguments)}}(),submitter:{render:function(u,t){var d=function(){return(0,n.jsx)(b.Z,{htmlType:"button",onClick:function(){k(function(g){var v=g.dingDisabled;return{dingDisabled:v,dmsDisabled:!1}})},children:"\u70B9\u51FB\u7F16\u8F91"},"dms-edit")};return t.splice(1,0,d()),(0,ie.Z)(t)},searchConfig:{submitText:"\u786E\u8BA4\u4FEE\u6539"}},labelCol:{span:7},layout:"horizontal",children:[(0,n.jsx)(V.Z,{width:"lg",name:"ak",label:"Access Key",style:{textAlign:"left"},disabled:Z.dmsDisabled,rules:[{required:!0,message:"\u8BF7\u8F93\u5165Access Key"}]}),(0,n.jsx)(V.Z,{width:"lg",name:"sk",label:"Secret Access Key",style:{textAlign:"left"},disabled:Z.dmsDisabled,rules:[{required:!0,message:"\u8BF7\u8F93\u5165Secret Access Key"}]}),(0,n.jsx)(R.Z,{width:"lg",name:"region",label:"\u6570\u636E\u5E93\u6240\u5C5E\u533A\u57DF",style:{textAlign:"left"},disabled:Z.dmsDisabled,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u636E\u5E93\u6240\u5C5E\u533A\u57DF"}]})]})})]},"getAkAndSk"),(0,n.jsx)(W.Z.TabPane,{tab:"\u7528\u6237\u6765\u6E90\u4FE1\u606F\u914D\u7F6E",children:de.length>0?(0,n.jsx)(Ve.Rs,{rowKey:"id",headerTitle:"\u5DF2\u6709\u7528\u6237\u6765\u6E90\u4FE1\u606F\u5217\u8868",dataSource:de,showActions:"always",className:A().userList,toolBarRender:function(){return[(0,n.jsx)(b.Z,{type:"primary",onClick:function(){re(!0)},children:"\u6DFB\u52A0\u7528\u6237\u6765\u6E90"},"354")]},metas:{title:{dataIndex:"fromName"},avatar:{render:function(){return(0,n.jsx)(Ze.Z,{className:"fs-18 primary-blue-5"})}},description:{dataIndex:"desc",render:function(u,t){return(0,n.jsx)("div",{className:"fs-12",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:"\u521B\u5EFA\u65F6\u95F4\uFF1A"}),(0,n.jsx)("span",{children:E.Z.timeStampToTime(t.gmtCreate+"")})]})})}},subTitle:{render:function(u,t){return(0,n.jsxs)(pe.Z,{size:0,children:[(0,n.jsx)(ae.Z,{color:"blue",children:t.fromPath}),(0,n.jsx)(ae.Z,{color:t.isDelete===0?"#5BD8A6":"red",children:t.isDelete===0?"\u542F\u7528\u4E2D":"\u7981\u7528\u4E2D"})]})}},actions:{render:function(u,t){return[(0,n.jsx)(me.Z,{onConfirm:function(){Pe({ruleId:t.id,isDelete:t.isDelete===0?1:0}).then(function(l){var m=l.code;m===j.Gh&&(G.Z.success({message:"\u63D0\u793A",description:"".concat(t.isDelete===0?"\u7981\u7528":"\u542F\u7528")}),z.getUserFromConfig())})},title:"\u60A8\u786E\u8BA4".concat(t.isDelete===0?"\u7981\u7528":"\u542F\u7528","\u8BE5\u6761\u7528\u6237\u6765\u6E90\uFF1F"),children:(0,n.jsx)("a",{className:t.isDelete===0?"danger":"",children:t.isDelete===0?"\u7981\u7528":"\u542F\u7528"})},"link")]}}}}):(0,n.jsx)(w.ZP,{className:"mt-50",icon:(0,n.jsx)(be.Z,{}),title:"\u6682\u65E0\u7528\u6237\u6765\u6E90\u4FE1\u606F\uFF0C\u8BF7\u70B9\u51FB\u4E0B\u65B9\u6309\u94AE\u6DFB\u52A0",extra:(0,n.jsx)(b.Z,{type:"primary",onClick:function(){re(!0)},children:"\u6DFB\u52A0\u7528\u6237\u6765\u6E90"})})},"getUserFromConfig")]}),(0,n.jsxs)(C.Z,{title:"\u83B7\u53D6Webhook\u64CD\u4F5C\u8BF4\u660E",width:"600px",bodyStyle:{textAlign:"center"},onCancel:function(){return $(!1)},visible:te,footer:[(0,n.jsx)("div",{className:"text-c",children:(0,n.jsx)(b.Z,{type:"primary",onClick:function(){return $(!1)},children:"\u786E\u8BA4"})},"\u83B7\u53D6Webhook\u64CD\u4F5C\u8BF4\u660E")],children:[(0,n.jsx)(b.Z,{type:"primary",className:"mr-10",icon:(0,n.jsx)(De.Z,{}),disabled:L<=1,size:"middle",onClick:function(){S(function(u){return e(26861)("./ding".concat(u-1,".png")).then(function(t){le(t.default)}),u-1})}}),(0,n.jsx)(P.Z,{preview:!1,width:350,height:360,src:Je,className:"mt-20"}),(0,n.jsx)(b.Z,{type:"primary",className:"ml-10",disabled:L>=5,icon:(0,n.jsx)(xe.Z,{}),size:"middle",onClick:function(){S(function(u){return e(26861)("./ding".concat(u+1,".png")).then(function(t){le(t.default)}),u+1})}})]}),(0,n.jsx)(We,{visible:Qe,setVisible:function(u){return re(u)},refresh:function(){return z.getUserFromConfig()}})]})},Le=Ye},34217:function(x,N,e){x.exports=e.p+"static/ding1.189f221b.png"},26861:function(x,N,e){var U={"./ding1.png":[34217],"./ding2.png":[37255,255],"./ding3.png":[77897,897],"./ding4.png":[66005,5],"./ding5.png":[13020,20]};function C(O){if(!e.o(U,O))return Promise.resolve().then(function(){var w=new Error("Cannot find module '"+O+"'");throw w.code="MODULE_NOT_FOUND",w});var P=U[O],se=P[0];return Promise.all(P.slice(1).map(e.e)).then(function(){return e.t(se,7|16)})}C.keys=function(){return Object.keys(U)},C.id=26861,x.exports=C}}]);
