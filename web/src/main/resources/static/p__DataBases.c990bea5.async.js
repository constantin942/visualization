(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[383],{12265:function(w){w.exports={databases:"databases___35H4X","detail-wrap":"detail-wrap___1IA0t","tops-wrap":"tops-wrap___2AQns",tops:"tops___2lHCZ"}},36106:function(w,B,e){"use strict";e.r(B),e.d(B,{default:function(){return _e}});var m=e(3182),o=e(11849),V=e(57663),l=e(71577),b=e(34792),I=e(48086),O=e(80112),P=e(18597);function E(j,f,d){return(0,P.Z)()?E=Reflect.construct:E=function(n,C,c){var p=[null];p.push.apply(p,C);var Z=Function.bind.apply(n,p),S=new Z;return c&&(0,O.Z)(S,c.prototype),S},E.apply(null,arguments)}var W=e(86582),G=e(71153),R=e(60331),T=e(2824),ee=e(94043),A=e.n(ee),v=e(67294),L=e(60355),te=e(84674),k=e(12265),ae=e.n(k),F=e(24480),ne=e(66572),z=e(13062),r=e(71230),s=e(89032),u=e(15746),_=e(69610),t=e(54941),ie=e(43028),le=e(6783),oe=e(69886),i=e(85893),ve=oe.G2.getEngine("canvas"),he=function(j){(0,ie.Z)(d,j);var f=(0,le.Z)(d);function d(y){var n;return(0,_.Z)(this,d),n=f.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=this,C=new oe.by("dataActionPie".concat(this.props.id),{autoFit:!0,height:250,appendPadding:10,data:this.props.types,angleField:"value",colorField:"type",radius:.75,tooltip:{formatter:function(p){var Z=p.value,S=p.type,H=n.props.types.map(function(Y){return Y.value}).reduce(function(Y,re){return Y+re},0);return{name:S,value:(Z/H*100).toFixed(2)+"%"}}},legend:{position:"bottom"},label:{type:"spider",labelHeight:28,formatter:function(p,Z){var S=new ve.Group({});return S.addShape({type:"circle",attrs:{x:0,y:0,width:40,height:50,r:5,fill:Z.color}}),S.addShape({type:"text",attrs:{x:10,y:6,text:"".concat(p.type),fill:Z.color}}),S.addShape({type:"text",attrs:{x:0,y:20,text:"".concat(F.Z.bigNumberTransform(p.value),"\u6B21 "),fill:Z.color,fontWeight:700}}),S}},interactions:[{type:"element-selected"},{type:"element-active"}]});C.update({theme:{styleSheet:{brandColor:"#025DF4",paletteQualitative10:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF"],paletteQualitative20:["#025DF4","#DB6BCF","#2498D1","#BBBDE6","#4045B2","#21A97A","#FF745A","#007E99","#FFA8A8","#2391FF","#FFC328","#A0DC2C","#946DFF","#626681","#EB4185","#CD8150","#36BCCB","#327039","#803488","#83BC99"]}}}),C.render(),this.setState({chart:C})}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"dataActionPie"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.types),n}}]),d}(v.Component),ge=e(39004),ye=function(j){(0,ie.Z)(d,j);var f=(0,le.Z)(d);function d(y){var n;return(0,_.Z)(this,d),n=f.call(this,y),n.state={chart:null},n}return(0,t.Z)(d,[{key:"componentDidMount",value:function(){var n=new ge.kL({container:"RecentlyLine".concat(this.props.id),autoFit:!0,height:200});n.data(this.props.ranges),n.scale({value:{min:0,nice:!1},year:{range:[0,1]}}),n.tooltip({showNil:!1,showCrosshairs:!1,title:function(c,p){return"".concat(c,"\uFF1A").concat(p.value," \u6B21")},itemTpl:`<div class="g2-tooltip">
        <div class="g2-tooltip-title">Language</div>
        <ul class="g2-tooltip-list">
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">a</span>:<span class="g2-tooltip-value">70</span>
          </li>
          <li class="g2-tooltip-list-item">
            <span class="g2-tooltip-marker"></span>
            <span class="g2-tooltip-name">b</span>:<span class="g2-tooltip-value">50</span>
          </li>
        </ul>
      </div>`}),this.setState({chart:n}),n.area().position("year*value"),n.line().position("year*value"),n.render()}},{key:"render",value:function(){return(0,i.jsx)("div",{id:"RecentlyLine"+this.props.id})}}],[{key:"getDerivedStateFromProps",value:function(n,C){var c=C.chart;return n.refreshUid==="open"&&c&&c.changeData(n.ranges),n}}]),d}(v.Component),Ce=function(f){return(0,i.jsx)(r.Z,{className:f.style["detail-wrap"],gutter:20,children:(0,i.jsx)(u.Z,{span:24,children:(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(u.Z,{span:12,className:"text-c",children:[(0,i.jsx)("h3",{children:"\u64CD\u4F5C\u884C\u4E3A\u5206\u5E03"}),(0,i.jsx)(he,{types:f.types,id:f.id,refreshUid:f.refreshUid})]}),(0,i.jsx)(u.Z,{span:12,className:"text-c",children:(0,i.jsxs)("div",{className:"text-c mt-15 mb-20",children:[(0,i.jsx)("h3",{children:"\u8FD1\u4E03\u5929\u8BBF\u95EE\u6570\u636E\u7EDF\u8BA1"}),(0,i.jsx)(ye,{ranges:f.ranges,id:f.id,refreshUid:f.refreshUid})]})})]})})})},De=Ce,de=e(6650),Ee=function(){var f=(0,v.useState)([]),d=(0,T.Z)(f,2),y=d[0],n=d[1],C=(0,v.useState)(""),c=(0,T.Z)(C,2),p=c[0],Z=c[1],S=(0,v.useState)(0),H=(0,T.Z)(S,2),Y=H[0],re=H[1],Se=(0,v.useState)(),ce=(0,T.Z)(Se,2),be=ce[0],Te=ce[1],Ze=(0,v.useState)({pageSize:10,pageNo:1}),pe=(0,T.Z)(Ze,2),$=pe[0],Oe=pe[1],Ue=(0,v.useState)({types:[],ranges:[]}),me=(0,T.Z)(Ue,2),Be=me[0],fe=me[1],Ae=[{title:"\u6570\u636E\u5E93",dataIndex:"dbName",key:"dbName",align:"center"},{title:"\u6570\u636E\u5E93\u8868",dataIndex:"tableName",key:"tableName",align:"center",render:function(h,a){var U="-";if(a.tableNameDesc)U=a.tableNameDesc;else{var g=a.tableName.split("#");U=g[g.length-1]}return(0,i.jsx)("div",{style:{wordWrap:"break-word",wordBreak:"break-word"},children:U})}},{title:"\u88AB\u8BBF\u95EE\u6B21\u6570",dataIndex:"visitedCount",key:"visitedCount",align:"center",search:!1,render:function(h,a){return(0,i.jsx)("div",{children:a.visitedCount.toLocaleString()})}},{title:"\u5E38\u8BBF\u95EE\u4EBA\u5458",key:"usualVisitedUser",dataIndex:"usualVisitedUser",align:"center",search:!1,render:function(h,a){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:a.usualVisitedUser}),a.userFrom&&(0,i.jsx)(R.Z,{style:{marginLeft:5},color:"#108ee9",children:"\u5B9A\u65F6\u4EFB\u52A1"})]})}},{title:"\u6700\u540E\u8BBF\u95EE\u65F6\u95F4",key:"lastVisitedDate",dataIndex:"lastVisitedDate",valueType:"dateTime",hideInSetting:!0,search:!1,align:"center"},{title:"\u64CD\u4F5C",key:"action",align:"center",search:!1,render:function(h,a){return[(0,i.jsx)(l.Z,{type:"link",size:"small",onClick:function(){if(p===a.id){Z(""),fe({types:[],ranges:[]});return}if(a.visitedCount!==0){var g=F.Z.getRangeStartAndEndTime(7,"YYYY-mm-dd HH:MM:SS"),Q=F.Z.getRangeTime(7,"YYYY-mm-dd");(0,de.Xd)({msTableName:a.tableName,startTime:g[0],endTime:g[1],tableName:a.tableName}).then(function(Fe){var se=Fe.data;if(se&&se.length>0){var xe=se.map(function(N,ue){return{year:Q[ue],value:N}}),X=E(Array,(0,W.Z)(te.q));(0,de.et)({tableName:a.tableName}).then(function(N){if(N.data&&N.data.length>0){X.forEach(function(x){var q=N.data.map(function(K){return JSON.parse(K)}),M=q.find(function(K){return K.dbType===x.type});M&&x.type===M.dbType?x.value=parseInt(M.dbTypeTimes):x.value=0});var ue=X.map(function(x){return x.type});N.data.forEach(function(x){var q=JSON.parse(x),M=q.dbType,K=q.dbTypeTimes;ue.includes(M)||X.push({type:M,value:K})}),fe({ranges:xe,types:X})}}),setTimeout(function(){Z(a.id)},400)}})}else I.ZP.info("".concat(a.tableName,"\u8868\u8BBF\u88AB\u95EE\u6B21\u6570\u4E3A0\uFF0C\u6682\u65E0\u8BE6\u60C5\u6570\u636E")).then()},children:"\u8BE6\u60C5"},"action")]}}],J=(0,v.useCallback)(function(D){(0,ne.m)(D).then(function(h){var a=h.data;if(a){var U=JSON.parse(a);if(re(U.total),U.rows){var g=JSON.parse(U.rows);console.log(g),n(g.map(function(Q){return Q.id=F.Z.uuid(),Q}));return}}n([])})},[]);return(0,v.useEffect)(function(){J($)},[]),(0,i.jsx)("div",{className:ae().databases,children:(0,i.jsx)(L.ZP,{headerTitle:"\u6570\u636E\u8BBF\u95EE\u884C\u4E3A\u5217\u8868",columns:Ae,rowKey:"id",pagination:{showSizeChanger:!1,total:Y,pageSize:$.pageSize,current:$.pageNo,onChange:function(h,a){Oe({pageNo:h,pageSize:a}),J((0,o.Z)({pageNo:h,pageSize:a},be))}},options:!1,onSubmit:function(){var D=(0,m.Z)(A().mark(function h(a){return A().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return Te(a),g.next=3,J((0,o.Z)((0,o.Z)({},$),a));case 3:case"end":return g.stop()}},h)}));return function(h){return D.apply(this,arguments)}}(),onReset:(0,m.Z)(A().mark(function D(){return A().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:J((0,o.Z)({},$));case 1:case"end":return a.stop()}},D)})),expandable:{expandedRowRender:function(h,a){return(0,v.createElement)(De,(0,o.Z)((0,o.Z)({},Be),{},{id:a,key:a,style:ae(),refreshUid:p===""?"close":"open"}))},expandIcon:function(){return!1},expandedRowKeys:[p]},dataSource:y})})},_e=Ee},84674:function(w,B,e){"use strict";e.d(B,{q:function(){return m}});var m=[{type:"insert",value:0},{type:"delete",value:0},{type:"update",value:0},{type:"select",value:0}],o=[{type:"\u4E0A\u5348",value:0},{type:"\u4E0B\u5348",value:0},{type:"\u665A\u4E0A",value:0}]},66572:function(w,B,e){"use strict";e.d(B,{m:function(){return I}});var m=e(11849),o=e(3182),V=e(94043),l=e.n(V),b=e(25377);function I(P,E){return O.apply(this,arguments)}function O(){return O=(0,o.Z)(l().mark(function P(E,W){return l().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,b.WY)("/api/skyflying/getCoarseCountsOfTableName",(0,m.Z)({method:"GET",params:E},W||{})));case 1:case"end":return R.stop()}},P)})),O.apply(this,arguments)}},6650:function(w,B,e){"use strict";e.d(B,{F$:function(){return I},Xd:function(){return P},mt:function(){return W},et:function(){return ee},FP:function(){return v},Bx:function(){return te},us:function(){return ne}});var m=e(11849),o=e(3182),V=e(94043),l=e.n(V),b=e(25377);function I(r,s){return O.apply(this,arguments)}function O(){return O=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getCoarseCountsOfUsers",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),O.apply(this,arguments)}function P(r,s){return E.apply(this,arguments)}function E(){return E=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getCountsOfUserRecentSevenDays",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),E.apply(this,arguments)}function W(r,s){return G.apply(this,arguments)}function G(){return G=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getVisitRate",(0,m.Z)({method:"GET",params:{username:s}},u||{})));case 1:case"end":return t.stop()}},r)})),G.apply(this,arguments)}function R(r,s){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCountsOfAllRecentSevenDays",_objectSpread({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),T.apply(this,arguments)}function ee(r,s){return A.apply(this,arguments)}function A(){return A=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getCountsOfUser",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),A.apply(this,arguments)}function v(r,s){return L.apply(this,arguments)}function L(){return L=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getUserOperationTypeCount",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),L.apply(this,arguments)}function te(r,s){return k.apply(this,arguments)}function k(){return k=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getUserUsualAndUnusualData",(0,m.Z)({method:"GET",params:s},u||{})));case 1:case"end":return t.stop()}},r)})),k.apply(this,arguments)}function ae(r,s){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime.mark(function r(s,u){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",request("/api/skyflying/getCoarseCountsOfOneUser",_objectSpread({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),F.apply(this,arguments)}function ne(r,s){return z.apply(this,arguments)}function z(){return z=(0,o.Z)(l().mark(function r(s,u){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/skyflying/getCountsOfEveryonRecentSevenDays",(0,m.Z)({method:"GET",params:s||{}},u||{})));case 1:case"end":return t.stop()}},r)})),z.apply(this,arguments)}}}]);
