(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[835],{37476:function(se,k,e){"use strict";e.d(k,{Y:function(){return N}});var B=e(71194),E=e(50146),re=e(22122),c=e(87757),o=e.n(c),m=e(92137),O=e(28991),J=e(28481),H=e(84305),oe=e(75901),L=e(81253),d=e(67294),K=e(21770),Q=e(73935),G=e(24214),W=e(80334),U=e(82492),ne=e.n(U),a=["children","trigger","onVisibleChange","modalProps","onFinish","submitTimeout","title","width","visible"];function N(v){var Y,I,w,F,ae=v.children,g=v.trigger,n=v.onVisibleChange,t=v.modalProps,s=v.onFinish,u=v.submitTimeout,r=v.title,ue=v.width,A=v.visible,Z=(0,L.Z)(v,a);(0,W.ET)(!Z.footer||!(t==null?void 0:t.footer),"ModalForm \u662F\u4E00\u4E2A ProForm \u7684\u7279\u6B8A\u5E03\u5C40\uFF0C\u5982\u679C\u60F3\u81EA\u5B9A\u4E49\u6309\u94AE\uFF0C\u8BF7\u4F7F\u7528 submit.render \u81EA\u5B9A\u4E49\u3002");var M=(0,d.useContext)(oe.ZP.ConfigContext),le=(0,d.useState)([]),X=(0,J.Z)(le,2),y=X[1],z=(0,d.useState)(!1),q=(0,J.Z)(z,2),j=q[0],V=q[1],ee=(0,K.Z)(!!A,{value:A,onChange:n}),te=(0,J.Z)(ee,2),R=te[0],_=te[1],$=(0,d.useRef)(null),b=(0,d.useCallback)(function(l){$.current===null&&l&&y([]),$.current=l},[]);(0,d.useEffect)(function(){R&&A&&(n==null||n(!0))},[A,R]);var h=(0,d.useMemo)(function(){return g?d.cloneElement(g,(0,O.Z)((0,O.Z)({key:"trigger"},g.props),{},{onClick:function(){var l=(0,m.Z)(o().mark(function p(T){var D,x;return o().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:_(!R),(D=g.props)===null||D===void 0||(x=D.onClick)===null||x===void 0||x.call(D,T);case 2:case"end":return P.stop()}},p)}));function f(p){return l.apply(this,arguments)}return f}()})):null},[_,g,R]),C=(0,d.useMemo)(function(){var l,f,p,T,D,x,ie,P;return Z.submitter===!1?!1:ne()({searchConfig:{submitText:(l=(f=t==null?void 0:t.okText)!==null&&f!==void 0?f:(p=M.locale)===null||p===void 0||(T=p.Modal)===null||T===void 0?void 0:T.okText)!==null&&l!==void 0?l:"\u786E\u8BA4",resetText:(D=(x=t==null?void 0:t.cancelText)!==null&&x!==void 0?x:(ie=M.locale)===null||ie===void 0||(P=ie.Modal)===null||P===void 0?void 0:P.cancelText)!==null&&D!==void 0?D:"\u53D6\u6D88"},resetButtonProps:{preventDefault:!0,disabled:u?j:void 0,onClick:function(ce){var de;_(!1),t==null||(de=t.onCancel)===null||de===void 0||de.call(t,ce)}}},Z.submitter)},[(Y=M.locale)===null||Y===void 0||(I=Y.Modal)===null||I===void 0?void 0:I.cancelText,(w=M.locale)===null||w===void 0||(F=w.Modal)===null||F===void 0?void 0:F.okText,t,Z.submitter,_,j,u]),i=(0,d.useCallback)(function(l,f){return d.createElement(d.Fragment,null,l,$.current&&f?(0,Q.createPortal)(f,$.current):f)},[]),S=(0,d.useCallback)(function(){var l=(0,m.Z)(o().mark(function f(p){var T,D,x;return o().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return T=s==null?void 0:s(p),u&&T instanceof Promise&&(V(!0),D=setTimeout(function(){return V(!1)},u),T.finally(function(){clearTimeout(D),V(!1)})),P.next=4,T;case 4:x=P.sent,x&&_(!1);case 6:case"end":return P.stop()}},f)}));return function(f){return l.apply(this,arguments)}}(),[s,_,u]);return d.createElement(d.Fragment,null,d.createElement(E.Z,(0,re.Z)({title:r,width:ue||800},t,{visible:R,onCancel:function(f){var p;u&&j||(_(!1),t==null||(p=t.onCancel)===null||p===void 0||p.call(t,f))},footer:Z.submitter!==!1&&d.createElement("div",{ref:b,style:{display:"flex",justifyContent:"flex-end"}})}),d.createElement(G.I,(0,re.Z)({formComponentType:"ModalForm",layout:"vertical"},Z,{submitter:C,onFinish:S,contentRender:i}),ae)),h)}},20294:function(se){se.exports={rule:"rule___2uB8V",formContent:"formContent___mfpUm",cardContent:"cardContent___ADntJ",ruleDescDetail:"ruleDescDetail___2wYEk"}},58541:function(se,k,e){"use strict";e.r(k),e.d(k,{default:function(){return t}});var B=e(57663),E=e(71577),re=e(71153),c=e(60331),o=e(2824),m=e(67294),O=e(59975),J=e(74379),H=e(38648),oe=e(3182),L=e(32059),d=e(11849),K=e(94043),Q=e.n(K),G=e(37476),W=e(64317),U=e(89460),ne=e(13312),a=e(85893),N="user_visited_time",v="user_visited_table";function Y(s,u){var r=(0,m.useRef)(),ue=(0,m.useState)(!1),A=(0,o.Z)(ue,2),Z=A[0],M=A[1],le=(0,m.useState)({}),X=(0,o.Z)(le,2),y=X[0],z=X[1],q=(0,m.useState)(),j=(0,o.Z)(q,2),V=j[0],ee=j[1],te=(0,m.useState)(""),R=(0,o.Z)(te,2),_=R[0],$=R[1];return(0,m.useImperativeHandle)(u,function(){return{setInitValues:function(h,C){z({});var i=h.split(",");(0,O.CZ)().then(function(S){ee(S.data),i.forEach(function(l){(0,O.hQ)({typeName:l}).then(function(f){var p,T=f.data;$(C),z(function(D){return(0,d.Z)((0,d.Z)({},D),{},(0,L.Z)({},l,T))}),M(!0),(p=r.current)===null||p===void 0||p.setFieldsValue(S.data)})})})}}}),(0,a.jsxs)(G.Y,{title:"\u4FEE\u6539\u89C4\u5219",layout:"horizontal",formRef:r,visible:Z,onVisibleChange:M,width:350,labelAlign:"right",labelCol:{span:12},modalProps:{destroyOnClose:!1,onCancel:function(){var h;(h=r.current)===null||h===void 0||h.resetFields(),s.setVisible(!1)}},onFinish:function(){var b=(0,oe.Z)(Q().mark(function h(C){var i;return Q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:i=Object.assign(V,C),delete i.id,(0,O._m)(i).then(function(f){var p=f.code;p===ne.Gh&&(H.Z.success({message:"\u63D0\u793A",description:"\u4FEE\u6539\u6210\u529F\uFF01"}),M(!1))});case 3:case"end":return l.stop()}},h)}));return function(h){return b.apply(this,arguments)}}(),children:[_===v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.A.Group,{children:(0,a.jsx)(W.Z,{width:"sm",name:"ruleTableCount",label:"\u8BBF\u95EE\u6B21\u6570\u6700\u5C0F\u9608\u503C",options:y==null?void 0:y.rule_table_count,tooltip:"\u4F4E\u4E8E\u6307\u5B9A\u6B21\u6570\u5C06\u88AB\u7B97\u4E3A\u5F02\u5E38",placeholder:"\u8BF7\u8F93\u5165\u8FB9\u754C\u6B21\u6570"})}),(0,a.jsx)(U.A.Group,{children:(0,a.jsx)(W.Z,{width:"sm",name:"ruleTablePeriod",label:"\u7EDF\u8BA1\u5468\u671F\uFF08\u5929\uFF09",options:y==null?void 0:y.rule_table_period,tooltip:"\u8D85\u8FC7\u7EDF\u8BA1\u5468\u671F\u7684\u8BBF\u95EE\u884C\u4E3A\u5C06\u4E0D\u4F1A\u5F71\u54CD\u753B\u50CF",placeholder:"\u8BF7\u9009\u62E9\u7EDF\u8BA1\u5468\u671F"})})]}),_===N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.A.Group,{children:(0,a.jsx)(W.Z,{width:"sm",name:"ruleTimeRate",label:"\u8BBF\u95EE\u9891\u7387\u6700\u5C0F\u9608\u503C",options:y.rule_time_rate,tooltip:"\u4F4E\u4E8E\u9608\u503C\u5C06\u88AB\u89C6\u4E3A\u4E0D\u5E38\u8BBF\u95EE\u7684\u6570\u636E\u8868",placeholder:"\u8BF7\u8F93\u5165\u8FB9\u754C\u9891\u7387"})}),(0,a.jsx)(U.A.Group,{children:(0,a.jsx)(W.Z,{width:"sm",name:"ruleTimePeriod",label:"\u7EDF\u8BA1\u5468\u671F\uFF08\u5929\uFF09",options:y.rule_time_period,tooltip:"\u8D85\u8FC7\u7EDF\u8BA1\u5468\u671F\u7684\u8BBF\u95EE\u884C\u4E3A\u5C06\u4E0D\u4F1A\u5F71\u54CD\u753B\u50CF",placeholder:"\u8BF7\u9009\u62E9\u7EDF\u8BA1\u5468\u671F"})})]})]})}var I=(0,m.forwardRef)(Y),w=e(29474),F=e(25377),ae=e(20294),g=e.n(ae),n=function(){var u=(0,m.useState)([]),r=(0,o.Z)(u,2),ue=r[0],A=r[1],Z=(0,m.useState)(0),M=(0,o.Z)(Z,2),le=M[0],X=M[1],y=(0,m.useState)(!1),z=(0,o.Z)(y,2),q=z[0],j=z[1],V=(0,m.useRef)(),ee=(0,F.md)(),te=(0,m.useState)({pageNo:1,pageSize:20}),R=(0,o.Z)(te,2),_=R[0],$=R[1],b=(0,m.useCallback)(function(h){(0,O.$D)(h).then(function(C){var i=C.data;if(i){var S=JSON.parse(i);X(S.total);var l=JSON.parse(S.rows);l.length>0?A(l):A([])}})},[]);return(0,m.useEffect)(function(){b(_)},[b,_]),(0,a.jsxs)("div",{className:g().rule,children:[(0,a.jsx)(w.ZP,{pagination:{total:le,pageSize:_.pageSize,current:_.pageNo,defaultPageSize:8,showSizeChanger:!1,onChange:function(C,i){$({pageSize:i,pageNo:C}),b({pageNo:C,pageSize:i})}},rowKey:"id",rowSelection:!1,grid:{gutter:16,column:2},metas:{title:{dataIndex:"ruleDesc"},subTitle:{render:function(C,i){return[(0,a.jsx)(c.Z,{color:i.isDelete===1?"#f50":"#87d068",children:i.isDelete===1?"\u5DF2\u7981\u7528":"\u542F\u7528\u4E2D"},"tag")]}},type:{dataIndex:"gmtCreate"},content:{dataIndex:"ruleDesc",render:function(C,i){return(0,a.jsxs)("div",{className:g().cardContent,children:[(0,a.jsxs)("div",{className:g().ruleDescDetail,children:["\u521B\u5EFA\u65F6\u95F4\uFF1A",i.gmtCreate]},"ruleDesc"),(0,a.jsx)("div",{className:g().ruleDescDetail,children:i.ruleDescDetail},"ruleDescDetail")]})}},actions:{render:function(C,i){return[(0,a.jsx)(F.Nv,{accessible:ee.canUpdate,children:(0,a.jsx)(E.Z,{danger:i.isDelete===0,size:"small",type:"link",onClick:function(){(0,O.Y3)({ruleId:i.id,isDelete:i.isDelete===0?1:0}).then(function(){return b(_)})},children:i.isDelete===1?"\u542F\u7528":"\u7981\u7528"})},"isDelete"),(0,a.jsx)(F.Nv,{accessible:ee.canUpdate,children:(0,a.jsx)(E.Z,{size:"small",type:"link",onClick:function(){if(v===i.ruleName){var l;(l=V.current)===null||l===void 0||l.setInitValues("rule_table_count,rule_table_period",v)}else if(N===i.ruleName){var f;(f=V.current)===null||f===void 0||f.setInitValues("rule_time_rate,rule_time_period",N)}},children:"\u7F16\u8F91"})},"update")]}}},headerTitle:"\u753B\u50CF\u89C4\u5219\u5217\u8868",dataSource:ue}),(0,a.jsx)(I,{ref:V,refresh:function(){return b(_)},setVisible:j,visible:q})]})},t=n},59975:function(se,k,e){"use strict";e.d(k,{f2:function(){return J},MN:function(){return d},yb:function(){return Q},ny:function(){return W},$D:function(){return ne},Y3:function(){return N},hQ:function(){return Y},CZ:function(){return w},_m:function(){return ae}});var B=e(11849),E=e(3182),re=e(94043),c=e.n(re),o=e(25377),m=e(80129),O=e.n(m);function J(n,t){return H.apply(this,arguments)}function H(){return H=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/addUserPortraitByVisitedTableEverydayRule",(0,B.Z)({method:"GET",params:t},s||{})));case 1:case"end":return r.stop()}},n)})),H.apply(this,arguments)}function oe(n){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime.mark(function n(t){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",request("/api/skyflying/updateUserPortraitByVisitedTimeRule",_objectSpread({method:"GET"},t||{})));case 1:case"end":return u.stop()}},n)})),L.apply(this,arguments)}function d(n,t){return K.apply(this,arguments)}function K(){return K=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/addUserPortraitByVisitedTtimeRule",(0,B.Z)({method:"GET",params:t},s||{})));case 1:case"end":return r.stop()}},n)})),K.apply(this,arguments)}function Q(n,t){return G.apply(this,arguments)}function G(){return G=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/updateUserPortraitByVisitedTimeRule",(0,B.Z)({method:"GET",params:t},s||{})));case 1:case"end":return r.stop()}},n)})),G.apply(this,arguments)}function W(n,t){return U.apply(this,arguments)}function U(){return U=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/updateUserPortraitByVisitedTableEverydayRule",(0,B.Z)({method:"GET",params:t},s||{})));case 1:case"end":return r.stop()}},n)})),U.apply(this,arguments)}function ne(n,t){return a.apply(this,arguments)}function a(){return a=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/getUserPortraitRules",(0,B.Z)({method:"GET",params:t},s||{})));case 1:case"end":return r.stop()}},n)})),a.apply(this,arguments)}function N(n,t){return v.apply(this,arguments)}function v(){return v=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/updateUserPortraitRule?"+O().stringify(t),(0,B.Z)({method:"POST"},s||{})));case 1:case"end":return r.stop()}},n)})),v.apply(this,arguments)}function Y(n,t){return I.apply(this,arguments)}function I(){return I=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/config/getConfigDic",(0,B.Z)({method:"GET",params:t||{}},s||{})));case 1:case"end":return r.stop()}},n)})),I.apply(this,arguments)}function w(n){return F.apply(this,arguments)}function F(){return F=(0,E.Z)(c().mark(function n(t){return c().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,o.WY)("/api/skyflying/config/getPortraitConfig",(0,B.Z)({method:"GET"},t||{})));case 1:case"end":return u.stop()}},n)})),F.apply(this,arguments)}function ae(n,t){return g.apply(this,arguments)}function g(){return g=(0,E.Z)(c().mark(function n(t,s){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/skyflying/config/updatePortraitConfig",(0,B.Z)({method:"PUT",data:t},s||{})));case 1:case"end":return r.stop()}},n)})),g.apply(this,arguments)}}}]);
